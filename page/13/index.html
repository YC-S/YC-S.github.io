<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://yoursite.com').hostname,
    root: '/',
    scheme: 'Pisces',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Yuanchen&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/13/index.html">
<meta property="og:site_name" content="Yuanchen&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Yuanchen">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/page/13/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>Yuanchen's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Yuanchen's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/12/Algorithms-interviews-theory-vs-practice/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yuanchen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yuanchen's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/12/Algorithms-interviews-theory-vs-practice/" class="post-title-link" itemprop="url">Algorithms interviews theory vs practice</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-01-12 22:52:23 / Modified: 23:55:16" itemprop="dateCreated datePublished" datetime="2020-01-12T22:52:23-05:00">2020-01-12</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <hr>
<p>When I ask people at trendy big tech companies why algorithms quizzes are mandatory, the most common answer I get is something like “we have so much scale, we can’t afford to have someone accidentally write an <code>O(n^2)</code> algorithm and bring the site down”. One thing I find funny about this is, even though a decent fraction of the value I’ve provided for companies has been solving phone-screen level algorithms problems on the job, I can’t pass algorithms interviews! When I say that, people often think I mean that I fail half my interviews or something. It’s more than half.</p>
<p>When I wrote a draft blog post of my interview experiences, draft readers panned it as too boring and repetitive because I’d failed too many interviews. I should summarize my failures as a table because no one’s going to want to read a 10k word blog post that’s just a series of failures, they said (which is good advice; I’m working on a version with a table). I’ve done maybe 40-ish “real” software interviews and passed maybe one or two of them (arguably zero).</p>
<p>Let’s look at a few examples to make it clear what I mean by “phone-screen level algorithms problem”, above.</p>
<p>At one big company I worked for, a team wrote a core library that implemented a resizable array for its own purposes. On each resize that overflowed the array’s backing store, the implementation added a constant number of elements and then copied the old array to the newly allocated, slightly larger, array. This is a classic example of how not to <a href="https://en.wikipedia.org/wiki/Dynamic_array" target="_blank" rel="noopener">implement a resizable array</a> since it results in linear time resizing instead of <a href="https://en.wikipedia.org/wiki/Amortized_analysis" target="_blank" rel="noopener">amortized constant time</a> resizing. It’s such a classic example that it’s often used as the canonical example when demonstrating amortized analysis.</p>
<p>For people who aren’t used to big tech company phone screens, typical phone screens that I’ve received are one of:</p>
<ul>
<li>an “easy” coding/algorithms question, maybe with a “very easy” warm-up question in front.</li>
<li>a series of “very easy” coding/algorithms questions,</li>
<li>a bunch of trivia (rare for generalist roles, but not uncommon for low-level or performance-related roles)</li>
</ul>
<p>This array implementation problem is considered to be so easy that it falls into the “very easy” category and is either a warm-up for the “real” phone screen question or is bundled up with a bunch of similarly easy questions. And yet, this resizable array was responsible for roughly 1% of all GC pressure across all JVM code at the company (it was the second largest source of allocations across all code) as well as a significant fraction of CPU. Luckily, the resizable array implementation wasn’t used as a generic resizable array and it was only instantiated by a semi-special-purpose wrapper, which is what allowed this to “only” be responsible for 1% of all GC pressure at the company. If asked as an interview question, it’s overwhelmingly likely that most members of the team would’ve implemented this correctly in an interview. My fixing this made my employer more money annually than I’ve made in my life.</p>
<p>That was the second largest source of allocations, the number one largest source was converting a pair of <code>long</code> values to byte arrays in the same core library. It appears that this was done because someone wrote or copy pasted a hash function that took a byte array as input, then modified it to take two inputs by taking two byte arrays and operating on them in sequence, which left the hash function interface as <code>(byte[], byte[])</code>. In order to call this function on two longs, they used a handy <code>long</code> to <code>byte[]</code> conversion function in a widely used utility library. That function, in addition to allocating an <code>byte[]</code> and stuffing a <code>long</code> into it, also reverses the endianness of the long (the function appears to have been intended to convert <code>long</code> values to network byte order).</p>
<p>Unfortunately, switching to a more appropriate hash function would’ve been a major change, so my fix for this was to change the hash function interface to take a pair of longs instead of a pair of byte arrays and have the hash function do the endianness reversal instead of doing it as a separate step (since the hash function was already shuffling bytes around, this didn’t create additional work). Removing these unnecessary allocations made my employer more money annually than I’ve made in my life.</p>
<p>Finding a constant factor speedup isn’t technically an algorithms question, but it’s also something you see in algorithms interviews. As a follow-up to an algorithms question, I commonly get asked “can you make this faster?” The answer is to these often involves doing a simple optimization that will result in a constant factor improvement.</p>
<p>A concrete example that I’ve been asked twice in interviews is: you’re storing IDs as ints, but you already have some context in the question that lets you know that the IDs are densely packed, so you can store them as a bitfield instead. The difference between the bitfield interview question and the real-world superfluous array is that the real-world existing solution is so far afield from the expected answer that you probably wouldn’t be asked to find a constant factor speedup. More likely, you would’ve failed the interview at that point.</p>
<p>To pick an example from another company, the configuration for BitFunnel, a search index used in Bing, is another example of an interview-level algorithms question.</p>
<p>The full context necessary to describe the solution is a bit much for this blog post, but basically, there’s a set of bloom filters that needs to be configured. One way to do this (which I’m told was being done) is to write a black-box optimization function that uses gradient descent to try to find an optimal solution. I’m told this always resulted in some strange properties and the output configuration always resulted in non-idealities which were worked around by making the backing bloom filters less dense, i.e. throwing more resources (and therefore money) at the problem.</p>
<p>To create a more optimized solution, you can observe that the fundamental operation in BitFunnel is equivalent to multiplying probabilities together, so, for any particular configuration, you can just multiply some probabilities together to determine how a configuration will perform. Since the configuration space isn’t all that large, you can then put this inside a few for loops and iterate over the space of possible configurations and then pick out the best set of configurations. This isn’t quite right because multiplying probabilities assumes a kind of independence that doesn’t hold in reality, but that seems to work ok for the same reason that <a href="https://en.wikipedia.org/wiki/Naive_Bayes_spam_filtering" target="_blank" rel="noopener">naive Bayesian spam filtering</a> worked pretty well when it was introduced even though it incorrectly assumes the probability of any two words appearing in an email are independent. And if you want the full solution, you can work out the non-independent details, although that’s probably beyond the scope of an interview.</p>
<p>Those are just three examples that came to mind, I run into this kind of thing all the time and could come up with tens of examples off the top of my head, perhaps more than a hundred if I sat down and tried to list every example I’ve worked on, certainly more than a hundred if I list examples I know of that someone else (or no one) has worked on. Both the examples in this post as well as the ones I haven’t included have these properties:</p>
<ul>
<li>The example could be phrased as an interview question</li>
<li>If phrased as an interview question, you’d expect most (and probably) all people on the relevant team to get the right answer in the timeframe of an interview</li>
<li>The cost savings from fixing the example is worth more annually than my lifetime earnings to date</li>
<li>The example persisted for long enough that it’s reasonable to assume that it wouldn’t have been discovered otherwise</li>
</ul>
<p>At the start of this post, we noted that people at big tech companies commonly claim that they have to do algorithms interviews since it’s so costly to have inefficiencies at scale. My experience is that these examples are legion at every company I’ve worked for that does algorithms interviews. Trying to get people to solve algorithms problems on the job by asking algorithms questions in interviews doesn’t work.</p>
<p>One reason is that even though big companies try to make sure that the people they hire can solve algorithms puzzles they also incentivize many or most developers to avoid deploying that kind of reasoning to make money.</p>
<p>Of the three solutions for the examples above, two are in production and one isn’t. That’s about my normal hit rate if I go to a random team with a diff and don’t persistently follow up (as opposed to a team that I have reason to believe will be receptive, or a team that’s asked for help, or if I keep pestering a team until the fix gets taken).</p>
<p>If you’re very cynical, you could argue that it’s surprising the success rate is that high. If I go to a random team, it’s overwhelmingly likely that efficiency is in neither the team’s objectives or their org’s objectives. The company is likely to have spent a decent amount of effort incentivizing teams to hit their objectives – what’s the point of having objectives otherwise? Accepting my diff will require them to test, integrate, deploy the change and will create risk (because all deployments have non-zero risk). Basically, I’m asking teams to do some work and take on some risk to do something that’s worthless to them. Despite incentives, people will usually take the diff, but they’re not very likely to spend a lot of their own spare time trying to find efficiency improvements(and their normal work time will be spent on things that are aligned with the team’s objectives)<a href="https://danluu.com/algorithms-interviews/#fn:E" target="_blank" rel="noopener">4</a>.</p>
<p>Hypothetically, let’s say a company didn’t try to ensure that its developers could pass algorithms quizzes but did incentivize developers to use relatively efficient algorithms. I don’t think any of the three examples above could have survived, undiscovered, for years nor could they have remained unfixed. Some hypothetical developer working at a company where people profile their code would likely have looked at the hottest items in the profile for the most computationally intensive library at the company. The “trick” for both isn’t any kind of algorithms wizardry, it’s just looking at all, which is something incentives can fix. The third example is less inevitable since there isn’t a standard tool that will tell you to look at the problem. It would also be easy to try to spin the result as some kind of wizardry – that example formed the core part of a paper that won “best paper award” at the top conference in its field (IR), but the reality is that the “trick” was applying high school math, which means the real trick was having enough time to look at places where high school math might be applicable to find one.</p>
<p>I actually worked at a company that used the strategy of “don’t ask algorithms questions in interviews, but do incentivize things that are globally good for the company”. During my time there, I only found one single fix that nearly meets the criteria for the examples above (if the company had more scale, it would’ve met all of the criteria, but due to the company’s size, increases in efficiency were worth much less than at big companies – much more than I was making at the time, but the annual return was still less than my total lifetime earnings to date).</p>
<p>I think the main reason that I only found one near-example is that enough people viewed making the company better as their job, so straightforward high-value fixes tended not exist because systems were usually designed such that they didn’t really have easy to spot improvements in the first place. In the rare instances where that wasn’t the case, there were enough people who were trying to do the right thing for the company (instead of being forced into obeying local incentives that are quite different from what’s globally beneficial to the company) that someone else was probably going to fix the issue before I ever ran into it.</p>
<p>The algorithms/coding part of that company’s interview (initial screen plus onsite combined) was easier than the phone screen at major tech companies and we basically didn’t do a system design interview.</p>
<p>For a while, we tried an algorithmic onsite interview question that was on the hard side but in the normal range of what you might see in a BigCo phone screen (but still easier than you’d expect to see at an onsite interview). We stopped asking the question because every new grad we interviewed failed the question (we didn’t give experienced candidates that kind of question). We simply weren’t prestigious enough to get candidates who can easily answer those questions, so it was impossible to hire using the same trendy hiring filters that everybody else had. In contemporary discussions on interviews, what we did is often called “lowering the bar”, but it’s unclear to me why we should care how high of a bar someone can jump over when little (and in some cases none) of the job they’re being hired to do involves jumping over bars. And, in the cases where you do want them to jump over bars, they’re maybe 2” high and can easily be walked over.</p>
<p>When measured on actual productivity, that was the most productive company I’ve worked for. I believe the reasons for that are cultural and too complex to fully explore in this post, but I think it helped that we didn’t filter out perfectly good candidates with algorithms quizzes and assumed people could pick that stuff up on the job if we had a culture of people generally doing the right thing instead of focusing on local objectives.</p>
<p>If other companies want people to solve interview-level algorithms problems on the job perhaps they could try incentivizing people to solve algorithms problems (when relevant). That could be done in addition to or even instead of filtering for people who can whiteboard algorithms problems.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/11/%E9%87%91%E8%9E%8D%E6%88%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yuanchen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yuanchen's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/11/%E9%87%91%E8%9E%8D%E6%88%98/" class="post-title-link" itemprop="url">金融战</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-01-11 22:30:19 / Modified: 23:38:11" itemprop="dateCreated datePublished" datetime="2020-01-11T22:30:19-05:00">2020-01-11</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="索罗斯"><a href="#索罗斯" class="headerlink" title="索罗斯"></a>索罗斯</h3><p>第一，本期资本战争发生在外汇、期货、股票甚至房地产市场，又按照时间线发生在不同国家——这些战局互有牵连，推进也是由浅入深。</p>
<p>第二，问不到亲历过的人，信息源全靠自己挖。</p>
<p>中西方媒体的倾向性都很明显——双方都不客观，因此本期对于任何数据和资料，我必须找到第三方来佐证，信息源除了新闻、市场数据、采访和交易公告，还包括索罗斯的《改革全球资本主义》，《金融炼金术》，《索罗斯论全球化》，沈联涛的《十年轮回-从亚洲到全球的金融危机》，港府救市基金和量子基金数据，金融四十人论坛论文，《全球资本主义危机》以及《朱镕基讲话实录》，我不是推荐这些书啊，只为四个字：以我为准。</p>
<p>言归正传，这场战争发起者索罗斯，大家都多少对他有些偏见，虽然是犹太人，但他家庭并不富裕，索罗斯早期是个不折不扣的屌丝。</p>
<p>不过他生性高调且富有冒险精神，所以其发家史也是充满了各种投机和豪赌，虽然我们都说是索罗斯血洗东南亚、索罗斯狙击香港，但其实干这些事儿的是国际游资，索罗斯只是代表了其中的一小部分，之所以他来扛大旗，是因为他本人喜欢到媒体上高谈阔论，频频发表讲话或者接受采访，所以久而久之名气大了就成了一面旗帜，至于为什么在金融界他的名字让人闻风丧胆，那得看看他在狙击香港之前都干了什么，也让我们探究一下索罗斯带领的国际游资特有的战术战略。 </p>
<h3 id="欧洲"><a href="#欧洲" class="headerlink" title="欧洲"></a>欧洲</h3><p>时间回到那个风起云涌的时代，在经历了二战后，世界格局被一位坐在轮椅上的伟人重新定义，曾经的日不落眼睁睁看着霸权易主。英法式微，两德分裂，欧洲大国政治地位严重下滑，以至于在五十年代沦为冷战的马前卒。因此欧洲各国希望联合。摆脱美国制约。同时建立一个跨国家联盟，稀释各国主权缓解欧洲各国千年以来的冲突，同时强调经济合作，专注发展 欧共体也就是现在欧盟就是这个诉求的产物，在欧盟实行单一货币前，也就是还没有欧元这个货币前，欧洲国家制定了欧洲汇率机制（ERM），说白了就是把各国货币的汇率锁在一起，ERM就是英国金融市场的弱点，并且很快被国际游资察觉，当时欧洲的具体做法是，加入ERM的欧洲国家要把自己的货币跟德国马克挂钩，使自己的货币兑马克的汇率仅在小范围内波动，这样的操作造成只要马克贬值，欧洲其他货币一起贬值，马克升值，其他货币一起升值，这样你在欧洲经商的话，反正大家一起升或者一起贬，商人就不用太考虑汇率的影响了，这样才能推进欧洲经济一体化，当然这是政策制定者美好的初衷，但是汇率上的统一进退，就得保证利率上的统一进退，为什么呢，幼儿园化的讲，利率你们可以理解为把钱换成对应国家的货币后存起来的利息，如果英国利率是10%，德国利率5%，那你们肯定把钱换成英镑，都存到英国赚10%的利息啊，这样大家都把德国马克换成英镑，那英镑就会快速升值，而德国马克就会快速贬值，那这个欧洲汇率机制就维持不下去了，所以要想汇率统一进退，那利率也得统一进退。</p>
<p>这就是当时的背景 然而1989年柏林墙倒塌后，东德人大量涌入西德。德国的政府福利及社保开销大幅上升，因此德国政府财政赤字飙升，为了应对亏空，德国开始印钱，加剧通货膨胀，通胀压力迫使中央银行提高利率，这儿还得幼儿园化一下，通胀就是市面上的钱太多了，钱本身不值钱了，那怎么回收一下呢，就用提高利率的办法，利息高了，大家就会把钱用于投资或者直接存起来赚取利息，这样市面上流通的钱就减少了，当时德国被迫提高利率。而此时的英国经济正在衰退，通货紧缩，英国反而需要提高通胀，所以英国需要降低利率来刺激自己经济的复苏。但英国政府却受到欧洲汇率体系的限制，就因为德国的高利率政策，自己也得维系着高汇率和高利率，但是根据蒙代尔三角也称三元悖论：一国的经济目标有三种：</p>
<p>①各国货币政策的独立性；</p>
<p>②汇率的稳定性；</p>
<p>③资本的完全流动性。 </p>
<p>这三者，一国只能三选其二，而不可能三者兼得。但英国想三个都占，在维持汇率稳定和自由的资本流动前提下，英国还要维持高利率。这就是饮鸩止渴。索罗斯也正是在赌英国无法同时维持这三者，而必须放弃汇率稳定，退出欧洲汇率机制。到时候被高估的英镑就会崩盘式下跌。</p>
<p>所以闻到了血腥的味的索罗斯开始为狙击英镑作准备。</p>
<p>虽然英国首相和财政大臣在各种公开场合一再重申坚持现有政策不变，英国有能力将英镑留在欧洲汇率体系内，翻译成人话就是，我们英国政府依旧会维持英镑和马克的汇率，那些投机者抛售的英镑我们政府全给他买回来，力挺英镑汇价，但索罗斯的判断是——英国政府是在虚张声势，所以开始大举做空英镑，做空是什么意思不做赘述，没做笔记的参考保时捷那期，索罗斯开始用各种方法借入英镑，一边在市场上抛售砸盘一边在媒体上制造恐慌情绪 在这段时间里，市场对于英镑的不信任开始发酵，英镑对马克的比价在不断地下跌，从2．95跌至2．8，英国政府为了对抗索罗斯代表的国际空军，从市场上大举买入33亿英镑来干预市场。于是当时就是一边索罗斯在抛，一边英国央行在接，虽然英镑汇率有所小涨，但很快又回到了下行通道，这使索罗斯为代表的国际游资更加坚信自己的判断，国际游资从1992年7月开始就从各大金融机构手中借走大量英镑和里拉，然后9月在外汇市场卖掉换成德国马克，大规模的抛售英镑和意大利里拉使得市场陷入恐慌，这些国家的央行尤其是英国央行——英格兰银行不得不拆巨资来购买各自的货币来维持原汇率，索罗斯在做空各国货币的同时，他还预测各国为了对抗自己，未来一定会短期内提高利率，因此在欧洲各国的利率期货的多头市场上做了埋伏，多头就是涨了赚钱空头就是跌了赚钱啊，随着国际游资的持续抛盘，市场上出现了恐慌情绪，加之索罗斯利用欧洲媒体散布不利于英国的消息，英镑持续下跌，空头渐渐压过了多头，英国政府为了扳回局势，从国际银行组织借入资金继续买入英镑，企图阻止英镑继续贬值，但此时市场看空英镑的趋势已经形成，以索罗斯代表的国际游资势头正猛，连很多英国本土机构加入了做空英镑的行列，所以虽然政府在市场上不断承接这些空军抛售的英镑，但国际游资也不断加大抛盘力度，仅索罗斯一人就抛售了120亿美元的英镑，大量基金、小银行甚至英国百姓都受到当时气氛的影响，恐慌的情绪造成大家争先恐后的抛售英镑，空军形成碾压之势，1992年9月15日，英镑对马克的比价已跌至欧洲汇率体系规定的下限。英镑已处于退出欧洲汇率体系的边缘。英国只好殊死一搏，之后的一天内，英格兰银行为了吸引资金回流，拉升英镑汇率，歇斯底里的将利率提升了两次，由10%分两次提高到了15%，现在咱们听说利率提高了0.5%就如同听到了大新闻一样转发，所以能想象当时英国一天就提升了5%是多么绝望的一个操作了吧。但没想到收效甚微，欧洲资本市场根本不买英国央行的账，再加上空头继续倾泻式的抛盘，英镑的汇率最终跌穿2．778的最低限。至此，英国政府已经动用了价值269亿美元的外汇储备，但最终还是惨败，当天晚上被迫宣布退出欧洲汇率体系。这样英镑汇率就不会维持在一个固定的区间内了，英镑犹如脱缰野马开始贬值，之后的几天里疯狂跳水，英镑兑马克贬值16%。英镑兑美元贬值26%，英国人史称黑色星期三。</p>
<p>索罗斯也被经济学家杂志称为打垮了英格兰银行的人。索罗斯曾在书中透露，当时准备了超过150亿美元的英镑筹码，然而在投入120亿的时候英国就投降了，索罗斯从英镑空头交易中获利近10亿美元，而索罗斯也早就预测到了各国在应对危机时的利率政策，在英国、法国和德国的利率期货上埋伏的多头也帮他赚了不少，再加上做空英镑的大获全胜，当年他的总利润高达20亿美元，在这一年里，索罗斯的基金增长了67.5％ 这次战役的大捷让索罗斯尝到了甜头，以他为代表的国际游资也总结出了一套手术刀式的做空战术，既然我用这种方法能打败英国，那其他国家呢？</p>
<h3 id="东南亚"><a href="#东南亚" class="headerlink" title="东南亚"></a>东南亚</h3><p>之后他的目光瞄准了东南亚，90年代初期，当西方国家正处于经济衰退中，东南亚国家的经济却出现奇迹般的增长，当时由于广场协议，日本的制造业成本高得离谱，所以日本企业都把工厂迁往东南亚，尤其是泰国，随着时间的推移，泰国经济过热的迹象更加突出，泰国央行不断提高利率来降低通货膨胀。这个画面是不是似曾相识，高利率吸引了大量国际游资进入泰国，加之当时泰国在东南亚各国金融市场的自由化程度最高。这样泰国就被架到了一个很危险的高位，索罗斯闻到了猎物的味道，在 1995 年 1 月中旬泰国的房地产价格开始下跌时，索罗斯就对泰铢进行了试探性进攻——在即期外汇市场大量抛售泰铢。但泰国央行直接入市干预，此次进攻并未酿成危机。这里科普一下泰国的汇率制度，由于泰国实行盯住“一篮子货币”的固定汇率制度，而篮子中的主要货币——美元的权重占80%至82%；所以说白了泰国就是盯住美元的固定汇率，泰铢对美元的汇率长期维持在25∶1，这段时间由于美元汇率持续走低，泰铢跟随美元一起贬值，这就导致泰国出口持续增长，这也得幼儿园化一下，为什么货币贬值就能刺激出口，比如我是生产玩具的，一件玩具卖25泰铢我就能有不错的利润，如果泰铢对美元的汇率为25泰铢换1美元，那我玩具在美国就卖1美元，但现在泰铢贬值了，变成25泰铢换0.8美元了，那我的玩具在美国只用卖0.8美元我就能赚，相较于其他玩具，我的玩具就明显具备价格优势——又便宜又没有牺牲质量，大家都来买我的性价比高的玩具，这个玩具市场就慢慢被我占领了，因此当时泰国生产卖到了全世界，泰铢跟随美元贬值强力的刺激了泰国的出口，导致泰国经济快速发展。1986~1994年，年平均出口增长率达到22%，经济增长率达9.5%，成为“亚洲四小龙”之一。这个场景对于看过我经济崛起那期的同学，是不是觉得和我们加入世贸之后有点像？ 但是自1993年起，美国计算机互联网产业崭露头角，美国经济迎来新的一轮增长，所以国际汇率有所变化，美元对主要货币由贬值转为升值，所以泰铢又跟着美元一起升值，刚才说货币贬值可以让我的东西卖的更实惠抢占市场，但这一升值，东西就变贵了，慢慢的卖不出去了，这就对泰国出口和经济增长当头一棒。泰国慢慢发现以前我把东西卖到全世界躺着赚外汇，但现在卖不出去了，国库慢慢儿入不敷出了，在固定汇率制度下，就是刚才说的盯住美元汇率制度下，外汇市场失去了自我调节的功能，面对不断恶化的国际收支形势，泰国政府不得不快速放开资本市场，通过各种优惠政策和高利率，吸引国外资本流入，弥补国际收支赤字，当时泰国政府走了两步棋，简直让国际游资开心到爆炸，一是开放离岸金融业务，凡获批准的商业银行均可从国外吸收存款和借款，并在泰国境内发放外币贷款。二是企业可以自由对外借款，非居民在国内和国外可自由开立泰铢账户，进行存款、借款和自由汇兑。听不懂没关系，你只要知道这两组政策直接给外国投机者打开了镣铐，来吧，来我们这儿随便玩儿。刚才说到泰国出口遭受打击，因此泰国制造业利润率下降，但资本都去回报率高的地方啊，你出口和实业不赚钱了，大量资本就流入房地产和股市，形成严重泡沫。1993到1996年仅3年多，泰国的房地产均价上涨了近4倍。 好了，现在万事俱备只欠索罗斯，到了1996年，泰国的资本账户已经完全开放，外资可以随意进入，1997年2月，索罗斯代表的国际游资开始行动了，他们与泰国央行签订远期合约，利用抵押当地资产的方式，借入大量泰铢然后在外汇市场抛售泰铢换成美元。关于期货、期权和收益互换我不赘述了，在保时捷和爱马仕LV那期都解释过，2 月 14 日，由于索罗斯大量抛售泰铢，泰国央行发现不妙开始反击，在外汇市场上大量购入泰铢，同时提高短期利率，就是索罗斯他们做空泰铢，总得先借到泰铢才能卖掉砸盘啊，但是借泰铢也得给别人利息，泰铢短期利率的提高就是为了打击这些国际投机分子的，我把借泰铢的利息定的巨高，看你们还借不借，这两板斧用出来之后，泰铢即期汇率很快得到稳定，第一轮做空失败，但泰国的外汇储备被大量消耗。索罗斯为首的国际游资并没有放弃，老子是干过英格兰银行的人，泰国我也势在必得，当年的一些新闻和采访非常有意思，索罗斯为首的国际对冲基金在各种国际媒体上，包括泰国当地媒体疯狂叫嚣，在舆论上形成了泰国这边是大刀加步枪，而我索罗斯是核弹加特林的局面，国际资本又一次站到了索罗斯的空军这一边，我在查阅资料的时候发现甚至一些泰国自己的银行和投资机构也在做空自己，发国难财，空头对多头的碾压之势形成，这一切都那么似曾相识，三个月之后，索罗斯为首的空头卷土重来，开始有计划有组织的在市场上抛售泰铢，手术刀式的砸盘开始了，至1997年5月底，泰铢从25：1下跌到26.6:1。而这时泰国央行才开始反击：直接动用100亿美元接盘空军抛出来的泰铢；同时禁止银行借泰铢给国际游资。而且泰国政府开始打击放出不利言论的媒体，出动警察进入交易所和监管机构进行调查，追踪抓捕空头账户的控制人，泰国政府的绝地反击并没能阻止大势，反而自己的公信力进一步下降，市场上消极的情绪弥漫，连泰国百姓都认为泰铢的价格就要崩溃了，于是老百姓就跟风用泰铢换美元。形成了全民泰国危机大逃亡，这导致本来要用外汇储备和国际游资搏杀的政府不得不把美元外汇储备换给这些恐慌的百姓，进一步加速了外汇储备的消耗，到1997年6月底，泰国外汇储备下降300亿美元，外汇池基本干涸，没有了外汇储备就等于没有了弹药，眼睁睁的看着国际游资继续砸盘。而此时泰铢对美元的汇率已经跌破28∶1。1997年7月2日，弹尽粮绝的泰国政府被迫宣布放弃固定汇率制度，当天泰铢对美元的汇率直接崩盘，跳水30%。之后的25天内，泰铢汇率继续疯狂跳水60%。泰铢如同废纸一般被大家唾弃，国际游资血赚40亿美元，泰国人的财富也被彻底洗劫一空，泰铢大幅度贬值迅速波及包括菲律宾、马来西亚、新加坡、韩国和印度尼西亚在内的整个东南亚地区，最终形成了亚洲金融危机，当然亚洲金融危机的形成也不只是因为泰铢崩盘，泰铢崩盘只是导火索之一，金融危机背后的原因非常复杂也很有意思以后会单做一期，在击破泰铢之后，索罗斯并不满足，他决定席卷整个东南亚，索罗斯的空头飓风很快就扫荡了印度尼西亚、菲律宾、缅甸、马来西亚等国家。国际游资用着同样的招数和套路，似曾相识的场景不断上演，印尼盾、菲律宾比索、缅元、马来西亚林吉特都不是国际游资的对手，一开战就直接拉闸，汇率集体跳水，导致这些国家的工厂倒闭，银行破产，物价上涨，百姓失业，东南亚一片鬼狐狼嚎，惨不忍睹。这场扫荡东南亚的空头飓风一举刮去了百亿美元的财富，使这些国家人民辛辛苦苦积累的几十年经济增长化为灰烬。人民的财富被国际游资洗劫一空。</p>
<h3 id="香港"><a href="#香港" class="headerlink" title="香港"></a>香港</h3><p>索罗斯再次笑到了最后，这时这位空军领袖的资金实力也因几场大捷变的空前强大，野心进一步膨胀 好了，现在进入本期最高能的环节，这个披荆斩棘的空军魔王目光盯上了我们的金融中心——香港，这回，他想把相同的手术刀套路用在香港。</p>
<p>香港和泰国也有一些相似之处，</p>
<p>第一是香港享有国际自由金融中心的美誉，国际资本在港流动相对自由，</p>
<p>第二，香港的联系汇率制度和泰国最早的固定汇率制度神似，关于汇率制度做一下科普，固定汇率就是泰铢那种盯住一篮子货币的制度，联系汇率是指将港币与某特定外币的汇率固定下来，并严格按照兑换比例使货币发行量随外汇存储量联动的货币制度。</p>
<p>解释一下，就是香港有三家发钞银行：汇丰银行、渣打银行和中国银行。它们每发行7.8港币必须向香港的金融管理局交纳1美元，以此来保证港币背后有美元作为支撑，维持汇率稳定。这就是联系汇率，而浮动汇率就是字面意思，泰国的固定汇率被国际游资玩烂了就只好实行有管理的浮动汇率了，汇率制度是理解国际资本战争、国际贸易甚至国际经济局势的基础，再幼儿园化一点可以把港币当成美元的代金券，合7.8港币代表1美元。代金券理论确实好记但我还是要扩展一下，2005年开始，香港联系汇率制度增加了强方兑换保证（1美元兑7.75港币）和弱方兑换保证（1美元兑7.85港币），并承诺只要触及区间的任何一边，香港金管局会入市干预，让汇率在1美元兑7.75-7.85港币之间浮动，回到1997年，国际游资认为香港和英国泰国差不多，没能力维持汇率稳定。自己的老套路可以用起来，所以开始着手狙击香港，但空军没有直接攻击外汇市场，而是进行手术似的慢条斯理的布局，开始提前低调借入港币，囤积筹码，等机会砸盘，这个跟做空泰铢和英镑的方法类似，但当局及时发现了有人在大量借入港币。香港金管局的总裁任志刚应对策略也很简单，听说你们要借港币？那我就提高香港银行同行业拆借利率，使借港币的利息成本大幅上升，看你们还借不借，而因为每次索罗斯大举借港币，任志刚就用这一招，同一招被用了三次，因此任志刚被圈内人笑称任一招。但这招却上了索罗斯的当，具体是怎么操作的呢， 1997 年 10月索罗斯为首的空军开始了进攻。空军在货币市场大量抛售港币，港币汇率下跌。到了10月底，许多银行在金管局结算账户上的港币已经没有足够结余，而金管局为了进一步提高国际游资借港币的成本，不仅没有注入港币流动性，反而发出通知，要对反复通过流动性机制向金管局借港币的银行收取惩罚性的高息。一时间港币难求，同业隔夜拆借利率一度飙升至 300%。这里肯定有人听晕了，降维说，就是当时港府把所有在市场上借港币的人都怀疑是索罗斯那边儿的空军，在市场上本来流通的港币就不多的情况下，还在大量回收流动性，市场上流通的港币就更少了，到处都借不到港币，大家没有了流动性（港币），市场上又借不到，怎么办，卖资产换钱呗，本来担心联系汇率不保的香港居民和外国投资者就更加大量抛售港币资产，尤其是港股，再加上银根的突然收紧，任一招的提高短期利率，使股市雪上加霜，股票开始暴跌，恒生指数一路向下。原来索罗斯在这等着呢，索罗斯早在几个月前就已经布局好了空头头寸，你让我借不到港币，但你的代价是楼市股市承压，我就做空股市，我的空军从股市下跌就可以大量获利。1997年10月，恒生指数因为这一波趋势持续下跌，这也引起了小规模的恐慌导致大量跟风抛盘，再加上国际游资的空军砸盘和舆论上的煽风点火，恒生指数从1997年10月3日的15000多点，一路倾泻至10月28日的9060点，引用人民网对当时的一段报道：1997年10月20日，香港市民苏顶明永远不会忘记这一天。苏顶明是一名普通的出租车司机，此前他到内地玩了6天。等回到香港时他却发现，原本价值30多万元的股票就只剩下不足4万元 在股票空头成功获利后，索罗斯为首的国际游资士气大振，又玩起了老一套舆论战术，频繁出现在各大媒体，发表各种不利于香港的言论，并且叫嚣着要像当年席卷东南亚一样，完全击溃港币，这一连串的舆论引导，马上又吸引了大量的空军秃鹫加入索罗斯的阵营，香港如临大敌，黑云压城城欲摧，1998 年起，空军开始连续对香港发动攻击。此时香港节节败退，已经开始有中文媒体和金融机构预言香港将要全面崩盘。路边小报八卦杂志都在担心香港的未来，恐慌的情绪一直在蔓延，1998 年 8 月，港币到了最危险的时候。国际游资的攻击变本加厉，大肆卖空港币。从 1998 年年初到 8 月中旬，每当港币利率稳定就借入港币，8 月港币空头规模已经超过了300 亿港币。同时空军大量积累股票和股指期货的空头头寸。根据当时官方新闻和数据，截至 1998年 8 月，国际游资大约有 8 万份空头合约。恒生指数每下跌 1000 点，国际游资便可获利40 亿港币。这些秃鹫在静静地等待时机 8 月 5 日，蓄谋已久的空军开始了新一轮猛烈轰炸，砸盘开始，即期外汇市场出现 300 多亿港币的卖盘，远期外汇市场也出现 116 亿港币的卖盘。8 月 6 日，香港和伦敦市场又出现 155 亿港币的卖盘。8 月 7 日，市场再出现 78亿港币的卖盘。随着汇率承压，股市也一路狂泻，空军同时在股票市场砸盘。空头的双线操作导致当日恒生指数收报 7018 点下跌 3.5%，5 个交易日累计跌去 917 点，2500 亿港币市值化为乌有 我们确实醒悟的太晚了，还没等我们做出反应，空军乘胜追击，1998年8月13日香港恒生指数跌穿6600点，从1997年8月16000多点的高位下跌将近10000点至6600点，这是香港的至暗时刻，中产阶级的财富惨遭洗劫，难道我们也要像英国泰国一样，被掠夺几十年的发展成果？此时离8月28日的恒指交割日时间已近，眼看这些国际游资马上可以血赚一笔。甚至还想试图想引起恐慌一举击溃港币的联系汇率制度，港府在这个存亡之秋，顶着巨大的压力做出了艰难的决策——政府入市干预，有人这时就会问了：做个决策怎么就艰难了，这样的决策，其实就是拿着人民的钱去和空军搏杀，而且要一定程度牺牲自由港的声誉，如果做了这个决策结局还是负面的，那个决策者很容易成为历史罪人甚至留下千古骂名，这段由于涉及国家领导人，为了能在国内发出，我不细说了，总之拍板是个很复杂的过程。而同一时期，港府也获得了来自中央的承诺，这里要强调一下，国内很多文章和视频都说眼看香港支撑不下去了，北京就支援香港大量的外汇储备，对于热血而充满期待的看客，我知道，如果这时候加上这样一个桥段，中央如救世主一般踩着祥云，闪现到被打的奄奄一息的港府身后，万丈光芒，伸出援手，绝地反击，那节目效果就太好了，但你们是了解我的，要对得起以我为准这四个字，还是要谨慎，所以我在这块进行了大量的挖掘，在各种回忆录、新闻、采访和人物传记中都没有找到明确的证据证明直接给了外储，所以这个热血的场景可能只是营销号为了迎合大家情绪的一厢情愿，既然没有证据，我们就不能说直接给外汇了，而且港府当年本身也有约980亿美元的外汇储备，虽然没直接给，但中央政府确实公开承诺过，以下是当时朱镕基答记者问的珍贵画面，朱总理当时这段话的力度非常大，这段我看了好几遍，在我写作的时候还有点激动的 1998年8 月 14 日是这场战役的转折点，此前被痛打的香港金融市场，弥漫的硝烟中突然杀出一只训练有素的军队，政府入市搏杀绝地反击。政府开始有序的购买恒生指数中 33 种成分股，拉动指数攀升，当天恒生指数上升 564 点，报收 7244 点，国际游资受到初步打击。同时港府在远期外汇市场上承接国际游资的卖盘并要求各券商不要向国际游资借出股票，切断空军的“弹药”供应。局势开始逆转，空军接连遭受打击，三市场开始呈现上扬趋势，空军开始慌了，他们没想到中央会公开承诺也没想到港府会入市，那既然这样，我就要把你们一波全带走，歇斯底里的空军准备玩一票大的，他们认为，在结算日8月28日前，凭借手中还有大量筹码，可以一举击溃整个香港 1998年8月27日，也就是结算日8月28日前一天。上午10点股市开盘。一开始，空军的卖盘就如排山倒海一般扑来。在第一个15分钟内，成交额就达19亿港币；在第二个15分钟内，成交额为10亿港币。而在收市前的15分钟，战斗进入白热化状态，全天交易之惨烈，令场上所有交易员都目瞪口呆。这一天，香港政府动用了200亿港币，委托10家经纪行在33家恒指成分股上围追堵截。恒生指数报收7922点，比上一个交易日上扬88点，这是自97年11月4日以来的最高点。 对于即将来临的8月28日结算日，国际游资的空头和港府的多头，当晚无人入眠 时间最终来到了决战之日， 8 月 28 日这一天香港街道熙熙攘攘，这座城市依旧像往常一样运转，风平浪静的表象下是金融市场的风起云涌，有一点要提前科普一下，恒指期货的结算价格为这一天每五分钟恒生指数的平均值，因此，要抬高结算价，就必须保证恒生指数走势平稳且一直保持在高位，要达此目的，我们必须得竭尽全力，寸土必争，换句话说，索罗斯代表的空军砸多少，我们就得接多少，8 月 28 日上午10点整开市后，仅5分钟，股市的成交额就超过了39亿港币。半小时后，成交金额就突破了100亿港币，到上午收盘，成交额已经达到400亿港币，下午开盘后抛售有增无减，成交量一路攀升，但国家队的围追堵截一直让恒指和期指始终维持在7800点以上，随着下午4点的收盘钟声响起，显示屏上不断跳动的恒指、期指、成交金额最终分别锁定在7829点、7851点和790亿港币上。根据还能找到的且有第三方佐证的资料和报道，当时空军约在7500点卖空恒指8月合约，而结算点位收在7851点，空军在做空恒指8月合约上巨亏，在这一天，港府动用了几乎所有可以动用的外汇储备，全盘吃下国际卖盘，平均每分钟就有价值3.5亿的股票易手。全天成交额达到了香港股市有史以来的最高纪录——790亿港币。2005年3月17日出版的《南方周末》曾以这样一段文字记述当年的那一幕:“许多香港人攥紧了矿泉水瓶，在炎热的天气里挤在一起，看着证券交易所的显示牌目瞪口呆。” 1998年9月7日，香港金融管理局颁布了外汇、证券交易和结算的新规定，使国际游资的投机大受限制。当日恒生指数飙升588点，以8076点报收。加上日元升值、东南亚金融市场趋稳等因素，空军的资金、换汇成本大幅上升，不得不败退离场：9月8日，9月合约价格升到8220点。8月底转仓的期指合约要平仓退场，每张合约又要亏损4万港币。至此，国际游资见大势已去，纷纷丢盔弃甲，落荒而逃 回顾整场战役，虽然空军在最后阶段的空单巨亏，但是很多在早期就布局做空港股的投机者还是赚的，有人就要问了，为什么港府只拉到7851点，而不是想尽办法拉到10000点甚至更多呢，这样不就可以让空军亏的更多吗，先不说当时我们有没有能力做到，就算可以做到我们也不会去做的，香港以自由市场的招牌吸引国际资本来维持繁荣，索罗斯要打垮三个市场还要击溃联系汇率机制。这就太过分了，港府才出手干预，打退了点到为止即可，即便这样当时做出决策的人还心惊胆战，如果直接把索罗斯打死，虽然我们扬眉吐气，但以后国际资本就不认香港这块自由市场的招牌了，所以关于这场战役的胜负结论如下。1、政府是胜方：这场战役保住了恒指，保住了三个市场的稳定，也保住了联系汇率制度，达到了港府的战略目标，虽然损失了部分自由市场的声誉，但相对于保住根基是值得的。同时国家队在底部进入市场干预进行救市，在市场恢复后，国家队的基金盈利颇丰。2、索罗斯代表的空军并不是最大输家，香港民众、普通股民和小型跟风投机者才是损失最惨重的，尤其是从16000跌到6600那段时间，在三个市场中，中产阶级财富遭受重创。3、国际游资一部分确实是亏的很惨，但还是有很多早期就布局的赚了不少，索罗斯的量子基金前期赚钱，后期赔钱，两者相抵总体上没赔多少，这期最难的一块就是探索到底索罗斯是亏了还是赚了，如果是亏了，到底亏了多少，双方的战损比也是一场战役胜负的重要评判标准，我对比了量子基金98年的年报，现在居然还能搜到，水分多大先不说，至少当时这些基金在信息披露和投资者关系这一块还是很规范的，年报中指出截至1998年12月31日，基金业绩受到两方面头寸的重大不利影响——集中在俄罗斯和印尼市场，而没提到香港，可以看出当年在香港亏损占总亏损比例不大，而索罗斯本人在自传中的态度是：在香港基本没亏。但我不信，因为我在研究他的资料和背景时发现，这个b说话也不完全靠谱，曾经上个月的答记者问和这个月的采访对不上，自己写的书和采访时候说的又不一样。所以他的话也不能全信，这期文案我在写的时候老以为自己弄错了，把三方数据拿出来一对才知道信息源本身矛盾，再加上他旗下的基金名字又特别相似，海外媒体报道的时候还会把名字写串，各种因素导致写到这块的时候因为挖掘和核对信息头快炸了，但怎么都对不上，所以我放弃计算具体金额了，我选择换个思路——确定亏损的区间，首先我们刚才知道了他亏损的数量级，再根据当时一则八卦新闻——某接近索罗斯的Banker声称，1998年除了在俄罗斯的亏损外，索罗斯集团在香港也亏损了20亿美元。这个八卦新闻是不是真的不要紧，重要的是量子基金的官方发言人出来辟谣了，说亏损20亿美元是错误的，并且拒绝回答亏损是比20亿多还是比20亿少。巫师给大家分析一下啊，当时这件事在金融圈沸沸扬扬，市场上八卦和谣言四起，官方只辟谣了20亿这个数字，图什么呢，我索罗斯不要面子的啊，我天天在媒体上叫嚣要干死香港结果你现在说我赔了20亿，我这老脸往哪放，肯定是根本没赔这么多你非说我赔了这么多，侮辱了我量子基金的名誉，我旗下的基金都是很强的很能赚钱的啊，你们别泼脏水，说白了就是这个行为本身大概率承认了亏损小于20亿，这回破案了，看来八卦确实是接近真相的重要手段，但是这只是我的推论，只是给大家一个概念，我为什么这么纠结他到底亏了多少呢，因为国内的文章和视频经常动不动就鼓吹索罗斯大败亏损百亿什么的，而我想给大家一个客观的概念，免得听信了营销号，好像这次战役我们真把人家血虐了似的，其实人家只是小亏，索罗斯亏得最惨的还是在毛子手里，因为毛子犯浑耍赖，还有他在日元也栽了大跟头，如果反馈好可以单做一个索罗斯失败合集，这一场香港保卫战的终结标志着国际游资的手术刀式战略行不通了，从1992攻击英国就开始使用的这一系列战术战略，也是国际游资自认为万能公式的攻击套路，在香港的决战中寿终正寝</p>
<p>我给大家的结论虽然是索罗斯没亏多少，但是这场战役对我们意义重大，1998年那会儿，欧美看咱们就跟看个弱智一样，又穷又傻，衣衫褴褛，愚昧落后，在他们眼中，98年的我们就是个落后的第三世界国家，在这些金融大鳄眼中，我们的经济金融实力如同东南亚小国一样可以任人鱼肉，他们认为他们可以如探囊取物般从香港掠夺巨量的财富，甚至不惜把香港蹂躏至三大市场崩溃，汇率制度崩盘，人民几十年辛勤劳动积累的财富化为乌有，但是我们成功阻止了这场噩梦的发生，这一场打赢在家门口的硬仗，有着特殊的意义 我们都看到了中国在各个领域的崛起：政治和外交话语权的逐步扩大，军事领域国防力量的推陈出新，航天领域新的技术突破，中国资本走向世界，还有我们的高铁、基建、5G等等等等，我们在这些看的见的地方站起来了，甚至在一些领域引领全球，然而在你们看不到的金融领域，在这些数字和博弈的背后，在各种交易、算法和规则的斡旋背后，我们也用一场场硬仗维护着中华民族的尊严和威慑，这次索罗斯代表的国际游资撞到我们这块钢板，是在向全世界传达一个重要信息——这个市场不好惹。一场硬仗让家门外的豺狼虎豹不敢轻易大举攻击人民币，给未来的人民币汇率稳定和十几年的经济腾飞打下坚实基础，我们的果敢和坚定反击让这些秃鹫一直对中国主权金融实体保有敬畏，在帷幕前的成就也是来自于帷幕后的支撑，1998年后的中国在国际上披荆斩棘，我们的经济列车过关斩将，历史车轮滚滚向前，时代洪流浩浩汤汤，广袤的华夏大地上一幅幅绚丽壮阔的史诗不断盛开，中华民族能以更加昂扬的姿态立于世界之林，纵横20余年，在世界的海洋中，中国号这艘巨轮，承载着我们共同意志和向往，凝聚着台前幕后各行各业奋斗进取的磅礴力量，虽然周围暗涌环伺，但我们依旧昂扬向前，在看的见的地方站的直是因为在看不见的地方站的稳，这也是那一代先驱传承下来的隐形宝藏 资本永不眠。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/10/How_to_become_a_hacker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yuanchen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yuanchen's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/10/How_to_become_a_hacker/" class="post-title-link" itemprop="url">How to become a hacker</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-01-10 22:35:32 / Modified: 23:54:32" itemprop="dateCreated datePublished" datetime="2020-01-10T22:35:32-05:00">2020-01-10</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>Hacking</strong></p>
<p>What should you do in college to become a good hacker? There are two main things you can do: become very good at programming, and learn a lot about specific, cool problems. These turn out to be equivalent, because each drives you to do the other.</p>
<p>The way to be good at programming is to work (a) a lot (b) on hard problems. And the way to make yourself work on hard problems is to work on some very engaging project.</p>
<p>Odds are this project won’t be a class assignment. My friend Robert learned a lot by writing network software when he was an undergrad. One of his projects was to connect Harvard to the Arpanet; it had been one of the original nodes, but by 1984 the connection had died.  Not only was this work not for a class, but because he spent all his time on it and neglected his studies, he was kicked out of school for a year.  It all evened out in the end, and now he’s a professor at MIT. But you’ll probably be happier if you don’t go to that extreme; it caused him a lot of worry at the time.</p>
<p>Another way to be good at programming is to find other people who are good at it, and learn what they know. Programmers tend to sort themselves into tribes according to the type of work they do and the tools they use, and some tribes are smarter than others. Look around you and see what the smart people seem to be working on; there’s usually a reason.</p>
<p>Some of the smartest people around you are professors. So one way to find interesting work is to volunteer as a research assistant. Professors are especially interested in people who can solve tedious system-administration type problems for them, so that is a way to get a foot in the door. What they fear are flakes and resume padders. It’s all too common for an assistant to result in a net increase in work. So you have to make it clear you’ll mean a net decrease.</p>
<p>Don’t be put off if they say no. Rejection is almost always less personal than the rejectee imagines. Just move on to the next. (This applies to dating too.)</p>
<p>Beware, because although most professors are smart, not all of them work on interesting stuff. Professors have to publish novel results to advance their careers, but there is more competition in more interesting areas of research. So what less ambitious professors do is turn out a series of papers whose conclusions are novel because no one else cares about them. You’re better off avoiding these.</p>
<p>I never worked as a research assistant, so I feel a bit dishonest recommending that route. I learned to program by writing stuff of my own, particularly by trying to reverse-engineer Winograd’s SHRDLU. I was as obsessed with that program as a mother with a new baby.</p>
<p>Whatever the disadvantages of working by yourself, the advantage is that the project is all your own. You never have to compromise or ask anyone’s permission, and if you have a new idea you can just sit down and start implementing it.</p>
<p>In your own projects you don’t have to worry about novelty (as professors do) or profitability (as businesses do). All that matters is how hard the project is technically, and that has no correlation to the nature of the application. “Serious” applications like databases are often trivial and dull technically (if you ever suffer from insomnia, try reading the technical literature about databases) while “frivolous” applications like games are often very sophisticated. I’m sure there are game companies out there working on products with more intellectual content than the research at the bottom nine tenths of university CS departments.</p>
<p>If I were in college now I’d probably work on graphics: a network game, for example, or a tool for 3D animation. When I was an undergrad there weren’t enough cycles around to make graphics interesting, but it’s hard to imagine anything more fun to work on now.</p>
<p><strong>Math</strong></p>
<p>When I was in college, a lot of the professors believed (or at least wished) that computer science was a branch of math. This idea was strongest at Harvard, where there wasn’t even a CS major till the 1980s; till then one had to major in applied math. But it was nearly as bad at Cornell. When I told the fearsome Professor Conway that I was interested in AI (a hot topic then), he told me I should major in math. I’m still not sure whether he thought AI required math, or whether he thought AI was nonsense and that majoring in something rigorous would cure me of such stupid ambitions.</p>
<p>In fact, the amount of math you need as a hacker is a lot less than most university departments like to admit. I don’t think you need much more than high school math plus a few concepts from the theory of computation. (You have to know what an n^2 algorithm is if you want to avoid writing them.) Unless you’re planning to write math applications, of course. Robotics, for example, is all math.</p>
<p>But while you don’t literally need math for most kinds of hacking, in the sense of knowing 1001 tricks for differentiating formulas, math is very much worth studying for its own sake. It’s a valuable source of metaphors for almost any kind of work.[3] I wish I’d studied more math in college for that reason.</p>
<p>Like a lot of people, I was mathematically abused as a child. I learned to think of math as a collection of formulas that were neither beautiful nor had any relation to my life (despite attempts to translate them into “word problems”), but had to be memorized in order to do well on tests.</p>
<p>One of the most valuable things you could do in college would be to learn what math is really about. This may not be easy, because a lot of good mathematicians are bad teachers. And while there are many popular books on math, few seem good. The best I can think of are W. W. Sawyer’s. And of course Euclid. [4]</p>
<p><strong>Everything</strong></p>
<p>Thomas Huxley said “Try to learn something about everything and everything about something.” Most universities aim at this ideal.</p>
<p>But what’s everything? To me it means, all that people learn in the course of working honestly on hard problems. All such work tends to be related, in that ideas and techniques from one field can often be transplanted successfully to others. Even others that seem quite distant. For example, I write essays the same way I write software: I sit down and blow out a lame version 1 as fast as I can type, then spend several weeks rewriting it.</p>
<p>Working on hard problems is not, by itself, enough. Medieval alchemists were working on a hard problem, but their approach was so bogus that there was little to learn from studying it, except possibly about people’s ability to delude themselves. Unfortunately the sort of AI I was trying to learn in college had the same flaw: a very hard problem, blithely approached with hopelessly inadequate techniques. Bold? Closer to fraudulent.</p>
<p>The social sciences are also fairly bogus, because they’re so much influenced by intellectual fashions. If a physicist met a colleague from 100 years ago, he could teach him some new things; if a psychologist met a colleague from 100 years ago, they’d just get into an ideological argument. Yes, of course, you’ll learn something by taking a psychology class. The point is, you’ll learn more by taking a class in another department.</p>
<p>The worthwhile departments, in my opinion, are math, the hard sciences, engineering, history (especially economic and social history, and the history of science), architecture, and the classics. A survey course in art history may be worthwhile. Modern literature is important, but the way to learn about it is just to read. I don’t know enough about music to say.</p>
<p>You can skip the social sciences, philosophy, and the various departments created recently in response to political pressures. Many of these fields talk about important problems, certainly. But the way they talk about them is useless. For example, philosophy talks, among other things, about our obligations to one another; but you can learn more about this from a wise grandmother or E. B. White than from an academic philosopher.</p>
<p>I speak here from experience. I should probably have been offended when people laughed at Clinton for saying “It depends on what the meaning of the word ‘is’ is.” I took about five classes in college on what the meaning of “is” is.</p>
<p>Another way to figure out which fields are worth studying is to create the <em>dropout graph.</em> For example, I know many people who switched from math to computer science because they found math too hard, and no one who did the opposite. People don’t do hard things gratuitously; no one will work on a harder problem unless it is proportionately (or at least log(n)) more rewarding. So probably math is more worth studying than computer science. By similar comparisons you can make a graph of all the departments in a university. At the bottom you’ll find the subjects with least intellectual content.</p>
<p>If you use this method, you’ll get roughly the same answer I just gave.</p>
<p>Language courses are an anomaly. I think they’re better considered as extracurricular activities, like pottery classes. They’d be far more useful when combined with some time living in a country where the language is spoken. On a whim I studied Arabic as a freshman. It was a lot of work, and the only lasting benefits were a weird ability to identify semitic roots and some insights into how people recognize words.</p>
<p>Studio art and creative writing courses are wildcards. Usually you don’t get taught much: you just work (or don’t work) on whatever you want, and then sit around offering “crits” of one another’s creations under the vague supervision of the teacher. But writing and art are both very hard problems that (some) people work honestly at, so they’re worth doing, especially if you can find a good teacher.</p>
<p><strong>Jobs</strong></p>
<p>Of course college students have to think about more than just learning. There are also two practical problems to consider: jobs, and graduate school.</p>
<p>In theory a liberal education is not supposed to supply job training. But everyone knows this is a bit of a fib. Hackers at every college learn practical skills, and not by accident.</p>
<p>What you should learn to get a job depends on the kind you want. If you want to work in a big company, learn how to hack Bulb on Windows. If you want to work at a cool little company or research lab, you’ll do better to learn Ruby on Linux. And if you want to start your own company, which I think will be more and more common, master the most powerful tools you can find, because you’re going to be in a race against your competitors, and they’ll be your horse.</p>
<p>There is not a direct correlation between the skills you should learn in college and those you’ll use in a job. You should aim slightly high in college.</p>
<p>In workouts a football player may bench press 300 pounds, even though he may never have to exert anything like that much force in the course of a game. Likewise, if your professors try to make you learn stuff that’s more advanced than you’ll need in a job, it may not just be because they’re academics, detached from the real world. They may be trying to make you lift weights with your brain.</p>
<p>The programs you write in classes differ in three critical ways from the ones you’ll write in the real world: they’re small; you get to start from scratch; and the problem is usually artificial and predetermined. In the real world, programs are bigger, tend to involve existing code, and often require you to figure out what the problem is before you can solve it.</p>
<p>You don’t have to wait to leave (or even enter) college to learn these skills. If you want to learn how to deal with existing code, for example, you can contribute to open-source projects. The sort of employer you want to work for will be as impressed by that as good grades on class assignments.</p>
<p>In existing open-source projects you don’t get much practice at the third skill, deciding what problems to solve. But there’s nothing to stop you starting new projects of your own. And good employers will be even more impressed with that.</p>
<p>What sort of problem should you try to solve? One way to answer that is to ask what you need as a user. For example, I stumbled on a good algorithm for spam filtering because I wanted to stop getting spam. Now what I wish I had was a mail reader that somehow prevented my inbox from filling up. I tend to use my inbox as a todo list. But that’s like using a screwdriver to open bottles; what one really wants is a bottle opener.</p>
<p><strong>Grad School</strong></p>
<p>What about grad school? Should you go? And how do you get into a good one?</p>
<p>In principle, grad school is professional training in research, and you shouldn’t go unless you want to do research as a career. And yet half the people who get PhDs in CS don’t go into research. I didn’t go to grad school to become a professor. I went because I wanted to learn more.</p>
<p>So if you’re mainly interested in hacking and you go to grad school, you’ll find a lot of other people who are similarly out of their element. And if half the people around you are out of their element in the same way you are, are you really out of your element?</p>
<p>There’s a fundamental problem in “computer science,” and it surfaces in situations like this. No one is sure what “research” is supposed to be. A lot of research is hacking that had to be crammed into the form of an academic paper to yield one more quantum of publication.</p>
<p>So it’s kind of misleading to ask whether you’ll be at home in grad school, because very few people are quite at home in computer science. The whole field is uncomfortable in its own skin. So the fact that you’re mainly interested in hacking shouldn’t deter you from going to grad school. Just be warned you’ll have to do a lot of stuff you don’t like.</p>
<p>Number one will be your dissertation. Almost everyone hates their dissertation by the time they’re done with it. The process inherently tends to produce an unpleasant result, like a cake made out of whole wheat flour and baked for twelve hours. Few dissertations are read with pleasure, especially by their authors.</p>
<p>But thousands before you have suffered through writing a dissertation. And aside from that, grad school is close to paradise. Many people remember it as the happiest time of their lives. And nearly all the rest, including me, remember it as a period that would have been, if they hadn’t had to write a dissertation. </p>
<p>The danger with grad school is that you don’t see the scary part upfront. PhD programs start out as college part 2, with several years of classes. So by the time you face the horror of writing a dissertation, you’re already several years in. If you quit now, you’ll be a grad-school dropout, and you probably won’t like that idea. When Robert got kicked out of grad school for writing the Internet worm of 1988, I envied him enormously for finding a way out without the stigma of failure.</p>
<p>On the whole, grad school is probably better than most alternatives. You meet a lot of smart people, and your glum procrastination will at least be a powerful common bond. And of course you have a PhD at the end. I forgot about that. I suppose that’s worth something.</p>
<p>The greatest advantage of a PhD (besides being the union card of academia, of course) may be that it gives you some baseline confidence. For example, the Honeywell thermostats in my house have the most atrocious UI. My mother, who has the same model, diligently spent a day reading the user’s manual to learn how to operate hers. She assumed the problem was with her. But I can think to myself “If someone with a PhD in computer science can’t understand this thermostat, it <em>must</em> be badly designed.”</p>
<p>If you still want to go to grad school after this equivocal recommendation, I can give you solid advice about how to get in. A lot of my friends are CS professors now, so I have the inside story about admissions. It’s quite different from college. At most colleges, admissions officers decide who gets in. For PhD programs, the professors do. And they try to do it well, because the people they admit are going to be working for them.</p>
<p>Apparently only recommendations really matter at the best schools. Standardized tests count for nothing, and grades for little. The essay is mostly an opportunity to disqualify yourself by saying something stupid. The only thing professors trust is recommendations, preferably from people they know. [6]</p>
<p>So if you want to get into a PhD program, the key is to impress your professors. And from my friends who are professors I know what impresses them: not merely trying to impress them. They’re not impressed by students who get good grades or want to be their research assistants so they can get into grad school. They’re impressed by students who get good grades and want to be their research assistants because they’re genuinely interested in the topic.</p>
<p>So the best thing you can do in college, whether you want to get into grad school or just be good at hacking, is figure out what you truly like. It’s hard to trick professors into letting you into grad school, and impossible to trick problems into letting you solve them. College is where faking stops working. From this point, unless you want to go work for a big company, which is like reverting to high school, the only way forward is through doing what you love.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/09/How-To-Do-LeetCode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yuanchen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yuanchen's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/09/How-To-Do-LeetCode/" class="post-title-link" itemprop="url">How To Do LeetCode</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-01-09 16:18:55 / Modified: 17:20:04" itemprop="dateCreated datePublished" datetime="2020-01-09T16:18:55-05:00">2020-01-09</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-Know-your-motivations"><a href="#1-Know-your-motivations" class="headerlink" title="1. Know your motivations"></a>1. Know your motivations</h2><p>Why do you want to “get good at Leetcode”? Do you want to get your dream job? Win programming contests? Learn more about algorithms? Without a good motivation, you may struggle. If your only motivation is to get your dream job, then you might also struggle to stay motivated, especially with the “risk” of not getting the job. If you don’t enjoy solving the questions, it might not be worth doing the advanced ones. There are plenty of good companies out there where you won’t need to be able to solve medium-level and hard-level Leetcode questions to get into them.</p>
<p>So, think about what motivates you, and keep that motivation in mind!</p>
<h2 id="2-Set-realistic-goals-for-yourself"><a href="#2-Set-realistic-goals-for-yourself" class="headerlink" title="2. Set realistic goals for yourself"></a>2. Set realistic goals for yourself</h2><p>Multiple times, I’ve seen people ask how many questions they should solve in a day. This is the wrong question to ask though. You shouldn’t have a number-of-questions-per-day target. Instead, you should decide how much time <em>you</em> are willing and able to put towards your learning, and then make it your goal to use that time as productively as you can, aiming to improve. You can only do your best, and you should be aiming to do <em>your</em> best, so comparing to other people won’t be helpful here.</p>
<p>Aim to divide your time between learning new skills, mastering old skills and general problem solving (tackling questions without initially knowing what skills you’ll be applying).</p>
<h2 id="3-If-you-don’t-have-a-CS-degree-do-an-online-data-structures-and-algorithms-course"><a href="#3-If-you-don’t-have-a-CS-degree-do-an-online-data-structures-and-algorithms-course" class="headerlink" title="3. If you don’t have a CS degree, do an online data structures and algorithms course"></a>3. If you don’t have a CS degree, do an online data structures and algorithms course</h2><p>If it wasn’t for the first year data structures and algorithms course I did back when I was in university, I don’t think I would have known where to start. Getting started can be daunting, and knowing what exactly to focus on can be even more so. As a rough guide, you’ll need a course that takes you over key ideas such as Arrays, Sorting, Searching, Linked Lists, Trees, Graphs, Stacks, Heaps, Queues, Hashing (maps, sets, and dictionaries), Big-O notation, and complexity analysis (cost). By the end of it, you should know the use cases for each data structure, and be able to justify the reasons in terms of cost.</p>
<p>A good online course will have assignments and quizzes that’ll help you know whether or not you’re on track and picking up the most important ideas. This will then help you as you move towards self-directed learning on more advanced concepts.</p>
<p>There are also many good resources on the more basic programming skills. Find one that suits your style and language of choice. Make sure you can design programs with loops and conditionals (if statements) with ease, as this is central to algorithm design.</p>
<h2 id="4-Find-some-good-resources-for-learning-more-advanced-algorithms"><a href="#4-Find-some-good-resources-for-learning-more-advanced-algorithms" class="headerlink" title="4. Find some good resources for learning more advanced algorithms"></a>4. Find some good resources for learning more advanced algorithms</h2><p>It really does help to have a good resource to look at when needed. I use the <a href="https://en.wikipedia.org/wiki/Introduction_to_Algorithms" target="_blank" rel="noopener">CLRS algorithms book</a>. I’d highly recommend it, either go for the e-book version on Amazon or look for it in the library (if you’re a university student with access to a library) if the cost is a concern. The <a href="https://leetcode.com/explore/" target="_blank" rel="noopener">Leetcode Explore modules</a> are fantastic too. <a href="https://www.geeksforgeeks.org/" target="_blank" rel="noopener">Geeks For Geeks</a> also has some useful content, although the writing quality varies a lot and the lack of proofreading on some of the articles can make it painful to read. If you can ignore that, great, if not, then you might need to find another resource. Wikipedia also has some good articles, although quality and clarity varies a lot.</p>
<h2 id="5-Learn-techniques-not-solutions"><a href="#5-Learn-techniques-not-solutions" class="headerlink" title="5. Learn techniques, not solutions"></a>5. Learn techniques, not solutions</h2><p>I’ve seen a few people on the Leetcode forums and beyond asking how many Leetcode questions they’d need to have done to have a good chance of seeing all the questions they’ll get in their interview, and it amazes me that anybody thinks this is a good idea. Leetcode itself doesn’t help the cause by providing lists of questions sorted by company (for subscribers).</p>
<p>If in an interview you’ve already seen the question, it’d be <strong>dishonest</strong> to pretend you hadn’t. You’d also have to be pretty good at faking the “solving a novel problem” thought process your interviewer is looking for.</p>
<p>Instead, you should be aiming to do enough questions to learn about the common data structures, algorithms, and techniques that you’re likely to need to use. Your goal is to get yourself to a point where if you’re given a problem you’ve never seen before, you can work through it and decide which data structures, algorithms, and techniques you could apply to solve it. It will take a lot of practice to get to this point, and sometimes there’ll be a question where it takes you a few minutes to even know where to start. But the more you learn and practice, the better you will become.</p>
<h2 id="6-Learn-the-fundamental-data-structures-Basic"><a href="#6-Learn-the-fundamental-data-structures-Basic" class="headerlink" title="6. Learn the fundamental data structures (Basic)"></a>6. Learn the fundamental data structures (Basic)</h2><p>These next 3 points are concerned with specific concepts you’ll need to learn. I’ve split them into 3 general categories, based on difficulty and how often they tend to come up. I’d recommend mastering all in one category before moving up to the next. The lists aren’t exhaustive, and the order isn’t absolute, but this is roughly the order I worked on learning and mastering concepts.</p>
<p>If you have a lot of trouble with even the simplest questions in the fundamental data structures section (some are hard, I’m not saying you have to find them <em>all</em> easy!), then you might need to find an introduction to data structures and algorithms course to work through. Most of these topics have a Leetcode <a href="https://leetcode.com/explore/learn/" target="_blank" rel="noopener">Explore</a> module, I highly recommend using them. After that, find more problems by searching the problem list by the relevant tag. Focus mostly on easy-level questions for now.</p>
<ul>
<li><strong>Arrays and Strings</strong>: Leetcode’s module for <a href="https://leetcode.com/explore/learn/card/array-and-string/" target="_blank" rel="noopener">Arrays and Strings</a> is where you should start. This is a fundamental topic, so practice lots until you’re really confident.</li>
<li><strong>Linked Lists</strong>: Again, check out the module for <a href="https://leetcode.com/explore/learn/card/linked-list/" target="_blank" rel="noopener">Linked Lists</a>. Don’t worry about the solution guides that are subscribers only—you don’t need them. Check out the discuss forum instead, click on posts until you find a good one. Linked lists can be confusing at first, but they’re easy as once you get your head around the idea of the next pointers.</li>
<li><strong>Trees</strong>: Focus on the <a href="https://leetcode.com/explore/learn/card/n-ary-tree/" target="_blank" rel="noopener">N-ary trees</a> module and then the <a href="https://leetcode.com/explore/learn/card/data-structure-tree/" target="_blank" rel="noopener">Binary Trees</a> module. Don’t worry about Binary Search Trees yet, you can look at those a bit later. For some reason, the information documents about traversals are subscribers only. Don’t worry about this though, there are plenty of great free resources around, such as this <a href="https://www.tutorialspoint.com/data_structures_algorithms/tree_traversal" target="_blank" rel="noopener">overview</a> and these widgets that get you to <a href="https://opendsa-server.cs.vt.edu/ODSA/Books/Everything/html/BinaryTreeTraversal.html" target="_blank" rel="noopener">click on nodes in the correct order</a>. You’ll find lots more by googling.</li>
<li><strong>Hashing</strong>: This is dictionaries/maps, and sets, and is covered under the <a href="https://leetcode.com/explore/learn/card/hash-table/" target="_blank" rel="noopener">Hash Tables</a> module. This is one of the most useful topics you’ll learn, so be sure to get lots of practice in, as most challenging questions use these data structures as part of the solution. Don’t worry about the few bits that are subscribers only.</li>
<li><strong>Stacks, queues, and heaps (priority queues)</strong>: These are also fairly versatile, coming up in a lot of problems. <a href="https://leetcode.com/explore/learn/card/queue-stack/" target="_blank" rel="noopener">Stacks and Queues</a> have a module, although heaps/ priority queues don’t yet. Have a look on <a href="https://www.geeksforgeeks.org/binary-heap/" target="_blank" rel="noopener">Geeks For Geeks for some good articles on heaps</a>, and then find some questions on <a href="https://leetcode.com/tag/heap/" target="_blank" rel="noopener">Leetcode that are solved with a heap</a>. Check if your programming language of choice has a built-in heap type, it will be called either a heap or a priority queue.</li>
<li><strong>Two pointer technique</strong>: If you didn’t do this with arrays, you should <a href="https://leetcode.com/explore/learn/card/array-and-string/205/array-two-pointer-technique/" target="_blank" rel="noopener">do it now</a>. It comes up <a href="https://leetcode.com/tag/two-pointers/" target="_blank" rel="noopener">a lot</a>.</li>
</ul>
<p>Make sure you know complexity costs of these basic data structures, for example, that finding whether or not something is in a linked list is <code>O(n)</code>, but finding whether or not its in a dictionary is <code>O(1)</code>. You should understand the costs inside and out, knowing exactly why they are what they are. Simply memorizing the costs won’t help you much.</p>
<h2 id="7-Learn-the-more-advanced-data-structures-and-some-famous-algorithms-Intermediate"><a href="#7-Learn-the-more-advanced-data-structures-and-some-famous-algorithms-Intermediate" class="headerlink" title="7. Learn the more advanced data structures and some famous algorithms (Intermediate)"></a>7. Learn the more advanced data structures and some famous algorithms (Intermediate)</h2><p>There are some algorithms and a few more data structures that will come up over and over again. It is well worth putting time into studying each of these, much like with the fundamental data structures. Some of them will be in the easy category and some in medium. The hard ones tend to combine multiple concepts.</p>
<ul>
<li><strong>Recursion</strong>: This alternative to iteration is helpful for solving some problems, and once you’re used to it, is often quicker to write than iteration. Leetcode has a module for <a href="https://leetcode.com/explore/learn/card/recursion-i/" target="_blank" rel="noopener">recursion</a>. Just do this module, don’t worry too much about recursion 2 yet, there are more important concepts for you to learn first.</li>
<li><strong>Graphs and graph algorithms</strong>: Graph algorithms come up everywhere. I’ve heard that in the interview processes of top companies, getting at least one graph question is inevitable. The main things they are looking for is that you know the <a href="https://www.geeksforgeeks.org/graph-and-its-representations/" target="_blank" rel="noopener">3 main ways of representing a graph: linked, adjacency list, and adjacency matrix</a>, choosing the best one for a given situation, and then running algorithms over it such as breadth-first search, depth-first search, and topological sort. Often graph questions aren’t explicitly listed as such—you’ll be given some data as an input that you need to convert into a valid graph format, and then run the appropriate algorithm over it. You must get really good at recognizing graph questions instantly. Be aware too that a 2D array can represent a special kind of graph where each cell represents a node linked to its neighboring cells. Often these are breadth-first search questions. You should have already seen some of this in stacks and queues, and trees. But be sure you’re super confident with graphs. You should be able to BFS and DFS both iteratively and recursively, and with your eyes closed (okay, maybe not that extreme, but you should be really confident with them!).</li>
<li><strong>Union find</strong>: This algorithm can initially seem scary, but it’s not. It’s useful for finding the connected components of graphs and solving a number of other problems. Have a look on <a href="https://www.geeksforgeeks.org/union-find/" target="_blank" rel="noopener">Geeks for Geeks to get started</a> or the CLRS textbook if you own a copy. There is no Leetcode module on it yet, but there are <a href="https://leetcode.com/tag/union-find/" target="_blank" rel="noopener">lots of relevant questions</a>. Learn the simple optimizations, in particular path compression, as while they sound advanced, they’re actually really simple and lead to huge efficiency gains.</li>
<li><strong>Binary search</strong>: People tend to get quite bothered by this algorithm and its edge cases and resort to guessing and checking loop and conditional conditions. I’d recommend doing the <a href="https://leetcode.com/explore/learn/card/binary-search/" target="_blank" rel="noopener">binary search</a> module, but also trying to build intuition around the algorithm. Be cautious on relying too heavily on the templates given in the module, they are good to get started, but trying to memorize the templates will only lead to edge-case bugs that you will struggle to debug. It helps to know whether your “middle index” formula is getting the lower-middle or upper-middle (when there’s an even sized list) and then whether or not your low and high moving will definitely converge instead of infinite looping. Sometimes making it converge is as simple as using the upper-middle instead of lower-middle, but it depends on how you’re changing low and high. Overall, you <em>must</em> build an intuition rather than trying to memorize the algorithm. I might write a blog on this at some point.</li>
<li><strong>Binary search trees</strong>: These, along with generic binary trees (i.e. not sorted tree), seem to come up almost every week in the weekly competition. Being able to quickly write a recursive function to traverse the tree and get the information you need is possibly the single biggest thing you can do to improve your competition performance. They tend to be medium-level questions, but if you know what you’re doing, they are easy to do in under 5 minutes! Start with the <a href="https://leetcode.com/explore/learn/card/introduction-to-data-structure-binary-search-tree/" target="_blank" rel="noopener">Binary Search Tree</a> module, and then look for <a href="https://leetcode.com/tag/tree/" target="_blank" rel="noopener">more questions on trees</a>. Make sure to do lots of medium-level questions.</li>
<li><strong>Tries and advanced string algorithms</strong>: Leetcode has a module on <a href="https://leetcode.com/explore/learn/card/trie/" target="_blank" rel="noopener">Tries</a> for you to work through. As for other string algorithms, Google them or look in the CLRS algorithms book.</li>
<li><strong>Interval trees</strong>: These are probably the most advanced data structure you’ll see on a semi-regular basis. I’d recommend trying to code one. Unfortunately, Leetcode doesn’t have an Explore module on them.</li>
</ul>
<h2 id="8-Learn-the-versatile-algorithmic-design-techniques-Advanced"><a href="#8-Learn-the-versatile-algorithmic-design-techniques-Advanced" class="headerlink" title="8. Learn the versatile algorithmic design techniques (Advanced)"></a>8. Learn the versatile algorithmic design techniques (Advanced)</h2><p>This is the stage I’m currently at. It was working on these techniques that has really driven my improved performance in the competitions. They are not easy, and you’ll need to work and work and work at them. You’ll need to start by practicing questions where you already know which technique you’ll be using, and then on ones where you don’t. The competitions are useful for that, as you don’t get to see the tags until the end.</p>
<ul>
<li><strong>Bit manipulation</strong>: This isn’t that difficult once you get your head around it, and it’s also pretty fun. Leetcode <a href="https://leetcode.com/problemset/all/?topicSlugs=bit-manipulation" target="_blank" rel="noopener">has many questions on bit manipulation</a>, although no module for it at the time of writing. To get started, Google a guide for your programming language of choice, then have a go at some of the questions. Note that while it can be used standalone for most of the easy and medium level questions, it tends to be an optimization technique combined with other concepts in hard-level questions.</li>
<li><strong>Backtracking</strong>: This is a strategy that many advanced recursive algorithms use, especially when coming up with solutions for NP-Complete problems. Before I learned how to do backtracking correctly, my exponential time algorithms would also use exponential space, with lists and sets getting copied everywhere. I see many hard-level questions that are straightforward with backtracking. Leetcode has a section on it, tucked inside the <a href="https://leetcode.com/explore/learn/card/recursion-ii/472/backtracking/" target="_blank" rel="noopener">Recursion 2</a> module.</li>
<li><strong>Divide and conquer</strong>: This is another strategy that many advanced recursive algorithms use, in particular, those that run in <code>O(n log(n))</code> time (quasilinear). Mergesort and Quicksort are the most well-known examples of divide and conquer algorithms. Leetcode has a section on them, also tucked inside the <a href="https://leetcode.com/explore/learn/card/recursion-ii/472/backtracking/" target="_blank" rel="noopener">Recursion 2</a> module.</li>
<li><strong>Parsing</strong>: Parsing questions are very difficult if you don’t know how to approach them, but very fun if you do. One technique is recursive descent, but there are also others such as using an explicit stack. Some good questions are <a href="https://leetcode.com/problems/number-of-atoms/" target="_blank" rel="noopener">Number of Atoms</a>, <a href="https://leetcode.com/problems/parse-lisp-expression/" target="_blank" rel="noopener">Parse Lisp Expression</a>, <a href="https://leetcode.com/problems/parsing-a-boolean-expression/" target="_blank" rel="noopener">Parsing a Boolean Expression</a>, and <a href="https://leetcode.com/problems/evaluate-reverse-polish-notation/" target="_blank" rel="noopener">Evaluate Reverse Polish Notation</a>.</li>
<li><strong>Dynamic programming</strong>: This may be the hardest technique, and unfortunately I’m still looking for a good resource on it. The CLRS algorithms book has some good content on it though, and Leetcode <a href="https://leetcode.com/tag/dynamic-programming/" target="_blank" rel="noopener">has many awesome dynamic programming questions</a>. Come on Leetcode, add an Explore module for this topic!</li>
<li><strong>Memoization</strong>: This is an alternative to dynamic programming that instead uses recursion. It tends to be easier to reason about (for most people), so it might save you for the more challenging dynamic programming problems. In saying that, your goal should ultimately be to do as many questions as possible using dynamic programming instead of memoization. Leetcode has on it, tucked inside the <a href="https://leetcode.com/explore/learn/card/recursion-i/255/recursion-memoization/" target="_blank" rel="noopener">Recusion 1</a> module.</li>
</ul>
<p>Keep in mind too that there’s often more than one approach for a question, and the tags aren’t always exhaustive. For example, the <a href="https://leetcode.com/problems/smallest-sufficient-team/" target="_blank" rel="noopener">Smallest Sufficient Team problem</a> is tagged as two of these techniques, but also has really nice solutions with one of the others. I’m being intentionally vague as I don’t want to give spoilers.</p>
<h2 id="9-Be-aware-of-the-intractable-problems-particularly-the-NP-Complete-ones"><a href="#9-Be-aware-of-the-intractable-problems-particularly-the-NP-Complete-ones" class="headerlink" title="9. Be aware of the intractable problems, particularly the NP-Complete ones."></a>9. Be aware of the intractable problems, particularly the NP-Complete ones.</h2><p>A computer scientist’s idea of a practical joke is to give the unsuspecting victim an NP-Complete problem to solve and watch them go around in circles, possibly discovering what they think is a solution and then discovering that it fails in some cases. Okay, maybe we’re not that mean. But I have definitely heard of people in interviews trying to come up with an efficient solution for a problem which is NP-Complete, and if they DID find a good solution, they wouldn’t be needing the job they’re interviewing for (as they’d be rich for it!). I have even heard of companies trying to solve them, not realizing. Or apps that promise to give you the shortest path between multiple stops.</p>
<p>So, know what they are. <a href="https://en.wikipedia.org/wiki/NP-completeness#NP-complete_problems" target="_blank" rel="noopener">Wikipedia has some good lists of them</a>. Know what the best way to solve them is⁠—sometimes it’s a brute force, but with clever optimizations. Other problems have dynamic programming solutions which are what we call pseudo-polynomial. The knapsack problem is a good example of this. Sometimes an assumption you’re allowed to make (specified in the problem limits) will mean there’s a polynomial-time solution (or pseudo-polynomial).</p>
<h2 id="10-Brush-up-on-those-math-skills"><a href="#10-Brush-up-on-those-math-skills" class="headerlink" title="10. Brush up on those math skills"></a>10. Brush up on those math skills</h2><p>If you feel a bit rusty in math, or you didn’t enjoy it in school, it might be time to get out the grid paper and pencil. I did this last year, and <a href="https://heidi-newton.com/blog/rediscovering-a-passion-for-math" target="_blank" rel="noopener">wrote a blog post on it</a>. Overall, it was a lot of fun, and it helped to improve my programming and algorithm skills too. I could ramble about this topic for hours, but we don’t have time for that, so here are some free resources I used and recommend:</p>
<ul>
<li><a href="https://www.khanacademy.org/" target="_blank" rel="noopener">Khan Academy</a>: I can’t recommend this strongly enough. It covers all of primary (elementary) and high school math in great depth, and it’s actually really fun. It’s not just for school students, it’s equally awesome for adults. Sal has a talent for explaining things and the quizzes and content are broken up into manageable chunks. If you aren’t sure where your weaknesses are, have a go at the initial quizzes. They’ll tell you where you have work to do. Don’t be ashamed if you find there are a few primary school-level concepts that you need to work on. It happened to me, and I was amazed at how much addressing those weaknesses helped me with the more advanced stuff. If you aren’t already confident with it, I especially recommend the geometry stuff. The proofs and problem-solving there is a similar kind of thinking to the thinking you’re trying to develop on Leetcode.</li>
<li><a href="https://www.coursera.org/learn/mathematical-thinking" target="_blank" rel="noopener">Introduction to Mathematical Thinking</a>: If you feel you possibly have some amount of math-PTSD from school, Keith Devlin is the doctor for you. Keith’s mission is to enlighten the general public on what it actually is mathematicians do (i.e. not arithmetic and solving pages and pages of equations for y’s x). Aside from that, the course goes over logic and proofs and aims to get you to see the difference between school math and being a mathematician. It’s helpful, especially if you aren’t keen on tackling the MIT OCW stuff yet.</li>
<li><a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-042j-mathematics-for-computer-science-spring-2015/" target="_blank" rel="noopener">MIT OCW Mathematics for Computer science</a>: This is more advanced, but well worth tackling if it aligns with your goals, i.e. being a top competitive programmer or getting into a top tier tech company. If you did a degree in computer science, you probably already did some discrete math. Unless you did discrete math beyond an introduction at a top school though, then this course will be helpful as there’ll almost certainly be stuff you didn’t know. At the very least, it’s great revision. Note that you’ll need to put hours into doing ALL of the “in class” questions to get the maximum benefit. We all learn best from doing, and the questions are of high quality.</li>
</ul>
<h2 id="11-Be-confident-knowing-the-asymptotic-complexity-of-an-algorithm-and-don’t-write-code-until-you-know-your-algorithm-will-be-good-enough"><a href="#11-Be-confident-knowing-the-asymptotic-complexity-of-an-algorithm-and-don’t-write-code-until-you-know-your-algorithm-will-be-good-enough" class="headerlink" title="11. Be confident knowing the asymptotic complexity of an algorithm, and don’t write code until you know your algorithm will be good enough."></a>11. Be confident knowing the asymptotic complexity of an algorithm, and don’t write code until you know your algorithm will be good enough.</h2><p>When given a question in an interview or a contest, don’t dive into writing code. The first thing you’ll need to do is think and brainstorm possible ways of solving it. For each one, you need to know how to determine the asymptotic complexity, paying particular attention to the worst cases. You’ll then need to look at the problem limits and make a judgement call as to whether or not your algorithm is likely to be fast enough. Over time, you’ll build a sense for how long things take. For me, I start to worry when plugging the maximum value into the big-O formula evaluates to over a million or so. It’s a very crude measurement, but it seems to serve me well.</p>
<p>Sometimes you’ll need to come up with a better algorithm from scratch. Sometimes, you can optimize a bad algorithm so that it’s a lot better. But you’ll need to be fairly confident before you start coding, otherwise you’ll risk wasting time writing and debugging code, only to get the dreaded Time Limit Exceeded error that can only be fixed with a full re-design and re-write.</p>
<h2 id="12-Read-the-problem-limits-well"><a href="#12-Read-the-problem-limits-well" class="headerlink" title="12. Read the problem limits well."></a>12. Read the problem limits well.</h2><p>Often, you’ll be told what the maximum input sizes to expect are. These will give you a lot of clues about the kind of algorithm you might be writing. As a very rough rule of thumb:</p>
<ul>
<li>If the limits are tiny, i.e. all under 50 or so, then your algorithm will probably be non-polynomial (and this is a “smell” for intractable problems).</li>
<li>If it’s under about 1000, then you might be looking at quadratic or around that.</li>
<li>If it’s over that, but under 1,000,000, then it’s probably linear or quasilinear.</li>
<li>Over that, and it’s quite possibly logarithmic. If it’s ridiculously high (e.g. billions or trillions) like sometimes seen in the Google Code Jam, that can be a sign of being able to shrink it with modular arithmetic or even a constant time algorithm.</li>
</ul>
<p>These aren’t certain rules, but they definitely give a good indication. On the other hand, if your quadratic algorithm needs to run on sizes of 2000 or more, it’s probably not going to pass. Usually, but not always, quadratic algorithms can be replaced with quasilinear ones taking a divide and conquer approach, or using binary search somehow.</p>
<h2 id="13-Choose-the-best-variable-to-scale-up-on"><a href="#13-Choose-the-best-variable-to-scale-up-on" class="headerlink" title="13. Choose the best variable to scale up on."></a>13. Choose the best variable to scale up on.</h2><p>Sometimes, what seems to be the main variable (e.g. number of items) is quite high, but another variable is surprisingly lower. Going back to one of my favourite questions – <a href="https://leetcode.com/problems/smallest-sufficient-team/" target="_blank" rel="noopener">Smallest Sufficient Team</a> – we are told this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1 &lt;&#x3D; req_skills.length &lt;&#x3D; 16</span><br><span class="line">1 &lt;&#x3D; people.length &lt;&#x3D; 60</span><br><span class="line">1 &lt;&#x3D; people[i].length, req_skills[i].length, people[i][j].length &lt;&#x3D; 16</span><br><span class="line">Elements of req_skills and people[i] are (respectively) distinct.</span><br><span class="line">req_skills[i][j], people[i][j][k] are lowercase English letters.</span><br><span class="line">It is guaranteed a sufficient team exists.</span><br></pre></td></tr></table></figure>

<p>The interesting detail here is that the maximum number of required skills is a lot lower than the maximum number of people. This is a <strong>big</strong> clue. It suggests that the cost will primarily scale with the number of skills required, not with the number of people. Instead of an approach that considers including or not including each person, we should instead be looking at a solution where the main looping is over the skill list.</p>
<p>This is common in Google Code Jam questions. It’s worth having a really good look and think about the limits, especially if one seems unusually low/ is a surprising constraint. It can often mean there’s a good solution that wouldn’t have worked as well if it was bigger.</p>
<h2 id="14-Share-your-solutions-and-teach-others"><a href="#14-Share-your-solutions-and-teach-others" class="headerlink" title="14. Share your solutions and teach others"></a>14. Share your solutions and teach others</h2><p>It’s widely known that to master something, you have to teach it. Writing up high-quality solutions and explanations on the discussion forums is a great way of doing this. It will also help you develop other software engineering skills, such as writing and explaining. Make sure you post with the goal of helping others, and <em>not</em> showing off. Nobody likes a code dump with no comments or explanations.</p>
<p>Take pride in the code you share. Very few people like reading code where all the variable names appear to have been taken from the lyrics of the famous <a href="https://www.youtube.com/watch?v=75p-N9YKqNo" target="_blank" rel="noopener">alphabet song</a>. When writing your post and the code to put in it, pretend potential employers might be reading it. If you’re wanting to get into a top tech company, then write the kind of code you’d be expected to write there. For example, use descriptive variable names. During my Google internship, I noticed this in the Google codebase and my partner James also tells me that Canva’s codebase is the same.</p>
<p><strong>ABOVE ALL OTHER ADVICE</strong>, <strong><em>put 3 backticks before and 3 backticks after your code.</em></strong> This will make it format nicely. It amazes me how many people don’t know to do this/ don’t bother to find out how when their code looks hideous and unreadable from the lack of it.</p>
<h2 id="15-Practice-general-problem-solving"><a href="#15-Practice-general-problem-solving" class="headerlink" title="15. Practice general problem solving"></a>15. Practice <em>general</em> problem solving</h2><p>When learning algorithms, data structures, and techniques, I recommend you use the tags to find relevant problems. After all, your goal is to master a specific skill.</p>
<p>But after that, you need to practice “problem solving”. This is where you have a problem to solve, and you do not know which of your skills you’ll be applying to it. To do this, the weekly contests and mock interview feature are amazing.</p>
<p>Remember that sometimes a question will require a technique you’ve never seen before, or will require a major adaptation to one. You’ll need to learn to be creative and think outside the box if this doesn’t come naturally to you, memorizing solutions will not help you. A great example of this is questions such as <a href="https://leetcode.com/problems/minimize-max-distance-to-gas-station/" target="_blank" rel="noopener">Minimize Max Distance to Gas Station</a>. There is a quasilinear solution using binary search. It’s not at all what you might initially think.</p>
<h2 id="16-Do-the-weekly-contests"><a href="#16-Do-the-weekly-contests" class="headerlink" title="16. Do the weekly contests"></a>16. Do the weekly contests</h2><p>These are great fun, and a great chance to practice your general problem solving, although they can be buggy as the questions are new to the site. Cheating is also an issue, particularly in the form of people hardcoding the answers to the largest test cases. This has reduced a lot though since Leetcode stopped displaying the answer to test cases where the result was Time Limit Exceeded. There are also issues with some programming languages being faster than others. Sometimes, a poor solution will slip through with C++ and Java, but not Python, for example.</p>
<p>There is no rule against using previous code, although at the end of the day, one needs to decide what their goal is. Using previous code is not helping you learn. Most of the winners seem to be using previous code, their goal is generally to accumulate Leetcoins so that they can get their yearly subscription and a T-shirt (or so it seems)</p>
<p>It also takes a lot of practice. Over time, you’ll get better at it. I wasn’t getting in the top 200 at first, it took practice.</p>
<h2 id="17-Use-the-mock-interview-feature"><a href="#17-Use-the-mock-interview-feature" class="headerlink" title="17. Use the mock interview feature"></a>17. Use the mock interview feature</h2><p>I have a Leetcode subscription, so in theory, I could do the company-specific interviews. I actually never do though, I much prefer the random sets. They seem to be taken from the company-specific ones, with the difference being you don’t know which company it’s from. So don’t worry about not having a subscription, you’ll still find this feature useful.</p>
<p>As a general rule, the 3 levels (screening, phone interview, and onsite) are more difficult than the last. So, start with the screening ones and then move up from there. Unfortunately, Leetcode will sometimes give you a mock interview you’ve seen previously, there’s not much you can do about this. Once it seems to be happening a lot though, that probably means you’ve done most of their mock interviews of that type. Because there is a finite number of them, it’s also best to not use them until you’ve done some practice (i.e. mastered at least the basic and intermediate skills I’ve listed above).</p>
<p>Fun question: If there are 25 mock interview problem sets, and each has the same probability of appearing, around how many mock interviews will you need to do to see them all? How many repetitions can you expect to see?</p>
<p>In all seriousness, the mock interview feature is great for keeping you focused (it’s timed!) and for forcing you to solve some problems without seeing their tags. Remember what I said about practicing your general problem solving?</p>
<h2 id="18-Don’t-spend-all-your-time-doing-easy-level-questions"><a href="#18-Don’t-spend-all-your-time-doing-easy-level-questions" class="headerlink" title="18. Don’t spend all your time doing easy-level questions"></a>18. Don’t spend all your time doing easy-level questions</h2><p>I used to fall into this trap, I would do easy level questions, trying to do them as fast as I could. Then I realized that was a big waste of time, as it was the medium and hard level questions that I was struggling on in the weekly competitions, not the easy ones. Getting the easy ones solved quickly doesn’t mean much compared to getting the points of the hard ones.</p>
<p>You need to do questions that are challenging, even if they take you over an hour. This is how you’ll learn and improve. As you get better at them, your speed will go up. Focus first on accuracy and skill, and then secondly on speed. Remember that if you can at least get to the point of answering all 4 competition questions in the 90 minutes available, you’re already doing better than most people.</p>
<h2 id="19-Try-to-avoid-writing-bugs-in-the-first-place"><a href="#19-Try-to-avoid-writing-bugs-in-the-first-place" class="headerlink" title="19. Try to avoid writing bugs in the first place"></a>19. Try to avoid writing bugs in the first place</h2><p>We all know debugging sucks when you’re timed and seeing those precious minutes tick by. The best solution is to not write bugs in the first place. By programming mindfully, with your full attention, you’ll be able to consciously ensure each line is doing what you want it to.</p>
<p>For particularly tricky <em>lines</em> of code, such as binary search boundaries, make a quick example if you have to, and make sure your code does what it’s supposed to on it. Do this as you’re writing the algorithm, not at the end. If you don’t remember the details of a particular library function perfectly, quickly look it up, don’t guess. In an interview, tell your interviewer you can’t remember. Most people forget these things, and there’s a chance they won’t remember either. They can tell you what assumption to make. Also, in competitions, it can help to have a shell up with your chosen language if it’s interpreted. Sometimes I forget how particular things in Python work (especially when it involves complex splicing) so being able to quickly type in an example really helps!</p>
<p>Something else that helps me is writing code on paper first. I find there are less bugs, as I can’t handwrite as fast as I can type.</p>
<h2 id="20-You-must-have-fun"><a href="#20-You-must-have-fun" class="headerlink" title="20. You must have fun!"></a>20. You must have fun!</h2><p>You’ll burn out in no time if you don’t enjoy it. Don’t go about your studying in a way that makes it feel like a torturous chore. Do what you need to enjoy it.</p>
<p>And if you still just can’t enjoy it, then perhaps it isn’t for you, which is fine. We all have things we do and don’t enjoy.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/08/Java%E5%AD%A6%E4%B9%A0%E5%BB%BA%E8%AE%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yuanchen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yuanchen's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/08/Java%E5%AD%A6%E4%B9%A0%E5%BB%BA%E8%AE%AE/" class="post-title-link" itemprop="url">Java学习建议</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-01-08 22:25:20" itemprop="dateCreated datePublished" datetime="2020-01-08T22:25:20-05:00">2020-01-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-01-09 00:15:15" itemprop="dateModified" datetime="2020-01-09T00:15:15-05:00">2020-01-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一：浅谈java及应用"><a href="#一：浅谈java及应用" class="headerlink" title="一：浅谈java及应用"></a>一：浅谈java及应用</h1><p>java是一种面向对象语言，真正的面向对象，任何函数和变量都以类(class)封装起来</p>
<p>在说java能做什么之前，先说java作为一个真正面向对象语言的优点</p>
<p>首先第一个，既然是真正的面向对象，那就要做到彻底的封装</p>
<p>这是java和c++最大的不同，java所有的源码以及编译后的文件都以类的形式存在</p>
<p>java没有所谓的类外部定义，所有的函数（方法）以及变量（属性）都必须在类内部定义</p>
<p>这样就不会出现一个类被切割成这里一块那里一块的情况，c++就可以，不是么？</p>
<p>这样做使得整个程序的结构异常清晰，明了</p>
<p>其次第二个，最让人欢呼雀跃的是完全屏蔽了指针，同时引入了垃圾回收机制</p>
<p>任何一个写过c/c++代码的人，都会对内存管理深恶痛绝</p>
<p>因为这使得我们不能把主要精力放在我们关心的事情上</p>
<p>而需要考虑计算机内部的一些事情，作为一个软件工程师</p>
<p>我想没有一个人愿意把大量的时间花在内存管理上，毕竟我们不是电子工程师</p>
<p>此时java的优势体现出来了，它完全屏蔽了内存管理</p>
<p>也就是说，如果你用java写程序，写出来的任何一个程序内存上的开销，都不受你控制</p>
<p>乍一看，似乎你受到了束缚，但实际上不是这样</p>
<p>因为虽然你的程序无法对内存进行管理，降低了一定的速度</p>
<p>但你的程序会非常非常的安全，因为你无法调用一个空指针</p>
<p>而不像以前写c的时候那样，成天因为空指针而担惊受怕</p>
<p>当然，如果你深入了解这一行，就会发现java其实也无法保证程序不去调用空的指针</p>
<p>但是它会在最大程度上避免空指针的调用</p>
<p>这已经很好了，安全，这是java的最突出的优点</p>
<p>第三个，虚拟机跨平台，这是java最大的特点，跨平台</p>
<p>可能所有人都知道windows，但是不是所有人都知道unix</p>
<p>和java一样，很多人都不知道unix这种操作系统干什么用</p>
<p>我不想多说unix的应用，这不是主要，但是我要说，大部分小型机</p>
<p>工作站，都跑在unix一族的操作系统上，比如linux/solaris</p>
<p>unix比起windows有一个最显著的特点，稳定，这就好比思科和华为</p>
<p>思科的机器慢但稳定，华为的机器快但不稳定，作为服务器这一端来说</p>
<p>Unix 在服务器端还是非常有市场的</p>
<p>而且很重要的windows不安全，在ms的宣传中我想所有人都很少看到安全二字</p>
<p>因为windows操作系统针对的是pc用户，pc死机就死机咯，大不了重启</p>
<p>瘟95最经常冒出来的就是蓝屏，在服务器这一端上因为微软没有自己的芯片</p>
<p>所以要做系统有些力不从心啊。扯远了，那么java可以做到在windows上编译</p>
<p>然后在unix上运行，这是c/c++做不到的</p>
<p>那么说到这里，java能做什么逐渐清晰起来</p>
<p>刚才说到了，java程序有一个的特点是安全</p>
<p>这个安全是针对你的系统来说得，系统在跑了java程序之后会特别地稳定</p>
<p>而且还能跨平台，那么很明显，java主要应用于除了windows操作系统以外所有的平台</p>
<p>比如手机，服务器</p>
<p>想想看，如果你写的程序要跑在手机上，而手机有多少款用的是windows?</p>
<p>就算有，那如果你用c/c++，是不是要针对每一款手机写一套程序呢？</p>
<p>累死，那跨平台的java就不用，做到编译一次，随时运行</p>
<p>同样，在服务器这一端，如果我想给一个网络门户站点，比如sina</p>
<p>写一个应用程序，pc的性能肯定无法满足sina这样大站点并发数量的要求</p>
<p>那么它就需要买服务器，那么服务器微软没有市场，而且windows很不安全</p>
<p>那么十之八九会买一个sun/ibm的机器，或者hp，但不管是谁的机器</p>
<p>它装的操作系统也不会是windows，因为windows太不安全了，而且多核的支持太差了</p>
<p>这个有空再说，那么如果你要写一个程序在这样的机器上跑</p>
<p>难道我们就在这个机器上做开发么？当然不可能，一般程序员开发用的都是pc，windows</p>
<p>那么该怎么办？写一个程序，然后再拿到服务器上去编译，去调试？</p>
<p>肯定不可能，所以我们就希望找到一个语言，编译完生成程序之后</p>
<p>在pc上调试，然后直接移植到服务器上去，那么此时，我们就会毫不犹豫地选择java</p>
<p>因为在跨平台以及安全性来说，java永远是第一选择</p>
<p>ok，下面说java的缺点</p>
<p>一慢，这其实是一种误区，这就好比goto语句一样</p>
<p>java也抛弃了指针，虽然看上去似乎变慢了，但是在这个两三年硬件性能就能翻番的年代</p>
<p>速度已经不是我们关心的问题了，而且对于企业级的应用来说</p>
<p>没有什么比安全稳定更重要的，换句话说，我们可以忍受慢，但是不能忍受死机和蓝屏</p>
<p>而且越大型的应用，这种慢的劣势体现得越模糊</p>
<p>因为当系统项目越做越大，任何一个环节做不好都可能影响全局的情况下</p>
<p>安全尤其重要，而且就像goto语句一样</p>
<p>这种过分追求速度的主张会给系统开发和纠错以及维护带来无可挽回甚至不可避免的损失</p>
<p>把内存交给计算机去管理吧，这种代价值得</p>
<p>我们做的不是pc游戏，没必要把内存的那一点点消耗当亲爹</p>
<p>二难看，又是一个误区，很多人甚至拿出java swing控件画出的界面来说</p>
<p>呵呵，其实java不是不能画得好看，IDEA就是java写的IDE，挺漂亮的</p>
<p>但为什么难看呢，是因为swing控件它本身就是unix时代的产物，swing控件贴近unix界面</p>
<p>老外看unix界面其实挺顺眼的，他们就是吃unix饭长大的</p>
<p>而unix又是吃百家饭的，不像ms那么唯利是图，所以不怎么对中国人友好</p>
<p>加上我国又没有公司在做操作系统，所以看上去是不怎么顺眼</p>
<p>其实玩过unix的人都知道，unix对中文的支持一直不怎么好</p>
<p>三我还没想到，其他人补充</p>
<h1 id="二：从JDK说起"><a href="#二：从JDK说起" class="headerlink" title="二：从JDK说起"></a>二：从JDK说起</h1><p>在知道了java有什么优点，能做什么之后</p>
<p>就该说一下java该如何去学了</p>
<p>在说java如何去学之前，有必要把java的几个大方向做一个简单说明</p>
<p>早在五年前，嗯，应该说是六年前，也就是99年的时候</p>
<p>sun公司做出了一个决定，将java应用平台做一个划分</p>
<p>毕竟在不同领域，语言应用特性是有区别的</p>
<p>针对不同领域内的应用,sun公司可以发布相关高端标准来统一规范代码</p>
<p>这三大块就是J2SE,J2EE以及J2ME</p>
<p>这个举措今天看来无疑是非常了不起的</p>
<p>正是由于这次革命性的发展，使java从一种小打小闹游戏性的语言</p>
<p>发展成为今天企业级应用的基础</p>
<p>这里要特别说明一下J2SE J2EE J2ME中2的意思</p>
<p>其实2就是英文单词to的谐音，就是to的意思</p>
<p>而不是second edition，当然java 2本身版本号就是1.2，也有点2nd edition的味道</p>
<p>说点题外的，sun公司发布的java版本很有意思</p>
<p>虽然总是写是1.X但其实外界对这种版的说法也就是X.0</p>
<p>比如java 2,其实就是java 1.2</p>
<p>1.3其实就是3.0，1.4就是4.0，现在所说的5.0 其实就是1.5</p>
<p>只是以前我们更习惯叫1.X而已</p>
<p>可能到了5.0以后，就全改叫X.0而不是1.X了</p>
<p>所以以后听到别人说java 5.0，千万别惊讶，其实就是1.5</p>
<p>在这三个J2*E中J2SE是基础，就是java 2的标准版(java 2 standard edition)</p>
<p>也就是最基础的java语言部分，无论学什么java技术，J2SE都是必须掌握的</p>
<p>要使用J2SE就必须安装JDK（java development kit）</p>
<p>JDK在sun公司的主页上可以免费下载，下载后需要安装，具体安装流程看教材</p>
<p>JDK包含有五个部分：核心API，集成API，用户界面API，发布技术还有java虚拟机（JVM）</p>
<p>先说运行环境，运行环境最主要要说的就是java虚拟机（JVM）</p>
<p>前面我们说过java是跨平台的语言，那么如何做到跨平台呢？毕竟每种操作系统都是不同的</p>
<p>java的设计者们提出了一个虚拟机的概念</p>
<p>在操作系统之上建立一个统一的平台，这个平台必须实现某些功能以支持程序的运行</p>
<p>如下图：</p>
<hr>
<p>|             program               |</p>
<hr>
<p>|                JVM                |</p>
<hr>
<p>| UNIX | Windows | Linux | Solaris |..</p>
<hr>
<p>程序员所写的每一个程序都先运行在虚拟机上</p>
<p>所有操作都必须经过虚拟机才能和操作系统交互</p>
<p>这样做不仅统一了所有操作系统，同时也保证了操作系统的安全</p>
<p>要死机的话，死的是虚拟机（JVM）而操作系统并不会受此影响</p>
<p>而我们所说的java运行环境指的主要是JVM，其他的不说了，省略</p>
<p>下面说说JDK(java development kit)的API，其实用JDK来包括运行环境以及开发工具</p>
<p>个人感觉是不恰当的，因为这三个单词仅能说明开发工具，也就是几个标准的API</p>
<p>而没有让人感觉到有运行环境的意思在里面，这是题外</p>
<p>那么什么是API?</p>
<p>简单地说就是Application Programming Interface，应用程序编程接口</p>
<p>在java里面，就是一些已经写好了的类打成的包</p>
<p>这又要解释什么是类什么是包了，简单说一下，包就是类的集合</p>
<p>一个包包含零个或多个类，嗯，具体的可以去看书</p>
<p>这些类是java的基础类，常用的类，可以简单理解成java的工具集</p>
<p>最后说一下JDK的发布技术，其实按我的理解，讲白了就是编译器</p>
<p>将.java文件转换成.class文件的一种技术</p>
<p>这三部分组成了JDK，有了JDK，就可以开发出J2SE应用软件了</p>
<p>最原始的只要用一个记事本写几行代码就可以了</p>
<p>但一般来说我们会使用效果比较好的开发工具，也就是IDE</p>
<p>在J2SE这一块，特别推荐JCreator这款IDE</p>
<p>sun公司的产品，与JDK结合得几乎是天衣无缝，非常适合初学者使用</p>
<p>教材方面中文的推荐电子工业出版社出版的《java教程》初级与高级篇各一本</p>
<p>还有就是《21天学通java》虽然有人说21天系列是烂书，但个人感觉</p>
<p>对于j2se，这本书翻译得已经很不错了，基本没有什么语法错误，语句也很通顺</p>
<p>最后要说的就是《thinking in java》</p>
<p>这本书自然很经典，说得比较细，只是我觉得不太适合初学者，其实也不难</p>
<p>初学者直接看也不成问题，但个人感觉还是找本教材也就是前面推荐的两款来看比较好</p>
<p>基本概念的理解还是用教材的，毕竟thinking in java有的版本翻译得很烂</p>
<p>而且个人建议还是看原版比较好，当然这几本都看最好了，但如果没时间</p>
<p>至少精读其中一本，然后再看其他两本就可以，其实三本书内容也差不多</p>
<p>但看问题的角度方式以及面向的读者也都不同，嗯，怎么说呢，找适合自己的吧</p>
<p>最后要说的是</p>
<p>由于虚拟机的存在，J2SE的大多数软件的使用会比一般桌面软件慢一些</p>
<p>效果不尽如人意，现在大概只有swing控件还在使用吧，其它没怎么听说</p>
<p>J2EE&amp;J2ME</p>
<p>这是java应用的重中之重，如果想拿高薪，最好把J2EE学好</p>
<p>记得以前在csdn上看过一个调查，月薪上万的程序员主要从事哪方面的工作</p>
<p>十个中有八个是做J2EE的，其他两个一个做J2ME，还有一个做嵌入式</p>
<p>也许有些夸张，但也从某一方面说明J2EE人才的稀缺以及应用的广泛</p>
<p>所以如果想学java，只精通j2se是永远不够的，至少还需要时间去了解其它两个J2*E</p>
<h1 id="三：java企业级应用之硬件篇"><a href="#三：java企业级应用之硬件篇" class="headerlink" title="三：java企业级应用之硬件篇"></a>三：java企业级应用之硬件篇</h1><p>总算讲到企业级应用了，内容开始逐渐有趣起来</p>
<p>java企业级应用分为硬件篇和软件篇</p>
<p>重点在软件，硬件是外延，严格地说与java没有必然联系</p>
<p>但是，由于java是网络语言，不了解硬件的一些基础知识</p>
<p>软件知道再多也没什么用，不要上了战场还不知道为什么而打仗</p>
<p>硬件是软件的基础，在这个前提下，有必要专门花一点点篇幅来聊一下硬件</p>
<p>硬件，简单地说就是我们实际生活中看得见摸得着的东西</p>
<p>也就是那些冰冷的机器，比如服务器，个人电脑还有网络交换机，路由器等等</p>
<p>那么先抛开网络设备不谈，先来说说计算机电脑的历史</p>
<p>在很早很早以前，人类创造了第一台电脑，那时候的电脑只是一台用来计算的机器</p>
<p>无比大，无比重，无比傻，除了算其它屁事不会做，没有所谓的人工智能与计算机网络</p>
<p>但是总算是诞生了，虽然以今天的眼光去看那时候的机器巨傻无比</p>
<p>只配叫做计算器而不是电脑，没有逻辑思维能力，只会死算</p>
<p>但千里之行，始于足下，反正是造出来了</p>
<p>然后随着时间的推移，制造业发展发展发展</p>
<p>电脑性能逐渐得到提升，速度快了起来，成本也逐渐低了下来</p>
<p>于是人们造出了第二台，第三台，第四台，第五台……第n台计算机</p>
<p>人们就造出了无数台计算机并使其成为一种产品</p>
<p>逐渐应用于许多复杂计算领域，不仅仅是科研，许多生产领域也开始出现计算机的影子</p>
<p>然后又随着时间的推移，人们发现不可能把所有的计算机都做成一个样子</p>
<p>因为各行各业对计算机性能的要求各不相同</p>
<p>于是开始把计算机划分档次，最简单地是按照计算机的大小划分</p>
<p>就是教科书上写的大型机，中型机，小型机</p>
<p>个人感觉这样分纯粹扯淡，还以为是小孩子玩球，分为大球，中球和小球</p>
<p>但是不管怎样，计算机不再是千篇一律一个样子了</p>
<p>按照性能的不同，在不同领域，出现了满足符合不同要求的计算机</p>
<p>几乎在同时，人们也开始考虑计算机之间通讯问题</p>
<p>人们开始考虑将不同的计算机连接起来，于是网线出现了，网络出现了</p>
<p>又随着网络的发展，出现了一下专门为了寻址而存在的机器</p>
<p>这就是路由器和交换机，然后又出现了一些公益性的组织或团体</p>
<p>他们制定了一系列的标准来规范以及管理我们的网络</p>
<p>于是3w出现了，计算机的网络时代来临了</p>
<p>嗯，说到这里，计算机发展到今天的历史大概说完了</p>
<p>我们来详细说说网络时代的计算机以及各个硬件供应商之间的关系</p>
<p>前面说到了，计算机分为大型机，中型机和小型机……</p>
<p>但是现在市场上没有人这样分，要是出去买机器，对硬件供应商说</p>
<p>我要买一款中型机，或者说，我要买一款小型机，硬件供应商肯定会问问题</p>
<p>他们会问你买机器干什么用的？科学计算啊还是居家用，是作服务器啊还是图形设计</p>
<p>但不管怎样，简单地说大中小型机已经没有什么意义了</p>
<p>我们按照使用范畴来划分</p>
<p>简单划分为</p>
<p>服务器，工作站还有微机</p>
<p>服务器（server）</p>
<p>服务器涵盖了几乎所有的大型机以及大部分中型机甚至一些小型机</p>
<p>用通俗点话说衿骶褪悄掣龉?4小时不间断运行提供服务的机器</p>
<p>比如卖飞机票（中航信），比如酒店预定（携程）</p>
<p>比如提供门户站点相关服务（sina），比如电子商务（ebay，amazon，阿里巴巴）</p>
<p>这些服务对机器都有一些特定的要求，尤其强调安全和稳定</p>
<p>工作站（workstation）</p>
<p>工作站其实是图形工作站的简称，说白了，就是某种功能极其强大的计算机</p>
<p>用于特定领域，比如工程设计，动画制作，科学研究等</p>
<p>个人电脑/微机（pc）</p>
<p>计算机网络的最末端，这个应该不用我说太多了</p>
<p>网络时代的pc已经普及到千家万户</p>
<p>说完了分类，我们就来说说各个硬件供应商</p>
<p>首先是服务器还有工作站</p>
<p>这两类硬件供应商主要是以下三家</p>
<p>Sun,IBM还有HP(惠普)</p>
<p>然后是PC</p>
<p>以前IBM还有PC事业部，现在被联想吞并了（蛇吞象）</p>
<p>现在国际市场上有联想和DELL(戴尔)，目前戴尔还是国际老大</p>
<p>还有HP康柏</p>
<p>然后是网络，也就是路由器和交换机</p>
<p>这块市场嘛，Cisco(思科)Brocade(博科)还有McDATA三足鼎立</p>
<p>内核(CPU)</p>
<p>PC内核</p>
<p>主要是AMD和Intel，前者最近与Sun公司合作，Sun也有一部分单双核服务器用的是AMD的</p>
<p>服务器与工作站内核</p>
<p>这一块与硬件厂商绑定</p>
<p>还是Sun,IBM,HP三家自己生产</p>
<p>题外</p>
<p>在一些大型主机应用市场，比如卖飞机票</p>
<p>德国的汉莎，中国的中航信，香港的国泰用的都是尤利（美国的公司，英文名我忘了）</p>
<p>其它用的是IBM的机器，现在能做大型机的感觉似乎只有IBM可以</p>
<p>尤利已经快倒了，技术太落后了，现在他们的系统还是fortran写的，连c都不支持</p>
<p>要特别说明的是，一个超大型主机然后多个小终端/pc的结构现在越来越没市场了</p>
<p>将来的趋势是用一整个包含多个服务器的分布式操作系统来取代这些大型主机</p>
<p>因为大型主机更新换代极其困难，一旦数据量超过了主机的处理能力</p>
<p>那么就要换主机，这个成本是极大的，但是如果用分布式操作系统</p>
<p>那就只需要增加小服务器就行了</p>
<p>硬件就大概说到这里，与大多数人没什么关系</p>
<p>因为大多数人压根不可能进入这些硬件领域，除非做销售</p>
<p>说了这么多，只是为了给软件部分打基础而已</p>
<p>//做嵌入式的除外</p>
<h1 id="四：java企业级应用之软件篇"><a href="#四：java企业级应用之软件篇" class="headerlink" title="四：java企业级应用之软件篇"></a>四：java企业级应用之软件篇</h1><p>嗯，说过了硬件就该是软件了</p>
<p>这篇是这个系列的重中之重</p>
<p>首先我们来说说什么是软件，统一一下概念</p>
<p>所谓软件通俗地说就是一套计算机程序</p>
<p>实现了某些功能的计算机程序</p>
<p>在很早很早以前，一台计算机的软件是不分层次结构的</p>
<p>一台计算机只有一个系统，这个系统既是操作系统又是应用软件，与硬件紧密绑定</p>
<p>后来经过许多年的发展发展发展</p>
<p>人们把一些与硬件紧密相连的又经常用到必不可少的功能做到一套程序中去</p>
<p>这一套程序就被人们称做操作系统</p>
<p>另外一些可有可无的，不同工作适应不同环境的功能封装到另外一套程序中去</p>
<p>而这一系列程序被人们称作应用软件</p>
<p>如下图：</p>
<hr>
<p>|应用软件：falshgat/IE/realplayer/winamp..|</p>
<hr>
<p>|操作系统：UNIX/Windows/Linux/Solaris…  |</p>
<hr>
<p>前一篇我们知道，硬件分为服务器工作站与pc</p>
<p>其实无论哪种硬件的软件，都有操作系统与应用软件</p>
<p>ok，那下面我们来谈应用软件</p>
<p>在现在企业级应用中，我们的应用软件一般分为三层</p>
<p>三层分别是表示层，业务逻辑层，数据持久层</p>
<hr>
<p>|表示层|业务逻辑层|数据持久层|</p>
<hr>
<p>我们来说说三层中的代表软件</p>
<p>表示层</p>
<p>这一层一般在客户端pc机上，最常见的是IE浏览器，这就是表示层的软件</p>
<p>表示层是直接与使用者交互的软件</p>
<p>业务逻辑层</p>
<p>这一层一般在服务器端，顾名思义，所有业务逻辑处理都在这一层完成</p>
<p>最典型的是appserver，比如IBM的websphere，BEA的weblogic还有tomcat/jboss等</p>
<p>这一层也是三层中的重点，我们要说的大部分内容都是关于这一层的，这个等会再说</p>
<p>这一层就叫做中间层</p>
<p>数据持久层</p>
<p>这一层典型的就是数据库，一般也在服务器端</p>
<p>但该服务器一般与装业务逻辑层软件的服务器分开</p>
<p>当然你也可以用IO输入输出流往硬盘上写东西</p>
<p>但没人会建议你这么做，因为这样做你的数据缺乏管理，不管怎样</p>
<p>这一层要做的就是保存数据，业务逻辑层软件一般不负责保留数据</p>
<p>或者说业务逻辑层只负责暂时储存数据，一关机，业务逻辑层数据全部over了</p>
<p>那么数据的持久化（也就是储存数据）就必须要在这一层完成</p>
<p>下面放着这些概念不谈，我们来说说将来的趋势</p>
<p>趋势一：</p>
<p>瘦客户端，很早很早以前，当时C/S模式也就是client/server</p>
<p>客户端软件大行其道的年代，一个pc用户，是采用一个傻终端连接到服务器上</p>
<p>然后进行相应的操作，最典型的就是我们上bbs经常用的c-term</p>
<p>这就是那个时代的产物，同样还有我国现行的机票定座用的e-term</p>
<p>后来呢，浏览器变得非常流行，人们发现，浏览器也能传递一些数据</p>
<p>虽然这些数据并不像那些终端那样准确，但应付大多数日常需求足够了</p>
<p>于是人们就提出一个瘦客户端概念，也就是说，将来表示层所有的其他软件疾挥?</p>
<p>我们唯一需要的就是一个网页浏览器，然后通过浏览器输入ip地址连接到服务器</p>
<p>然后进行相关的操作，由于网页浏览器一般每个操作系统都有自带一个</p>
<p>这样做就达到了给我们客户端瘦身的目的（不需要安装额外软件）</p>
<p>这样模式被称作B/S模式，也就是browser/server模式</p>
<p>但需要指出的是，虽然瘦客户端是趋势，但并不代表胖客户端没有市场</p>
<p>尤其是一些复杂的业务操作，还是浏览器这种简单软件无法胜任的</p>
<p>趋势二：</p>
<p>傻数据库，ok，首先，我承认，这个名词是我发明的，但我实在无法找到一个更好的表达</p>
<p>什么是傻数据库，如果谁对数据库有所了解的话，就知道，以前的数据库</p>
<p>有自己的一套管理体系，甚至有自己的客户端，比如oracle,mysql,sqlserver都有</p>
<p>在某个管理工具上写什么sql语句查询数据库是我们以前常做的事</p>
<p>那么将来我们提倡的是：将所有的业务逻辑封装到业务逻辑层去</p>
<p>管理的事情由软件来做，由业务逻辑层的软件来做</p>
<p>所谓傻数据库就是说，将来的数据库什么事都不用做</p>
<p>只用把数据给我保存好就行了，那些复杂的业务逻辑什么外键什么关联</p>
<p>都没数据库什么事了，都交给业务逻辑层软件来做</p>
<p>这样做的好处就是：我们就不需要这些该死难懂又复杂的数据库系列管理工具了</p>
<p>而且这些工具每个数据库都有自己的工具，完全不一样，乱七八糟，没有人喜欢面对他们</p>
<p>除了数据库维护人员，也就是DBA，我们是软件工程师，维护的事让他们去做</p>
<p>而且严禁数据库维护人员改动数据库的数据，他们只做备份，必要时候恢复一下就是了</p>
<p>了解了这两个趋势之后，是不是有种砍头去尾保中间的感觉？</p>
<p>没错，未来的趋势就是中间件时代，中间件工程师将是未来计算机应用的主流</p>
<p>那再次统一一下概念，什么是中间件？</p>
<p>记得我上学的时候，看ibm的教材，看了半天中间件定义，就看懂记住一句话</p>
<p>中间件是做别人不愿意去做的事情，现在想想，狗屁定义，呵呵</p>
<p>什么是中间件，中间件是业务逻辑层的应用软件</p>
<p>是处理业务数据与客户端之间业务逻辑的一种应用软件</p>
<p>一种提供网络服务的服务器端应用软件</p>
<p>举个非常简单的例子，网上银行，某个人想用IE进入工行的账户，然后转帐</p>
<p>在这个例子中，客户端表示层显然是IE，数据持久层显然是银行的核心数据库</p>
<p>那么中间件是什么？中间件就是提供这种服务的系统</p>
<p>这三层的划分如下</p>
<hr>
<p>|表示层 | 业务逻辑层 | 数据持久层 |</p>
<hr>
<p>|  IE   |  网上银行  |   数据库   |</p>
<hr>
<h1 id="五：企业级应用之中间件"><a href="#五：企业级应用之中间件" class="headerlink" title="五：企业级应用之中间件"></a>五：企业级应用之中间件</h1><p>前面一篇简单介绍了一下应用软件的分层<br>下面重点介绍一下中间件，也就是业务逻辑层的软件结构</p>
<p>从本系列第二篇我们知道，java程序是跑在虚拟机之上的</p>
<p>大致结构如下：</p>
<p>| grogram  |</p>
<p>|  虚拟机  |</p>
<p>| 操作系统 |</p>
<p>也就是说操作系统先运行一个java虚拟机，然后再在虚拟机之上运行java程序<br>这样做的好处前面也说过了，就是安全，一旦出现病毒或是其他什么东西<br>挂掉的是虚拟机，操作系统并不会受多大影响</p>
<p>这时候有人可能会问，为什么非要虚拟机？把操作系统当成虚拟机为什么不行？<br>可以，当然可以，但是这样做某一个应用软件的bug就可能造成整个操作系统的死亡<br>比如说我们在某个服务器上安装了一个收发电子邮件的软件和java虚拟机<br>那么一旦黑客通过收发电子邮件的软件入侵系统，那么操作系统就整个玩完<br>那么如果黑客通过java程序进行攻击的话，那么死的将会是虚拟机而不是操作系统<br>大不了虚拟机崩溃，而操作系统正常运行不受任何影响</p>
<p>举个简单例子，比如说最常见的是将数据库(DB)与中间件放在同一台服务器上</p>
<p>|  program |           |<br>|     DB    |</p>
<p>|  虚拟机  |           |</p>
<p>|        操作系统      |</p>
<p>那么此时如果没有虚拟机，黑客病毒攻击中间件系统，就有可能造成操作系统的死亡<br>那此时数据库也有可能跟着一起玩完，那损失可就大咯<br>那如果此时有虚拟机，那么一旦被攻击，死的是虚拟机，操作系统与数据库不受任何影响</p>
<p>嗯，回顾完虚拟机，再来介绍中间件<br>在很早很早以前，任何一家企业，想要搭建一个局域网系统，他需要请许多个工程师<br>比如说我们想搭建一个网上银行，客户端用浏览器,后台数据库比如说用oracle</p>
<p>那么搭建这样一个网上银行，可能需要用到多少个工程师，我们来算一算<br>首先，由于客户端用的是浏览器，我们需要一些了解网络通讯协议以及一些浏览器标准的网络工程师<br>其次，由于后台数据库用的是oracle，那我们还需要请oracle的工程师，因为数据库这一层每个数据库公司的接口什么都不一样<br>然后，我们还需要一些操作系统的工程师，因为我们的系统需要跟操作系统直接交互<br>最后，我们需要一些设计网上银行系统及其相关业务的工程师</p>
<p>太多了太多了，这样一个中间件队伍实在太庞大了，制作维护成本实在太高了<br>不仅如此，这样一个中间件就算做出来，他们所写的代码也只能满足这一家公司使用<br>其它公司统统不能再用，代码重用率极低，近乎不可能重用<br>毕竟这个系统中改动任何一个部分都有可能涉及到整个系统的改动</p>
<p>那么如何降低成本？</p>
<p>我举出了四组的工程师：<br>网络工程师，数据库工程师，操作系统工程师以及设计网上银行系统的业务工程师<br>除了最后一组设计网上银行的业务工程师之外，前面三组工程师是不是每一个项目都需要的？<br>就算不是每一个项目都需要，至少也是绝大多数项目需要的吧？<br>哪个项目能够脱离网络，数据库和操作系统？不可能，在这个时代已经很少很少了<br>好，那既然每个项目都需要，我们是不是可以用一个产品来取代这三组的工程师呢？<br>我们的业务工程师只需要遵循这个产品所提供的接口，进行相应的开发就行了<br>人们提出了一种叫做appserver也就是应用服务器的东西<br>应用服务器是干什么的？按官方的说法，应用服务器是包括有多个容器的软件服务器<br>那容器是什么？容器(Container)到底是个什么东西我想多数人还是不清楚</p>
<p>在说这个之前，先介绍一下组件<br>什么是组件，组件是什么？组件其实就是一个应用程序块<br>但是它们不是完整的应用程序，不能单独运行<br>就有如一辆汽车，车门是一个组件，车灯也是一个组件<br>但是光有车灯车门没有用，它们不能跑上公路<br>在java中这些组件就叫做javabean，有点像微软以前的com组件<br>要特别说明的是，由于任何一个java文件编译以后都是以类的形式存在<br>所以javabean肯定也是一个类，这是毫无疑问的</p>
<p>好，那么容器里装载的是什么呢？就是这些组件<br>而容器之外的程序需要和这些组件交互必须通过容器<br>举个例子，IE发送了一个请求给容器，容器通过调用其中的一个组件进行相关处理之后<br>将结果反馈给IE，这种与客户端软件交互的组件就叫做servlet</p>
<p>但是组件有很多种，那么如何区分这些组件呢？<br>有多种管理办法，比如同是同样是servlet，有些是通过jsp生成的<br>而有些是开发人员自己写的，那么通过jsp生成的servlet集中放在一个地方<br>而开发人员自己写的则需要在xml里面配置一些基本的参数<br>同时，不同组件有可能还需要继承一些特定的父类或者接口，这也是容器管理的需要<br>还有其他的一些组件，这里就不一一说明举例了</p>
<p>那么容器有很多种，按照他们装载的组件类型划分<br>比如有装ejb的ejb容器，有装servlet与jsp还有静态页面的web容器等等<br>//这种只含有web容器的应用服务器也被叫做web服务器</p>
<p>当表示层的应用软件通过网络向appserver发送一个请求的时候<br>appserver自动找到相应容器中的组件，执行组件中的程序块，把得到结果返还给客户<br>而我们要做的事就是写组件也就是javabean，然后放到appserver里面去就可以了<br>至于怎样与IE通讯，怎样截获网络上的请求，怎样控制对象的数量等等<br>这些繁琐而无味的工作我们都不管，都由appserver去做吧，把注意力集中在业务逻辑上</p>
<p>appserver与其他相关软件的关系如下图：</p>
<p>|              |    —————–    |            |<br>|      IE      |    |   javabean    |    |            |<br>|              -&gt;   —————–    -&gt;   DB      |<br>|    client   &lt;-              appserver &lt;-            |<br>|              |————————-|            |</p>
<table>
<thead>
<tr>
<th></th>
<th>虚拟机</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Windows</td>
<td>Linux/Saloris</td>
<td>LinuxSaloris</td>
</tr>
<tr>
<td>————–</td>
<td>————————-</td>
<td>————</td>
</tr>
<tr>
<td>图上可以看出：虚拟机负责处理中间件与操作系统之间的交互</td>
<td></td>
<td></td>
</tr>
<tr>
<td>appserver则负责组件的管理以及与其他两层的业务交互</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>1 附图: image002.gif (76463 字节)</p>
<p>要说明的是上图中还包含有应用程序客户端容器(Application client container)<br>管理应用程序客户端组件的运行，应用程序客户端和它的容器运行在客户机<br>这种情况比较复杂一般说的是两个server之间的通讯<br>比如jsp/servlet容器在一个服务器上，而ejb容器在另外一个服务器上等等<br>这是分布式操作系统大面积应用的基础，这个以后再说<br>下面这张相对简单：<br>2 附图: j2ee.gif (8226 字节)</p>
<p>嗯，那么话题再回到中间件上去，什么是中间件？<br>appserver就是所谓的中间件，但是中间件不仅有appserver，还有其他的东西<br>换句话说，appserver只是中间件的一种<br>而关于中间件有诸多规范以及遵循这些规范的模型<br>最流行的规范无非两种，一个是j2ee还有一个是.net<br>但是.net几乎只有微软在用，所以很多人把.net这个规范就当成是微软的中间件产品<br>也不为过，毕竟没几个公司喜欢跟着微软屁股后面跑的</p>
<h1 id="六：java企业级应用之综合篇"><a href="#六：java企业级应用之综合篇" class="headerlink" title="六：java企业级应用之综合篇"></a>六：java企业级应用之综合篇</h1><p>我们知道中间件有很多种规范以及相关的模型<br>最流行的一个是j2ee还有一个是.net<br>那么各大公司关于这两套规范各有什么产品以及周边呢？</p>
<p>j2ee:</p>
<p>黄金组合<br>操作系统：Solaris<br>应用服务器：Weblogic<br>数据库：Oracle<br>开发工具：JBuilider/IntelliJ IDEA<br>优点：性能一级棒，大企业大公司做系统的首选，世界五百强几乎都是这套组合<br>缺点：极贵</p>
<p>超级组合，也是最安全最酷的黄金组合，硬件采用SUN公司的机器<br>但是SUN的服务器很贵，同等价格不如去买IBM的机器<br>SUN的服务器支持Solaris的效果自然不用说，Solaris号称是世界上最安全的操作系统<br>Oracle也是世界上最安全，性能最优的数据库，Weblogic是当今性能最优的appserver<br>JBuilder和IDEA各有所长，JBuilder是Borland公司的招牌之一<br>是当今世界上最流行的java IDE，用delphi写的，但网络上评价似乎不是很好<br>IDEA拥有插件功能，界面在所有java IDE中最为漂亮，东欧人开发的产品<br>东欧人严谨的作风在这个产品上体现得尤为突出，用java写的<br>IDEA甚至号称自己被业界公认为是最好的IDE//个人保留意见，没有最好只有更好<br>但我用JBuilder的时候发现了不少bug，而至今还没有在IDEA上发现什么bug<br>个人推荐IDEA<br>价格方面，Solaris开源，但是SUN的服务器比较贵，Weblogic最高是34万<br>oracle标准版要18.6万，企业版要49万，JBuilder要2.7万左右<br>IDEA零售价大概是500美金，也就是5000多元<br>另外，虽然理论上这些产品的综合性能要高于其他选择，但是必须看到<br>由于产商之间的利益冲突，比如oracle也有自己的appserver，但是性能不怎样</p>
<p>使得这几种产品之间协作的性能要比预想中的要差一点点</p>
<p>开源系列<br>操作系统：-<br>应用服务器：JBoss<br>数据库：MySql<br>开发工具：Netbeans<br>优点：便宜，性能未必最佳，但是对付中小企业足够了<br>缺点：出了问题自己抗吧</p>
<p>嗯，这是java阵营最大的特色，免费免费，还有在开发工具这一栏Eclipse也是免费的<br>但后面要说，算了，换个有代表性的开源产品来<br>tomcat仅有web容器而没有ejb容器，而jboss已经集成了tomcat<br>也就是说下载了jboss之后，启动的同时也就启动了tomcat<br>jboss在tomcat基础之上多加了一个ejb容器，使得jboss+tomcat成为和weblogic<br>websphere之外又一个得到广泛应用的appserver<br>现在大概是这样，中小型企业多用jboss，如果应用小一点就用tomcat<br>只有给那些大型企业做的项目，才会花钱去上一个weblogic或者websphere<br>mysql也是开源的数据库，做得非常不错，如果系统对数据库要求不高<br>或者安全要求不是非常严格，mysql是一个非常不错的选择<br>开发工具方面，netbeans是sun公司极力推广的一种IDE<br>听说在北美市场使用量已经超过eclipse了</p>
<p>操作系统，软件再不用钱，服务器也要钱，看这台机器上跑什么操作系统就用什么了</p>
<p>IBM套餐<br>操作系统：Linux<br>应用服务器：Websphere<br>数据库：DB2<br>开发工具：Eclipse/WebSphere Studio<br>优点：服务好，IBM可以提供全套服务，也可以替客户承担风险<br>缺点：把机器数据全部交给IBM，安全什么的都由不得你了</p>
<p>呵呵，IBM全套产品，甚至包括硬件设备IBM的服务器<br>由于是一个公司的产品，各产品之间的协作自然不错<br>价格方面，Linux，DB2，Eclipse都是开源产品，Websphere目前零售价是33.8万人民币</p>
<p>IBM服务器不错，可以考虑</p>
<p>.net：</p>
<p>微软阵营<br>操作系统：Windows<br>应用服务器：.net应用服务器(好像叫IIS)<br>数据库：SqlServer<br>开发工具：MS Visual Studio<br>优点：客户端的用户体验良好，和客户端诸多微软产品的兼容性强<br>缺点：离开了微软，寸步难行，和其他任何一家公司的产品都不兼容</p>
<p>微软的东西，怎么说呢，太专横了<br>微软所有的东西都是围绕着windows来做的<br>.net其实已经可以实现跨平台了，但是微软出于自身商业考虑<br>在其应用服务器跨平台的实现上设置了种种障碍<br>而且针对windows，微软做了大量的优化，可以这么看<br>.net就是与windows捆绑的一套产品<br>所以有些人说，微软的产品离开了windows，就是渣<br>而且.net开源选择也少，安全性方面考虑，windows本身就有一堆补丁要打了<br>sqlserver也不安全，至于.net到底安全不安全我不清楚，毕竟我没怎么用过<br>但整体考虑，感觉.net不是大企业的首选，鉴于其浓厚的商业背景<br>也不是中小企业的首选，但是必须看到<br>客户端也就是微机pc市场已经完全被windows所垄断<br>所以在一些快速开发，还有和微软产品兼容性要求较高的领域，.net还是比较有市场的<br>最后一个visual studio对它之前的版本兼容，且支持c,c++,c#,vb等语言</p>
<p>在其传统领域，比如写一些桌面软件等客户端应用上，.net还是第一选择</p>
<p>最后要说明的是<br>这些组合不是固定不变的<br>由于J2EE得到了绝大多数IT企业的支持以及JAVA跨平台的特性<br>我们可以自由地定制个性化的组合<br>比如我可以选择windows+jboss+eclipse+oracle<br>也可以选择solaris+websphere+IDEA+mysql<br>等等，这些自由组合都是可以的，但是有一点必须说明<br>微软的东西，一般来说离开了windows就不能用<br>比如你选择了.net应用服务器，那操作系统就必须是windows<br>你选择了sqlserver，那就必须在windows上用<br>还有就是遵循j2ee规范的所有的组件都可以在不同的应用服务器上互相移植<br>比如你可以在测试的时候用jboss<br>而在正式投产上线的时候使用websphere，只需要在配置文件中作相应改动即可</p>
<h1 id="七：java企业级应用之术语篇"><a href="#七：java企业级应用之术语篇" class="headerlink" title="七：java企业级应用之术语篇"></a>七：java企业级应用之术语篇</h1><p>在了解完J2ee的相关周边产品之后需要深入J2ee规范内部去了解一下到底这些规范<br>这里介绍几个最常用的规范<br>再继续说下去之前有必要说几个常识</p>
<p>Java的诞生<br>Java之父James Gosling早年从cmu毕业之后<br>从事了一段时间的开发工作，后来意外碰到一个项目<br>这个项目要求他用C++开发，但可爱的JG是天才，凡是天才在某方面特别突出的同时<br>必然有一些天生的缺陷，恩，或说共性，比如说懒，急躁和傲慢<br>JG既然是天才，那就必然具备这些共性，JG懒，以至于他学不好C++<br>不仅他学不好，当年开发出Java的那个团队也都学不好C++<br>他们急噪，以至于他们中有人甚至威胁以辞职的方式离开这个需要使用CPP开发的项目<br>他们傲慢，所以他们决定开发出一种新的语言来取代那个该死的CPP<br>更可爱的是，他们一开始居然给这门语言起名C++++–//没错，我没敲错<br>叫什么C加加 加加减减，意思是加上一些好东西，减去一些坏东西<br>天才的设定，有时候你会发现天才和傻瓜真的只有一线之隔<br>还好这个可爱的名字没有被继承下来，这些天才们给他们的产物起名叫Oak//橡树<br>只是后来当他们去注册这个名字的时候，发现这个名字已经被注册了<br>于是在Sun公司的一个女职员//mm就是心细，这个说法也是我们公司mm告诉我的<br>的提议下，把这个可爱的语言起名为Java，就是他们当时喝的咖啡的名字<br>所以我们看到Java的标志就是一杯冒着热气的咖啡</p>
<p>JavaBean 了解完Java之后，再来说说什么是JavaBean//华为面试题<br>JavaBean是什么？ 咖啡豆<br>ja，更为科学点的解释是<br>用java语言编写的可重用的软件组件//组件的定义前面说过了，不再重复<br>很形象不是么？ 将javabean放入杯子//容器，还记得容器的概念么？web容器，ejb容器<br>就可以冲泡//编译 成咖啡，供客人们品尝//运行<br>完美的服务</p>
<p>下面进入正题 再谈容器<br>前面介绍过容器，我觉得有必要再补充一点<br>容器从某种意义上说其实就是一个可运行的java写的应用程序<br>犹如c++/c编译后生成的.exe文件<br>不同的是java编译后的文件需要用命令行或者脚本启动执行<br>由于容器是由java写的，所以容器都能够跨平台<br>虽说如此，似乎大部分容器都针对不同的操作系统提供了不同的版本<br>但可以肯定的一点是，相同容器间的移植组件不需要重新编译</p>
<p>Servlet web容器组件<br>Servlet确切地说，就是web容器运行的java组件<br>与普通javabean不同的是，Servlet定义了一系列方法//比如init()和destroy()<br>供容器调用，调用的主要目的是为了管理<br>当一个request请求被web容器截获之后，容器分析该请求地址<br>然后通过一个配置文件中的映射表//web.xml<br>调用相应的Servlet组件处理后将结果返还给客户端</p>
<p>JSP//Java Server Page<br>web容器组件<br>Servlet出现了之后，人们发现几乎没有办法用一个非常直观的方式去编写页面<br>毕竟页面是html语言编写的<br>而让我们用一种流程式的处理方式去逐行教计算机如何写html代码太困难<br>在这种情况下JSP应运而生，JSP将java代码嵌入html代码内部<br>然后存成.jsp文件，再由计算机编译生成Servlet储存起来//注意这个过程<br>所以JSP和Servlet对于web容器来说其实是一种东西，虽然它们编写遵循的标准有所不同<br>极大地简化了代码同时增加了代码的可读性，生产维护成本下降<br>值得一提的是，在制定JSP规范的过程中，借鉴了ASP的很多规范<br>写过ASP并熟悉Java语言的人应该能很快掌握JSP</p>
<p>EJB//Enterprise JavaBean<br>ejb容器组件<br>随着时间的推移，人们发现普通的JavaBean似乎并不能满足企业级应用的需要<br>最典型的就是虚拟机提供的垃圾回收收集机制也就是GC不够完善<br>可以优化的余地极大，在这种情况下，EJB应运而生<br>EJB和其它组件一样，不过遵循了某些规范而已<br>但是这些规范更多的是为充分利用机器并提高性能为主要目的的<br>举个简单例子<br>比如某个web服务器有100个用户同时连接上<br>由于网络连接是瞬时连接，所以很多时候并发数并没有100那么大<br>前一秒有可能有30个请求被发送过来并被处理<br>后一秒可以只有10个请求被发送过来并被处理<br>只有在非常非常极端的情况下才有可能发生100个请求同时被发送过来并被处理的情况<br>那么我们是否需要保留100个那么多个对象在服务器的内存里面去处理这些请求呢？<br>很显然，不需要，大多数时候//甚至可以说是所有时候，我不相信有那么极端的情况<br>我们只需要保存其中的10-30%就够了，那么什么时候需要20%，什么时候需要50%<br>甚至100%，这个过程就交给容器去管理，这就是ejb容器每天在干的事<br>管理内存中活跃的对象</p>
<p>恩，必须强调的一点是，由于使用的不成熟<br>我们经常把规范以及具体的应用两个名词混用<br>举个简单例子，我们说Servlet，极有可能说的是Servlet规范<br>也有可能说的是一个具体的Servlet，这个就要看情况而定了<br>EJB，JSP也是如此</p>
<p>JDBC<br>和数据库的连接<br>这个严格说来是数据库产商需要关心的事<br>关于AppServer如何与数据库的连接<br>但是也需要开发人员做一点事，因为AppServer不知道什么时候组件需要用到数据库<br>同时也需要开发人员告诉AppServer他们使用的是什么数据库，ip地址等等<br>JDBC就是关于这一套东东的规范<br>包括数据库的产商应提供什么样的接口<br>AppServer应用服务器应该如何去连接<br>开发人员应该如何去配置这些连接等等<br>还有一些数据源，连接池等概念参考相关数据在此就不再赘述<br>其它的规范比如JMX等确切地说与开发人员关联并不大了<br>这类高级应用只对AppServer应用服务器产商重要<br>也不再罗嗦了</p>
<p>记得听说过这样一种说法<br>大一时候不知道自己不知道 大二时候知道自己不知道 大三时候不知道自己知道 大四时候知道自己知道 为什么呢，因为大一时候刚进大学，什么都不懂，很正常，大家都一样<br>大二或者大三时候开始接触知识，虽然还是不懂，但慢慢地开始学习，开始积累<br>过了一段时间，知道自己知道了//也就是前一种说法的大四，后一种说法的大三<br>开始屁癫，开始拽得不得了，觉得自己怀才不遇，千里马难寻伯乐的那种感觉<br>有些人是大四毕业了以后开始拽，悟性高一点的，大三就开始拽，因人而异<br>这几乎是每一个初学者经过一段时间学习后的必然阶段<br>不管如何，总之开始入门了，这也不是坏事<br>但最后每个人都会知道自己不知道的，也就是后一种说法的大四阶段<br>//前一种说法里面的那些家伙估计要到工作以后才能明白<br>因为任何一门学科都博大精深，要是能在两三年之内就统统搞懂<br>那不是在吹牛就是坐井观天，java如此，c如此，c++也是如此</p>
<p>那么到了本系列的第七集，可爱的读者应该处在什么阶段呢？<br>恭喜，在看完这篇文章之后，你就基本处于知道自己不知道的那种阶段<br>离拽起来还有那么一段距离，因为你们毕竟还没有学习和积累一定的基础知识<br>但是骗骗外行，蒙蒙国企那些吃闲饭的管理人员问题不大</p>
<h1 id="八：java高级应用之框架篇"><a href="#八：java高级应用之框架篇" class="headerlink" title="八：java高级应用之框架篇"></a>八：java高级应用之框架篇</h1><p>没错，我没敲错<br>之所以不再声称是企业级应用而称之为高级应用 是因为下面要讲的东西属于纯民间性质<br>是java具体应用的上层建筑，可用可不用，没有人强迫你用</p>
<p>首先给框架//framework 下一个定义<br>我想读者你可能听说过.net framework这个概念<br>没错，我们将要说的framework也和这个framework差不多<br>所不同的是.net framework的竞争对象是j2ee那一系列标准<br>而我们将要说到的几个框架则应用在j2ee的不同层面<br>单就单个框架而言，没有.net framework管得那么多<br>但是却要比它精专多了，而且总量加起来，也远比微软那一套框架要广泛得多<br>回到正题，框架是什么？<br>软件工程之所以被叫做软件工程就是因为有那么一批人觉得可以用工程学里面<br>那些管理Project的方法来管理软件从开发到维护这一系列流程<br>那么在建筑工程里面框架是什么？<br>现在建筑多采用钢筋混凝土结构，注意里面一个很重要的词汇：钢筋<br>托福阅读中曾有一题听力就是关于钢筋结构的诞生，在美国<br>恩，现代建筑中多在建筑起来之前，先用钢筋搭建出一个框架出来<br>然后往钢筋中间填入混凝土，从而形成一个完成的建筑<br>而今天要说到的框架就是这么一个东西在每一个软件中间的实现<br>框架就是那么一个通过预先写好代码从而帮我们建立起一个软件结构的这么一个东西</p>
<p>这里提一下框架与规范//主要指J2ee规范也就是官方标准的区别<br>从某种意义上说，J2ee规范本身就是一个框架<br>无论是web容器也好，还是ejb容器也好，它们都开发了一部分通用的代码<br>并且帮助我们搭建起来了一个软件结构，我们要做的就是往里面填入组件<br>比如ejb/servlet/jsp等等<br>没错，要这么理解也没错，但是为了避免混乱，我们还是严格区分开来<br>本文中将要提到的框架如无特别说明，就是指的是非官方标准的框架<br>规范是规范，而框架是建立在规范之上的一种东西<br>可以说是标准的延续，或者说是民间的尝试，总之是这么一个非官方的东西<br>说到这里顺便提一下JCP组织也就是Java Community Process/Java社区<br>当初Sun公司在java发布之初，为了提倡开源和共项<br>同时也出于一个提出合理的标准的目的，而让广大的开发者参与标准的制定<br>而成立了这样一个社区，现在还健在，网址是jcp.org<br>每一个新的规范发布之前都会在这个社区广泛讨论，最终对规范的制定产生巨大的影响<br>其中就包括企业级的参与者，相当有名的JBoss以及我国的金碟公司都是其中的成员</p>
<p>下面介绍一下几个相当著名的框架，必须要指出的是，虽然框架大多开源 但并不代表所有的框架都开源，比如.net framework，但是java框架大多数开源<br>言归正传<br>Struts<br>表示层框架，名字来源于飞机的金属框架<br>可能有读者会提问了<br>表示层不是客户端么？<br>没错，但是语言这东西，众口烁金，别人都这么说你就不好不这么说了<br>最早表示层说的是客户端，后来随着时间的发展<br>人们也把服务器端直接与客户端//比如IE<br>打交道的那部分也称为表示层//JSP+Servlet<br>那么表示层框架是干什么的呢？<br>早先大规模应用JSP的时候，人们发现，JSP里面充斥着逻辑代码与数据<br>可读性极差，于是人们借用很早很早以前的MVC模式的思想<br>把表示层组件分为V-Viewer，也就是JSP<br>M-Model模型，一般来说是一个JavaBean<br>C-Controller控制器，一般来说是一个Servlet<br>所有人通过JSP和服务器打交道，发送请求，Viewer把这个请求转发给Controller<br>Controller通过调用一个Model来处理该请求，然后返回数据到Viewer<br>这么一个过程，从而达到数据与逻辑的剥离，增强代码可读性，降低维护成本<br>而帮助人们实现这一系列东西的就是Struts框架，就是这么一个东西<br>Struts的竞争对手主要是产商们极力倡导的JSF也就是Java Server Faces<br>但是由于Struts出道时间早，所以应用比较多<br>JSF则是产商们大力支持，前景看好<br>对于这一层来说，在JSP的html代码中出现的java语句越少越好<br>因为java代码越少说明页面处理的业务逻辑越少，也越合理<br>这也是Struts最初的目的，记住这话</p>
<p>Spring 大名鼎鼎的Spring框架<br>有人曾说2005年一片叫春之声，指的就是该框架<br>Spring起源于Rod Johnson的《Expert One-on-One J2EE Design and Development》一书<br>Rod Johnson认为，J2ee里面的那一套//尤其是ejb<br>太重了，对于单机的系统来说，没有必要使用那么复杂的东西<br>于是就开始设计并引导Spring小组开发出这样一个构架<br>不能不说他是个天才，因为的的确确不是所有的系统都是跨多服务器的<br>没有必要把一个简单的系统设计得那么复杂//天才的那几个共性又体现出来了<br>Spring从诞生之日起就是针对EJB的，力争在不少应用上取代EJB<br>而它也确实达到了这个目的<br>现在包括WebLogic等主流应用服务器还有主流IDE都开始逐渐接受该框架<br>并提供相应支持<br>提到Spring就不能不说控制反转Ioc//Inversion of Control<br>和依赖注射DI//Dependency Injection<br>什么叫控制反转呢？<br>套用好莱坞的一句名言就是：你呆着别动，到时我会找你。<br>什么意思呢？就好比一个皇帝和太监<br>有一天皇帝想幸某个美女，于是跟太监说，今夜我要宠幸美女<br>皇帝往往不会告诉太监，今晚几点会回宫，会回哪张龙床，他只会告诉太监他要哪位美女<br>其它一切都交由太监去安排，到了晚上皇帝回宫时，自然会有美女出现在皇帝的龙床上<br>这就是控制反转，而把美女送到皇帝的寝宫里面去就是注射<br>太监就是是框架里面的注射控制器类BeanFactory，负责找到美女并送到龙床上去<br>整个后宫可以看成是Spring框架，美女就是Spring控制下的JavaBean<br>而传统的模式就是一个饥渴男去找小姐出台<br>找领班，帮助给介绍一个云云，于是领班就开始给他张罗<br>介绍一个合适的给他，完事后，再把小姐还给领班，下次再来<br>这个过程中，领班就是查询上下文Context，领班的一个职能就是给客户找到他们所要的小姐<br>这就是lookup()方法，领班手中的小姐名录就是JNDI//Java Naming and Directory Interface<br>小姐就是EJB，饥渴男是客户端，青楼是EJB容器<br>看到区别了么？饥渴男去找小姐出台很麻烦，不仅得找，用完后还得把小姐给还回去<br>而皇帝爽翻了，什么都不用管，交给太监去处理，控制权转移到太监手中去了<br>而不是皇帝，必要时候由太监给注射进去就可以了<br>看到Spring的美妙了吧，Spring还提供了与多个主流框架的支持<br>可以和其它开源框架集成<br>Hibernate<br>名字取材自ORM最早的一句玩笑话//ORM就是OR-Mapping<br>说用了ORM之后，程序员就可以去冬眠了，而不需要操心那么多事<br>这里不得不说的是，该框架由于做得太好，以至于被J2ee招安，成为EJB3.0的一部分<br>替代原有EJB2.X里面关于Entity Bean而成为EJB ORM的工具<br>这里解释一下ORM//OR-Mapping<br>中文名对象关系映射<br>什么意思呢？我们知道传统的数据库都是关系型的<br>一条条记录以表格的形式储存，而表与表之间充斥着是关系/关联<br>比如说一个人，名字zhaoce，性别男，年龄23那么数据库中是这么储存的<br>姓名 性别 年龄 zhaoce m  23 某女   f  22<br>而实际应用服务器中的实体都是以对象的形式存在，一个个对象<br>zhaoce是以这种形式存在的<br>Human human=new Human();<br>human.setName(“zhaoce”)<br>human.setSex(“m”);<br>human.setAge(23);<br>这样的，那么我们知道，传统的JDBC是通过一个二维字符串将数据取出<br>需要我们自己将其包装成对象，在存入的时候，我们还需要将对象拆开<br>放入sql语句中//Insert into Huamn values(‘zhaoce’,’m’,23)<br>然后执行该sql语句<br>太麻烦太麻烦，ORM理念的提出改变了这一切，ORM认为，这些东西应该由框架来做<br>而不是程序员，程序员做他该做的，不要为这种破事分心，还测试半天<br>于是就出现了Hibernate，JDO，TopLink等等，甚至.net里面也有ADO.net<br>过去一段时间是Hibernate和JDO争风，现在看来Hibernate逐渐成为主流并被官方接纳<br>成为规范标准之一，替代掉原来EJB2.X的ORM EntityBean<br>TopLink则是Oracle公司推出和Oracle数据库结合的一种ORM<br>商业用软件，贵且复杂，不过正在逐渐开放<br>而象表示层一样，这一种专门面对数据层的代码也被称为数据持久层<br>所以数据持久层这一概念有时不仅仅指代数据库<br>关于ORM，最高的境界应该是在java代码中不出现任何一句的sql语句<br>注意，是不包括sql语句，Hibernate的hql以及ejb的ejb-ql不算在内<br>至于出现不出现hql/ejb-ql等替代ql，这要视具体情况而定，不过最好也是不出现<br>当然最后所说的过分理想的情况往往不现实，总之一句话<br>以sql为代表的ql/<em>还有hql,ejbql等</em>/语句在代码中出现得越少越好<br>记住这话，现在未必能够理解，学了以后就懂了</p>
<p>这三个是目前最为常用的框架 而目前光已公布的框架就&gt;500<br>还在不停增加中，不可能一一列举，有兴趣的可以去看相应文档 要指出的是框架不是应用程序<br>只是一堆组件的有序复合，应用时不能脱离于应用服务器单独存在</p>
<h1 id="九：收尾"><a href="#九：收尾" class="headerlink" title="九：收尾"></a>九：收尾</h1><p>最后一篇介绍几个常见的概念</p>
<p>设计模式<br>这可不仅是java独有<br>我看的书就是c++和smalltalk例子的<br>先说说什么是设计模式<br>模式是什么？模式是经验的总结，潜规则的抽象<br>什么意思呢？比如说我们坐飞机，上飞机前需要经过几个步骤<br>什么安检领取登机牌之类的，这一套流程能不能改呢？<br>可以，但为什么几乎全世界的航空公司登机前都是这一套流程呢？<br>因为航空公司经过长期实践之后得出了一堆结论和经验<br>并认为这样做才是最安全，或说是最有效率的<br>这就是模式，模式是编程高手之间交流的桥梁<br>两个编程高手通过统一命名的模式了解对方的思想<br>当然不借助模式可不可以？当然可以，只是模式无处不在，你不知道而已<br>又比如吃饭，每吃一口饭，我们要先端碗，拿筷子，张嘴，塞饭入口，咀嚼最后吞咽<br>这就是一套模式，我们给这套模式命名为吃饭<br>那么当老爸叫吃饭的时候，我们就能明白什么意思<br>而不用老爸进来呓呓啊啊并比画上半天，哑语也不是这么用的<br>这就是模式，已知的模式有400多种//好象更多，不记得了<br>比如数据库有数据库的设计模式，编程有编程的模式等等<br>面向对象有常用的21种模式，需要掌握，主要分为创建，行为，结构三类<br>J2ee有J2ee的模式，Sun公司出了一本书叫《J2EE核心模式》可以拿来看看<br>必需要指明的是，模式不是规范，比如吃饭模式<br>没有人规定你吃饭非得要那么吃，你可以端碗，上抛，张嘴在下落后连碗一起吞咽<br>这也可以，只要你愿意，同样，只要你愿意，你就可以不遵循模式<br>模式之外还有反模式，学模式不可定势，不要学死，活学活用，无招胜有招才是最高境界</p>
<p>JavaDoc<br>文档工具，极其好用<br>可以根据注释自动生成HTML文档</p>
<p>Ant<br>98年，有一位程序员在从欧洲飞回美国的飞机上想到了这么一个东西<br>从而改变了整个世界，他的名字叫James Duncan Davidson<br>组织管理工具，可以这么描述它<br>比如你想在编译之后自动再次生成JavaDoc<br>那么你只需要编辑Ant脚本//对，就像Windows脚本那样<br>然后批处理就可以了，不过现在Ant已经广泛集成到IDE中去<br>不需要自己手动编写，不过如果想要炫炫，据说此招百试不爽</p>
<p>JUnit<br>测试工具，Unit家族可不只有JUnit<br>还有其它版本的，这个不细说，具体实践一下就明白了</p>
<p>POJO<br>//Plain Old Java Object<br>就是传统的Java对象，也就是一个JavaBean<br>由虚拟机来掌握其生死<br>常用的两个管理构架/规范是Spring和EJB容器<br>命名由来是某人//名字我忘了<br>觉得我们使用了太多的规范，以至于我们都忘记了纯粹的java对象<br>以至于我们都忽略了它的存在，所以叫了这么一个名字<br>以唤醒人们的记忆，这个意义上来说EJB其实不能算是POJO<br>毕竟遵循了一堆的接口，但是不管怎样，接口归接口，还是没有继承类<br>没有被强加什么//遵循可以写空方法假遵循<br>所以说还是POJO也对<br>但是由于这种东西缺乏管理，不象Servlet有专门的容器管理并继承了一定的类<br>而没有管理的对象在虚拟机中是很危险的，因为垃圾回收机制各个虚拟机不同<br>而且也不怎样，极有可能长时间不回收，这样在企业级的应用中呢<br>就有可能造成内存大量被占用从而死机，毫无疑问，这种机制需要优化<br>这种优化就是通过EJB容器或者Spring构架来实现<br>这么做还有一个好处就是迫使程序员对每一个类做封装<br>强迫他做管理，以达到防止内存泄露的目的，内存泄露最经常出现的错误就是<br>引用未释放，引用最典型体现在new这个关键字上，new得越多引用得越多<br>随着时间地增长，有可能导致循环，不停new new new new new…..<br>其中哪怕只要有一个new处理不当，虚拟机无法回收内存<br>那就极有可能完蛋，而且这种小bug越是在大的项目越是难以找到<br>有可能因为一个人而影响整个项目组，所以不妨记住我的一条经验<br>好的系统框架不应该在业务逻辑流程中出现new关键字<br>现在不理解也无所谓，将来有一天会明白的</p>
<p>SOA<br>面向服务的构架<br>不说太多，这个属于上上层建筑<br>不过不妨记住我的一句话，可以帮助理解这个概念<br>面向什么就是对什么做封装<br>面向对象就是对对象做封装<br>面向服务类似，剩下的靠悟性</p>
<p>反射<br>1.4新增功能，非常强大<br>通过反射，程序可以解析出类本身的属性也就是变量<br>//注意这里说的属性不是.net里面的属性，我不喜欢微软造的新名词，乱<br>还有行为也就是方法，然后通过invoke()方法调用该方法<br>甚至可以新增对象等，java首创，本是其它语言所没有的<br>后来被微软抄了去，利用该功能，开源框架广泛受益并大量采用，近乎疯狂地使用<br>具体就不说了，最后要指出的是，有一种说法是利用反射会降低效率<br>在早期的时候，的确是，现在不会了，放心使用</p>
<p>容器<br>5.0以后的版本在J2SE中都出现了容器<br>各位甚至可以自己尝试用标准库去使用容器</p>
<p>推荐网站<br><a href="http://www.javaeye.com" target="_blank" rel="noopener">www.javaeye.com</a> //java视线论坛，Hibernate国内的权威<br>dev2dev.bea.com //bea的dev2dev社区，用WebLogic首选的好去处<br>www-128.ibm.com/developerworks //ibm developer works社区，ibm产品的老家<br><a href="http://www.jdon.com" target="_blank" rel="noopener">www.jdon.com</a> //j道，Jboss国内相对讨论会多一点的地方，有自己的框架<br><a href="http://www.matrix.org.cn" target="_blank" rel="noopener">www.matrix.org.cn</a> //matrix，有自己的框架，很清新的论坛<br>jcp.org //JCP，前面说到过了<br>sourceforge.net //开源的东西几乎这里都可以找到，除java外还有游戏共享等<br>saloon.javaranch.com //我常去，人气不错<br><a href="http://www.apache.org" target="_blank" rel="noopener">www.apache.org</a> //阿帕奇老家<br><a href="http://www.jboss.com" target="_blank" rel="noopener">www.jboss.com</a> //Jboss和Hibernate老家<br><a href="http://www.springframework.org" target="_blank" rel="noopener">www.springframework.org</a> //Spring老家<br><a href="http://www.wiki.org" target="_blank" rel="noopener">www.wiki.org</a> //非常好的百科站点，可惜国内被封，创始人加入了Eclipse zone<br><a href="http://www.google.com" target="_blank" rel="noopener">www.google.com</a> //你要的这里有，不信？输入关键字再按一下那个靠左的白色按钮试试</p>
<p>书籍<br>《Thinking in Java》 //实话说，一般，尤其是翻译后的版本，原版还行<br>《Java教程》 //电子工业出版社出版的那本，上下册，很厚，但翻译得不错<br>《21天学通Java》 //入门极好，但是《21天学通j2ee》极烂，不要买<br>《Mastering EJB》 //翻译过的书质量我不清楚，估计不怎样，请看原版书籍<br>《精通Hibernate》 //看清楚作者，孙卫琴，其它人的别买</p>
<p>其它的可以不用了，网络上的远比书上来得多，来得好，虽然也来得杂</p>
<p>最后的建议<br>一，不要做一个浮躁的人<br>二，学好英语，很重要<br>三，阅读源代码和文档<br>四，共享源代码，不要做一个功利的人<br>五，热爱Java</p>
<hr>
<p>版权声明：本文为CSDN博主「phphot」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/phphot/article/details/2171421" target="_blank" rel="noopener">https://blog.csdn.net/phphot/article/details/2171421</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/07/python-cheatsheet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yuanchen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yuanchen's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/07/python-cheatsheet/" class="post-title-link" itemprop="url">python_cheatsheet</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-01-07 21:30:22 / Modified: 22:31:31" itemprop="dateCreated datePublished" datetime="2020-01-07T21:30:22-05:00">2020-01-07</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Contents"><a href="#Contents" class="headerlink" title="Contents"></a>Contents</h2><p><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>1. Collections:</strong> <strong>&nbsp;</strong> <strong><a href="#list"><code>List</code></a></strong><strong>,</strong> <strong><a href="#dictionary"><code>Dictionary</code></a></strong><strong>,</strong> <strong><a href="#set"><code>Set</code></a></strong><strong>,</strong> <strong><a href="#tuple"><code>Tuple</code></a></strong><strong>,</strong> <strong><a href="#range"><code>Range</code></a></strong><strong>,</strong> <strong><a href="#enumerate"><code>Enumerate</code></a></strong><strong>,</strong> <strong><a href="#iterator"><code>Iterator</code></a></strong><strong>,</strong> <strong><a href="#generator"><code>Generator</code></a></strong><strong>.</strong><br><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>2. Types:</strong> <strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>  <strong><a href="#type"><code>Type</code></a></strong><strong>,</strong> <strong><a href="#string"><code>String</code></a></strong><strong>,</strong> <strong><a href="#regex"><code>Regular_Exp</code></a></strong><strong>,</strong> <strong><a href="#format"><code>Format</code></a></strong><strong>,</strong> <strong><a href="#numbers"><code>Numbers</code></a></strong><strong>,</strong> <strong><a href="#combinatorics"><code>Combinatorics</code></a></strong><strong>,</strong> <strong><a href="#datetime"><code>Datetime</code></a></strong><strong>.</strong><br><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>3. Syntax:</strong> <strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>  <strong><a href="#arguments"><code>Args</code></a></strong><strong>,</strong> <strong><a href="#inline"><code>Inline</code></a></strong><strong>,</strong> <strong><a href="#closure"><code>Closure</code></a></strong><strong>,</strong> <strong><a href="#decorator"><code>Decorator</code></a></strong><strong>,</strong> <strong><a href="#class"><code>Class</code></a></strong><strong>,</strong> <strong><a href="#duck-types"><code>Duck_Types</code></a></strong><strong>,</strong> <strong><a href="#enum"><code>Enum</code></a></strong><strong>,</strong> <strong><a href="#exceptions"><code>Exceptions</code></a></strong><strong>.</strong><br><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>4. System:</strong> <strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>  <strong><a href="#print"><code>Print</code></a></strong><strong>,</strong> <strong><a href="#input"><code>Input</code></a></strong><strong>,</strong> <strong><a href="#command-line-arguments"><code>Command_Line_Arguments</code></a></strong><strong>,</strong> <strong><a href="#open"><code>Open</code></a></strong><strong>,</strong> <strong><a href="#path"><code>Path</code></a></strong><strong>,</strong> <strong><a href="#oscommands"><code>Command_Execution</code></a></strong><strong>.</strong><br><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>5. Data:</strong> <strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>  <strong><a href="#json"><code>JSON</code></a></strong><strong>,</strong> <strong><a href="#pickle"><code>Pickle</code></a></strong><strong>,</strong> <strong><a href="#csv"><code>CSV</code></a></strong><strong>,</strong> <strong><a href="#sqlite"><code>SQLite</code></a></strong><strong>,</strong> <strong><a href="#bytes"><code>Bytes</code></a></strong><strong>,</strong> <strong><a href="#struct"><code>Struct</code></a></strong><strong>,</strong> <strong><a href="#array"><code>Array</code></a></strong><strong>,</strong> <strong><a href="#memory-view"><code>MemoryView</code></a></strong><strong>,</strong> <strong><a href="#deque"><code>Deque</code></a></strong><strong>.</strong><br><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>6. Advanced:</strong> <strong>&nbsp;&nbsp;&nbsp;</strong>  <strong><a href="#threading"><code>Threading</code></a></strong><strong>,</strong> <strong><a href="#operator"><code>Operator</code></a></strong><strong>,</strong> <strong><a href="#introspection"><code>Introspection</code></a></strong><strong>,</strong> <strong><a href="#metaprograming"><code>Metaprograming</code></a></strong><strong>,</strong> <strong><a href="#eval"><code>Eval</code></a></strong><strong>,</strong> <strong><a href="#coroutine"><code>Coroutine</code></a></strong><strong>.</strong><br><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>7. Libraries:</strong> <strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>  <strong><a href="#progress-bar"><code>Progress_Bar</code></a></strong><strong>,</strong> <strong><a href="#plot"><code>Plot</code></a></strong><strong>,</strong> <strong><a href="#table"><code>Table</code></a></strong><strong>,</strong> <strong><a href="#curses"><code>Curses</code></a></strong><strong>,</strong> <strong><a href="#logging"><code>Logging</code></a></strong><strong>,</strong> <strong><a href="#scraping"><code>Scraping</code></a></strong><strong>,</strong> <strong><a href="#web"><code>Web</code></a></strong><strong>,</strong> <strong><a href="#profiling"><code>Profile</code></a></strong><strong>,</strong><br><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong> <strong><a href="#numpy"><code>NumPy</code></a></strong><strong>,</strong> <strong><a href="#image"><code>Image</code></a></strong><strong>,</strong> <strong><a href="#animation"><code>Animation</code></a></strong><strong>,</strong> <strong><a href="#audio"><code>Audio</code></a></strong><strong>.</strong></p>
<h2 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:     <span class="comment"># Runs main() if file wasn't imported.</span></span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>


<h2 id="List"><a href="#List" class="headerlink" title="List"></a>List</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;list&gt; = &lt;list&gt;[from_inclusive : to_exclusive : ±step_size]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;list&gt;.append(&lt;el&gt;)            <span class="comment"># Or: &lt;list&gt; += [&lt;el&gt;]</span></span><br><span class="line">&lt;list&gt;.extend(&lt;collection&gt;)    <span class="comment"># Or: &lt;list&gt; += &lt;collection&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;list&gt;.sort()</span><br><span class="line">&lt;list&gt;.reverse()</span><br><span class="line">&lt;list&gt; = sorted(&lt;collection&gt;)</span><br><span class="line">&lt;iter&gt; = reversed(&lt;list&gt;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sum_of_elements  = sum(&lt;collection&gt;)</span><br><span class="line">elementwise_sum  = [sum(pair) <span class="keyword">for</span> pair <span class="keyword">in</span> zip(list_a, list_b)]</span><br><span class="line">sorted_by_second = sorted(&lt;collection&gt;, key=<span class="keyword">lambda</span> el: el[<span class="number">1</span>])</span><br><span class="line">sorted_by_both   = sorted(&lt;collection&gt;, key=<span class="keyword">lambda</span> el: (el[<span class="number">1</span>], el[<span class="number">0</span>]))</span><br><span class="line">flatter_list     = list(itertools.chain.from_iterable(&lt;list&gt;))</span><br><span class="line">product_of_elems = functools.reduce(<span class="keyword">lambda</span> out, x: out * x, &lt;collection&gt;)</span><br><span class="line">list_of_chars    = list(&lt;str&gt;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;int&gt; = &lt;list&gt;.count(&lt;el&gt;)     <span class="comment"># Returns number of occurrences. Also works on strings.</span></span><br><span class="line">index = &lt;list&gt;.index(&lt;el&gt;)     <span class="comment"># Returns index of first occurrence or raises ValueError.</span></span><br><span class="line">&lt;list&gt;.insert(index, &lt;el&gt;)     <span class="comment"># Inserts item at index and moves the rest to the right.</span></span><br><span class="line">&lt;el&gt; = &lt;list&gt;.pop([index])     <span class="comment"># Removes and returns item at index or from the end.</span></span><br><span class="line">&lt;list&gt;.remove(&lt;el&gt;)            <span class="comment"># Removes first occurrence of item or raises ValueError.</span></span><br><span class="line">&lt;list&gt;.clear()                 <span class="comment"># Removes all items. Also works on dictionary and set.</span></span><br></pre></td></tr></table></figure>


<h2 id="Dictionary"><a href="#Dictionary" class="headerlink" title="Dictionary"></a>Dictionary</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view&gt; = &lt;dict&gt;.keys()                          <span class="comment"># Coll. of keys that reflects changes.</span></span><br><span class="line">&lt;view&gt; = &lt;dict&gt;.values()                        <span class="comment"># Coll. of values that reflects changes.</span></span><br><span class="line">&lt;view&gt; = &lt;dict&gt;.items()                         <span class="comment"># Coll. of key-value tuples that reflects chgs.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">value  = &lt;dict&gt;.get(key, default=<span class="literal">None</span>)          <span class="comment"># Returns default if key is missing.</span></span><br><span class="line">value  = &lt;dict&gt;.setdefault(key, default=<span class="literal">None</span>)   <span class="comment"># Returns and writes default if key is missing.</span></span><br><span class="line">&lt;dict&gt; = collections.defaultdict(&lt;type&gt;)        <span class="comment"># Creates a dict with default value of type.</span></span><br><span class="line">&lt;dict&gt; = collections.defaultdict(<span class="keyword">lambda</span>: <span class="number">1</span>)     <span class="comment"># Creates a dict with default value 1.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;dict&gt; = dict(&lt;collection&gt;)                     <span class="comment"># Creates a dict from coll. of key-value pairs.</span></span><br><span class="line">&lt;dict&gt; = dict(zip(keys, values))                <span class="comment"># Creates a dict from two collections.</span></span><br><span class="line">&lt;dict&gt; = dict.fromkeys(keys [, value])          <span class="comment"># Creates a dict from collection of keys.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dict&gt;.update(&lt;dict&gt;)                           <span class="comment"># Adds items. Replaces ones with matching keys.</span></span><br><span class="line">value = &lt;dict&gt;.pop(key)                         <span class="comment"># Removes item or raises KeyError.</span></span><br><span class="line">&#123;k <span class="keyword">for</span> k, v <span class="keyword">in</span> &lt;dict&gt;.items() <span class="keyword">if</span> v == value&#125;    <span class="comment"># Returns set of keys that point to the value.</span></span><br><span class="line">&#123;k: v <span class="keyword">for</span> k, v <span class="keyword">in</span> &lt;dict&gt;.items() <span class="keyword">if</span> k <span class="keyword">in</span> keys&#125;  <span class="comment"># Returns dictionary filtered by keys.</span></span><br></pre></td></tr></table></figure>

<h3 id="Counter"><a href="#Counter" class="headerlink" title="Counter"></a>Counter</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>colors = [<span class="string">'blue'</span>, <span class="string">'red'</span>, <span class="string">'blue'</span>, <span class="string">'red'</span>, <span class="string">'blue'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter = Counter(colors)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter[<span class="string">'yellow'</span>] += <span class="number">1</span></span><br><span class="line">Counter(&#123;<span class="string">'blue'</span>: <span class="number">3</span>, <span class="string">'red'</span>: <span class="number">2</span>, <span class="string">'yellow'</span>: <span class="number">1</span>&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter.most_common()[<span class="number">0</span>]</span><br><span class="line">(<span class="string">'blue'</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;set&gt; = set()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;set&gt;.add(&lt;el&gt;)                                 <span class="comment"># Or: &lt;set&gt; |= &#123;&lt;el&gt;&#125;</span></span><br><span class="line">&lt;set&gt;.update(&lt;collection&gt;)                      <span class="comment"># Or: &lt;set&gt; |= &lt;set&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;set&gt;  = &lt;set&gt;.union(&lt;coll.&gt;)                   <span class="comment"># Or: &lt;set&gt; | &lt;set&gt;</span></span><br><span class="line">&lt;set&gt;  = &lt;set&gt;.intersection(&lt;coll.&gt;)            <span class="comment"># Or: &lt;set&gt; &amp; &lt;set&gt;</span></span><br><span class="line">&lt;set&gt;  = &lt;set&gt;.difference(&lt;coll.&gt;)              <span class="comment"># Or: &lt;set&gt; - &lt;set&gt;</span></span><br><span class="line">&lt;set&gt;  = &lt;set&gt;.symmetric_difference(&lt;coll.&gt;)    <span class="comment"># Or: &lt;set&gt; ^ &lt;set&gt;</span></span><br><span class="line">&lt;bool&gt; = &lt;set&gt;.issubset(&lt;coll.&gt;)                <span class="comment"># Or: &lt;set&gt; &lt;= &lt;set&gt;</span></span><br><span class="line">&lt;bool&gt; = &lt;set&gt;.issuperset(&lt;coll.&gt;)              <span class="comment"># Or: &lt;set&gt; &gt;= &lt;set&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;el&gt; = &lt;set&gt;.pop()                              <span class="comment"># Raises KeyError if empty.</span></span><br><span class="line">&lt;set&gt;.remove(&lt;el&gt;)                              <span class="comment"># Raises KeyError if missing.</span></span><br><span class="line">&lt;set&gt;.discard(&lt;el&gt;)                             <span class="comment"># Doesn't raise an error.</span></span><br></pre></td></tr></table></figure>

<h3 id="Frozen-Set"><a href="#Frozen-Set" class="headerlink" title="Frozen Set"></a>Frozen Set</h3><ul>
<li><strong>Is immutable and hashable.</strong></li>
<li><strong>That means it can be used as a key in a dictionary or as an element in a set.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;frozenset&gt; = frozenset(&lt;collection&gt;)</span><br></pre></td></tr></table></figure>


<h2 id="Tuple"><a href="#Tuple" class="headerlink" title="Tuple"></a>Tuple</h2><p><strong>Tuple is an immutable and hashable list.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;tuple&gt; = ()</span><br><span class="line">&lt;tuple&gt; = (&lt;el&gt;, )</span><br><span class="line">&lt;tuple&gt; = (&lt;el_1&gt;, &lt;el_2&gt; [, ...])</span><br></pre></td></tr></table></figure>

<h3 id="Named-Tuple"><a href="#Named-Tuple" class="headerlink" title="Named Tuple"></a>Named Tuple</h3><p><strong>Tuple’s subclass with named elements.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Point = namedtuple(<span class="string">'Point'</span>, <span class="string">'x y'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = Point(<span class="number">1</span>, y=<span class="number">2</span>)</span><br><span class="line">Point(x=<span class="number">1</span>, y=<span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p[<span class="number">0</span>]</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.x</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>getattr(p, <span class="string">'y'</span>)</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p._fields  <span class="comment"># Or: Point._fields</span></span><br><span class="line">(<span class="string">'x'</span>, <span class="string">'y'</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Range"><a href="#Range" class="headerlink" title="Range"></a>Range</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;range&gt; = range(to_exclusive)</span><br><span class="line">&lt;range&gt; = range(from_inclusive, to_exclusive)</span><br><span class="line">&lt;range&gt; = range(from_inclusive, to_exclusive, ±step_size)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">from_inclusive = &lt;range&gt;.start</span><br><span class="line">to_exclusive   = &lt;range&gt;.stop</span><br></pre></td></tr></table></figure>


<h2 id="Enumerate"><a href="#Enumerate" class="headerlink" title="Enumerate"></a>Enumerate</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i, el <span class="keyword">in</span> enumerate(&lt;collection&gt; [, i_start]):</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>


<h2 id="Iterator"><a href="#Iterator" class="headerlink" title="Iterator"></a>Iterator</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;iter&gt; = iter(&lt;collection&gt;)                 <span class="comment"># `iter(&lt;iter&gt;)` returns unmodified iterator.</span></span><br><span class="line">&lt;iter&gt; = iter(&lt;function&gt;, to_exclusive)     <span class="comment"># A sequence of return values until 'to_exclusive'.</span></span><br><span class="line">&lt;el&gt;   = next(&lt;iter&gt; [, default])           <span class="comment"># Raises StopIteration or returns 'default' on end.</span></span><br><span class="line">&lt;list&gt; = list(&lt;iter&gt;)                       <span class="comment"># Returns a list of iterator's remaining elements.</span></span><br></pre></td></tr></table></figure>


<h3 id="Itertools"><a href="#Itertools" class="headerlink" title="Itertools"></a>Itertools</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> count, repeat, cycle, chain, islice</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;iter&gt; = count(start=<span class="number">0</span>, step=<span class="number">1</span>)             <span class="comment"># Returns incremented value endlessly.</span></span><br><span class="line">&lt;iter&gt; = repeat(&lt;el&gt; [, times])             <span class="comment"># Returns element endlessly or 'times' times.</span></span><br><span class="line">&lt;iter&gt; = cycle(&lt;collection&gt;)                <span class="comment"># Repeats the sequence endlessly.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;iter&gt; = chain(&lt;coll_1&gt;, &lt;coll_2&gt; [, ...])  <span class="comment"># Empties collections in order.</span></span><br><span class="line">&lt;iter&gt; = chain.from_iterable(&lt;collection&gt;)  <span class="comment"># Empties collections inside a collection in order.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;iter&gt; = islice(&lt;collection&gt;, to_exclusive)</span><br><span class="line">&lt;iter&gt; = islice(&lt;collection&gt;, from_inclusive, to_exclusive [, +step_size])</span><br></pre></td></tr></table></figure>


<h2 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h2><ul>
<li><strong>Any function that contains a yield statement returns a generator.</strong></li>
<li><strong>Generators and iterators are interchangeable.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span><span class="params">(start, step)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">yield</span> start</span><br><span class="line">        start += step</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter = count(<span class="number">10</span>, <span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>next(counter), next(counter), next(counter)</span><br><span class="line">(<span class="number">10</span>, <span class="number">12</span>, <span class="number">14</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Type"><a href="#Type" class="headerlink" title="Type"></a>Type</h2><ul>
<li><strong>Everything is an object.</strong></li>
<li><strong>Every object has a type.</strong></li>
<li><strong>Type and class are synonymous.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;type&gt; = type(&lt;el&gt;)                          <span class="comment"># Or: &lt;el&gt;.__class__</span></span><br><span class="line">&lt;bool&gt; = isinstance(&lt;el&gt;, &lt;type&gt;)            <span class="comment"># Or: issubclass(type(&lt;el&gt;), &lt;type&gt;)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(<span class="string">'a'</span>), <span class="string">'a'</span>.__class__, str</span><br><span class="line">(&lt;class 'str'&gt;, &lt;class 'str'&gt;, &lt;class 'str'&gt;)</span><br></pre></td></tr></table></figure>

<h4 id="Some-types-do-not-have-built-in-names-so-they-must-be-imported"><a href="#Some-types-do-not-have-built-in-names-so-they-must-be-imported" class="headerlink" title="Some types do not have built-in names, so they must be imported:"></a>Some types do not have built-in names, so they must be imported:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> types <span class="keyword">import</span> FunctionType, MethodType, LambdaType, GeneratorType</span><br></pre></td></tr></table></figure>

<h3 id="ABC"><a href="#ABC" class="headerlink" title="ABC"></a>ABC</h3><p><strong>An abstract base class introduces virtual subclasses, that don’t inherit from it but are still recognized by isinstance() and issubclass().</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections.abc <span class="keyword">import</span> Sequence, Collection, Iterable</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], Iterable)</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+------------------+------------+------------+------------+</span><br><span class="line">|                  |  Sequence  | Collection |  Iterable  |</span><br><span class="line">+------------------+------------+------------+------------+</span><br><span class="line">| list, range, str |    yes     |    yes     |    yes     |</span><br><span class="line">| dict, set        |            |    yes     |    yes     |</span><br><span class="line">| iter             |            |            |    yes     |</span><br><span class="line">+------------------+------------+------------+------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> numbers <span class="keyword">import</span> Integral, Rational, Real, Complex, Number</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(<span class="number">123</span>, Number)</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+--------------------+----------+----------+----------+----------+----------+</span><br><span class="line">|                    | Integral | Rational |   Real   | Complex  |  Number  |</span><br><span class="line">+--------------------+----------+----------+----------+----------+----------+</span><br><span class="line">| int                |   yes    |   yes    |   yes    |   yes    |   yes    |</span><br><span class="line">| fractions.Fraction |          |   yes    |   yes    |   yes    |   yes    |</span><br><span class="line">| float              |          |          |   yes    |   yes    |   yes    |</span><br><span class="line">| complex            |          |          |          |   yes    |   yes    |</span><br><span class="line">| decimal.Decimal    |          |          |          |          |   yes    |</span><br><span class="line">+--------------------+----------+----------+----------+----------+----------+</span><br></pre></td></tr></table></figure>


<h2 id="String"><a href="#String" class="headerlink" title="String"></a>String</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;str&gt;  = &lt;str&gt;.strip()                       <span class="comment"># Strips all whitespace characters from both ends.</span></span><br><span class="line">&lt;str&gt;  = &lt;str&gt;.strip(<span class="string">'&lt;chars&gt;'</span>)              <span class="comment"># Strips all passed characters from both ends.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;list&gt; = &lt;str&gt;.split()                       <span class="comment"># Splits on one or more whitespace characters.</span></span><br><span class="line">&lt;list&gt; = &lt;str&gt;.split(sep=<span class="literal">None</span>, maxsplit=<span class="number">-1</span>)  <span class="comment"># Splits on 'sep' str at most 'maxsplit' times.</span></span><br><span class="line">&lt;list&gt; = &lt;str&gt;.splitlines(keepends=<span class="literal">False</span>)    <span class="comment"># Splits on line breaks. Keeps them if 'keepends'.</span></span><br><span class="line">&lt;str&gt;  = &lt;str&gt;.join(&lt;coll_of_strings&gt;)       <span class="comment"># Joins elements using string as separator.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;bool&gt; = &lt;sub_str&gt; <span class="keyword">in</span> &lt;str&gt;                  <span class="comment"># Checks if string contains a substring.</span></span><br><span class="line">&lt;bool&gt; = &lt;str&gt;.startswith(&lt;sub_str&gt;)         <span class="comment"># Pass tuple of strings for multiple options.</span></span><br><span class="line">&lt;bool&gt; = &lt;str&gt;.endswith(&lt;sub_str&gt;)           <span class="comment"># Pass tuple of strings for multiple options.</span></span><br><span class="line">&lt;int&gt;  = &lt;str&gt;.find(&lt;sub_str&gt;)               <span class="comment"># Returns start index of first match or -1.</span></span><br><span class="line">&lt;int&gt;  = &lt;str&gt;.index(&lt;sub_str&gt;)              <span class="comment"># Same but raises ValueError if missing.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;str&gt;  = &lt;str&gt;.replace(old, new [, count])   <span class="comment"># Replaces 'old' with 'new' at most 'count' times.</span></span><br><span class="line">&lt;str&gt;  = &lt;str&gt;.translate(&lt;table&gt;)            <span class="comment"># Use `str.maketrans(&lt;dict&gt;)` to generate table.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;str&gt;  = chr(&lt;int&gt;)                          <span class="comment"># Converts int to unicode char.</span></span><br><span class="line">&lt;int&gt;  = ord(&lt;str&gt;)                          <span class="comment"># Converts unicode char to int.</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Also: <code>&#39;lstrip()&#39;</code>, <code>&#39;rstrip()&#39;</code>.</strong></li>
<li><strong>Also: <code>&#39;lower()&#39;</code>, <code>&#39;upper()&#39;</code>, <code>&#39;capitalize()&#39;</code> and <code>&#39;title()&#39;</code>.</strong></li>
</ul>
<h3 id="Property-Methods"><a href="#Property-Methods" class="headerlink" title="Property Methods"></a>Property Methods</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+---------------+----------+----------+----------+----------+----------+</span><br><span class="line">|               | [ !#$%…] | [a-zA-Z] |  [¼½¾]   |  [²³¹]   |  [0-9]   |</span><br><span class="line">+---------------+----------+----------+----------+----------+----------+</span><br><span class="line">| isprintable() |   yes    |   yes    |   yes    |   yes    |   yes    |</span><br><span class="line">| isalnum()     |          |   yes    |   yes    |   yes    |   yes    |</span><br><span class="line">| isnumeric()   |          |          |   yes    |   yes    |   yes    |</span><br><span class="line">| isdigit()     |          |          |          |   yes    |   yes    |</span><br><span class="line">| isdecimal()   |          |          |          |          |   yes    |</span><br><span class="line">+---------------+----------+----------+----------+----------+----------+</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Also: <code>&#39;isspace()&#39;</code> checks for <code>&#39;[ \t\n\r\f\v…]&#39;</code>.</strong></li>
</ul>
<h2 id="Regex"><a href="#Regex" class="headerlink" title="Regex"></a>Regex</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">&lt;str&gt;   = re.sub(&lt;regex&gt;, new, text, count=<span class="number">0</span>)  <span class="comment"># Substitutes all occurrences with 'new'.</span></span><br><span class="line">&lt;list&gt;  = re.findall(&lt;regex&gt;, text)            <span class="comment"># Returns all occurrences as strings.</span></span><br><span class="line">&lt;list&gt;  = re.split(&lt;regex&gt;, text, maxsplit=<span class="number">0</span>)  <span class="comment"># Use brackets in regex to keep the matches.</span></span><br><span class="line">&lt;Match&gt; = re.search(&lt;regex&gt;, text)             <span class="comment"># Searches for first occurrence of the pattern.</span></span><br><span class="line">&lt;Match&gt; = re.match(&lt;regex&gt;, text)              <span class="comment"># Searches only at the beginning of the text.</span></span><br><span class="line">&lt;iter&gt;  = re.finditer(&lt;regex&gt;, text)           <span class="comment"># Returns all occurrences as match objects.</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Search() and match() return None if they can’t find a match.</strong></li>
<li><strong>Argument <code>&#39;flags=re.IGNORECASE&#39;</code> can be used with all functions.</strong></li>
<li><strong>Argument <code>&#39;flags=re.MULTILINE&#39;</code> makes <code>&#39;^&#39;</code> and <code>&#39;$&#39;</code> match the start/end of each line.</strong></li>
<li><strong>Argument <code>&#39;flags=re.DOTALL&#39;</code> makes dot also accept newline.</strong></li>
<li><strong>Use <code>r&#39;\1&#39;</code> or <code>&#39;\\1&#39;</code> for backreference.</strong></li>
<li><strong>Add <code>&#39;?&#39;</code> after an operator to make it non-greedy.</strong></li>
</ul>
<h3 id="Match-Object"><a href="#Match-Object" class="headerlink" title="Match Object"></a>Match Object</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;str&gt;   = &lt;Match&gt;.group()                      <span class="comment"># Returns whole match. Also group(0).</span></span><br><span class="line">&lt;str&gt;   = &lt;Match&gt;.group(<span class="number">1</span>)                     <span class="comment"># Returns part in first bracket.</span></span><br><span class="line">&lt;tuple&gt; = &lt;Match&gt;.groups()                     <span class="comment"># Returns all bracketed parts.</span></span><br><span class="line">&lt;int&gt;   = &lt;Match&gt;.start()                      <span class="comment"># Returns start index of a match.</span></span><br><span class="line">&lt;int&gt;   = &lt;Match&gt;.end()                        <span class="comment"># Returns exclusive end index of a match.</span></span><br></pre></td></tr></table></figure>

<h3 id="Special-Sequences"><a href="#Special-Sequences" class="headerlink" title="Special Sequences"></a>Special Sequences</h3><ul>
<li><strong>By default digits, whitespaces and alphanumerics from all alphabets are matched, unless <code>&#39;flags=re.ASCII&#39;</code> argument is used.</strong></li>
<li><strong>Use capital letter for negation.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'\d'</span> == <span class="string">'[0-9]'</span>                                <span class="comment"># Matches any digit.</span></span><br><span class="line"><span class="string">'\w'</span> == <span class="string">'[a-zA-Z0-9_]'</span>                         <span class="comment"># Matches any alphanumeric.</span></span><br><span class="line"><span class="string">'\s'</span> == <span class="string">'[ \t\n\r\f\v]'</span>                        <span class="comment"># Matches any whitespace.</span></span><br></pre></td></tr></table></figure>


<h2 id="Format"><a href="#Format" class="headerlink" title="Format"></a>Format</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;str&gt; = <span class="string">f'<span class="subst">&#123;&lt;el_1&gt;&#125;</span>, <span class="subst">&#123;&lt;el_2&gt;&#125;</span>'</span></span><br><span class="line">&lt;str&gt; = <span class="string">'&#123;&#125;, &#123;&#125;'</span>.format(&lt;el_1&gt;, &lt;el_2&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="Attributes"><a href="#Attributes" class="headerlink" title="Attributes"></a>Attributes</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Person = namedtuple(<span class="string">'Person'</span>, <span class="string">'name height'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>person = Person(<span class="string">'Jean-Luc'</span>, <span class="number">187</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">f'<span class="subst">&#123;person.height&#125;</span>'</span></span><br><span class="line"><span class="string">'187'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;p.height&#125;'</span>.format(p=person)</span><br><span class="line"><span class="string">'187'</span></span><br></pre></td></tr></table></figure>

<h3 id="General-Options"><a href="#General-Options" class="headerlink" title="General Options"></a>General Options</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&lt;el&gt;:&lt;<span class="number">10</span>&#125;                                     <span class="comment"># '&lt;el&gt;      '</span></span><br><span class="line">&#123;&lt;el&gt;:^<span class="number">10</span>&#125;                                     <span class="comment"># '   &lt;el&gt;   '</span></span><br><span class="line">&#123;&lt;el&gt;:&gt;<span class="number">10</span>&#125;                                     <span class="comment"># '      &lt;el&gt;'</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&lt;el&gt;:.&lt;<span class="number">10</span>&#125;                                    <span class="comment"># '&lt;el&gt;......'</span></span><br><span class="line">&#123;&lt;el&gt;:&lt;<span class="number">0</span>&#125;                                      <span class="comment"># '&lt;el&gt;'</span></span><br></pre></td></tr></table></figure>

<h3 id="Strings"><a href="#Strings" class="headerlink" title="Strings"></a>Strings</h3><p><strong><code>&#39;!r&#39;</code> calls object’s <a href="#class">repr()</a> method, instead of <a href="#class">str()</a>, to get a string.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">'abcde'</span>!r:&lt;<span class="number">10</span>&#125;                                <span class="comment"># "'abcde'   "</span></span><br><span class="line">&#123;<span class="string">'abcde'</span>:<span class="number">.3</span>&#125;                                   <span class="comment"># 'abc'</span></span><br><span class="line">&#123;<span class="string">'abcde'</span>:<span class="number">10.3</span>&#125;                                 <span class="comment"># 'abc       '</span></span><br></pre></td></tr></table></figure>

<h3 id="Numbers"><a href="#Numbers" class="headerlink" title="Numbers"></a>Numbers</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="number">123456</span>:<span class="number">10</span>,&#125;                                  <span class="comment"># '   123,456'</span></span><br><span class="line">&#123; <span class="number">123456</span>:<span class="number">10</span>_&#125;                                  <span class="comment"># '   123_456'</span></span><br><span class="line">&#123; <span class="number">123456</span>:+<span class="number">10</span>&#125;                                  <span class="comment"># '   +123456'</span></span><br><span class="line">&#123;<span class="number">-123456</span>:=<span class="number">10</span>&#125;                                  <span class="comment"># '-   123456'</span></span><br><span class="line">&#123; <span class="number">123456</span>: &#125;                                    <span class="comment"># ' 123456'</span></span><br><span class="line">&#123;<span class="number">-123456</span>: &#125;                                    <span class="comment"># '-123456'</span></span><br></pre></td></tr></table></figure>

<h3 id="Floats"><a href="#Floats" class="headerlink" title="Floats"></a>Floats</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="number">1.23456</span>:<span class="number">10.3</span>&#125;                                 <span class="comment"># '      1.23'</span></span><br><span class="line">&#123;<span class="number">1.23456</span>:<span class="number">10.3</span>f&#125;                                <span class="comment"># '     1.235'</span></span><br><span class="line">&#123;<span class="number">1.23456</span>:<span class="number">10.3</span>e&#125;                                <span class="comment"># ' 1.235e+00'</span></span><br><span class="line">&#123;<span class="number">1.23456</span>:<span class="number">10.3</span>%&#125;                                <span class="comment"># '  123.456%'</span></span><br></pre></td></tr></table></figure>

<h4 id="Comparison-of-float-presentation-types"><a href="#Comparison-of-float-presentation-types" class="headerlink" title="Comparison of float presentation types:"></a>Comparison of float presentation types:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">+---------------+-----------------+-----------------+-----------------+-----------------+</span><br><span class="line">|               |    &#123;&lt;float&gt;&#125;    |   &#123;&lt;float&gt;:f&#125;   |   &#123;&lt;float&gt;:e&#125;   |   &#123;&lt;float&gt;:%&#125;   |</span><br><span class="line">+---------------+-----------------+-----------------+-----------------+-----------------+</span><br><span class="line">|   0.000056789 |    &#39;5.6789e-05&#39; |     &#39;0.000057&#39;  |  &#39;5.678900e-05&#39; |     &#39;0.005679%&#39; |</span><br><span class="line">|   0.00056789  |    &#39;0.00056789&#39; |     &#39;0.000568&#39;  |  &#39;5.678900e-04&#39; |     &#39;0.056789%&#39; |</span><br><span class="line">|   0.0056789   |    &#39;0.0056789&#39;  |     &#39;0.005679&#39;  |  &#39;5.678900e-03&#39; |     &#39;0.567890%&#39; |</span><br><span class="line">|   0.056789    |    &#39;0.056789&#39;   |     &#39;0.056789&#39;  |  &#39;5.678900e-02&#39; |     &#39;5.678900%&#39; |</span><br><span class="line">|   0.56789     |    &#39;0.56789&#39;    |     &#39;0.567890&#39;  |  &#39;5.678900e-01&#39; |    &#39;56.789000%&#39; |</span><br><span class="line">|   5.6789      |    &#39;5.6789&#39;     |     &#39;5.678900&#39;  |  &#39;5.678900e+00&#39; |   &#39;567.890000%&#39; |</span><br><span class="line">|  56.789       |   &#39;56.789&#39;      |    &#39;56.789000&#39;  |  &#39;5.678900e+01&#39; |  &#39;5678.900000%&#39; |</span><br><span class="line">| 567.89        |  &#39;567.89&#39;       |   &#39;567.890000&#39;  |  &#39;5.678900e+02&#39; | &#39;56789.000000%&#39; |</span><br><span class="line">+---------------+-----------------+-----------------+-----------------+-----------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">+---------------+-----------------+-----------------+-----------------+-----------------+</span><br><span class="line">|               |   &#123;&lt;float&gt;:.2&#125;  |  &#123;&lt;float&gt;:.2f&#125;  |  &#123;&lt;float&gt;:.2e&#125;  |  &#123;&lt;float&gt;:.2%&#125;  |</span><br><span class="line">+---------------+-----------------+-----------------+-----------------+-----------------+</span><br><span class="line">|   0.000056789 |    &#39;5.7e-05&#39;    |       &#39;0.00&#39;    |    &#39;5.68e-05&#39;   |       &#39;0.01%&#39;   |</span><br><span class="line">|   0.00056789  |    &#39;0.00057&#39;    |       &#39;0.00&#39;    |    &#39;5.68e-04&#39;   |       &#39;0.06%&#39;   |</span><br><span class="line">|   0.0056789   |    &#39;0.0057&#39;     |       &#39;0.01&#39;    |    &#39;5.68e-03&#39;   |       &#39;0.57%&#39;   |</span><br><span class="line">|   0.056789    |    &#39;0.057&#39;      |       &#39;0.06&#39;    |    &#39;5.68e-02&#39;   |       &#39;5.68%&#39;   |</span><br><span class="line">|   0.56789     |    &#39;0.57&#39;       |       &#39;0.57&#39;    |    &#39;5.68e-01&#39;   |      &#39;56.79%&#39;   |</span><br><span class="line">|   5.6789      |    &#39;5.7&#39;        |       &#39;5.68&#39;    |    &#39;5.68e+00&#39;   |     &#39;567.89%&#39;   |</span><br><span class="line">|  56.789       |    &#39;5.7e+01&#39;    |      &#39;56.79&#39;    |    &#39;5.68e+01&#39;   |    &#39;5678.90%&#39;   |</span><br><span class="line">| 567.89        |    &#39;5.7e+02&#39;    |     &#39;567.89&#39;    |    &#39;5.68e+02&#39;   |   &#39;56789.00%&#39;   |</span><br><span class="line">+---------------+-----------------+-----------------+-----------------+-----------------+</span><br></pre></td></tr></table></figure>

<h3 id="Ints"><a href="#Ints" class="headerlink" title="Ints"></a>Ints</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="number">90</span>:c&#125;                                <span class="comment"># 'Z'</span></span><br><span class="line">&#123;<span class="number">90</span>:b&#125;                                <span class="comment"># '1011010'</span></span><br><span class="line">&#123;<span class="number">90</span>:X&#125;                                <span class="comment"># '5A'</span></span><br></pre></td></tr></table></figure>


<h2 id="Numbers-1"><a href="#Numbers-1" class="headerlink" title="Numbers"></a>Numbers</h2><h3 id="Types"><a href="#Types" class="headerlink" title="Types"></a>Types</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;int&gt;      = int(&lt;float/str/bool&gt;)    <span class="comment"># Or: math.floor(&lt;float&gt;)</span></span><br><span class="line">&lt;float&gt;    = float(&lt;int/str/bool&gt;)    <span class="comment"># Or: &lt;real&gt;e±&lt;int&gt;</span></span><br><span class="line">&lt;complex&gt;  = complex(real=<span class="number">0</span>, imag=<span class="number">0</span>)  <span class="comment"># Or: &lt;real&gt; ± &lt;real&gt;j</span></span><br><span class="line">&lt;Fraction&gt; = fractions.Fraction(numerator=<span class="number">0</span>, denominator=<span class="number">1</span>)</span><br><span class="line">&lt;Decimal&gt;  = decimal.Decimal(&lt;str/int/float&gt;)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>&#39;int(&lt;str&gt;)&#39;</code> and <code>&#39;float(&lt;str&gt;)&#39;</code> raise ValueError on malformed strings.</strong></li>
<li><strong>Decimal numbers can be represented exactly, unlike floats where <code>&#39;1.1 + 2.2 != 3.3&#39;</code>.</strong></li>
<li><strong>Precision of decimal operations is set with: <code>&#39;decimal.getcontext().prec = &lt;int&gt;&#39;</code>.</strong></li>
</ul>
<h3 id="Basic-Functions"><a href="#Basic-Functions" class="headerlink" title="Basic Functions"></a>Basic Functions</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;num&gt; = pow(&lt;num&gt;, &lt;num&gt;)             <span class="comment"># Or: &lt;num&gt; ** &lt;num&gt;</span></span><br><span class="line">&lt;num&gt; = abs(&lt;num&gt;)                    <span class="comment"># &lt;float&gt; = abs(&lt;complex&gt;)</span></span><br><span class="line">&lt;num&gt; = round(&lt;num&gt; [, ±ndigits])     <span class="comment"># `round(126, -1) == 130`</span></span><br></pre></td></tr></table></figure>

<h3 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> e, pi, inf, nan</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> cos, acos, sin, asin, tan, atan, degrees, radians</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log, log10, log2</span><br></pre></td></tr></table></figure>

<h3 id="Statistics"><a href="#Statistics" class="headerlink" title="Statistics"></a>Statistics</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> statistics <span class="keyword">import</span> mean, median, variance, pvariance, pstdev</span><br></pre></td></tr></table></figure>

<h3 id="Random"><a href="#Random" class="headerlink" title="Random"></a>Random</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> random, randint, choice, shuffle</span><br><span class="line">&lt;float&gt; = random()</span><br><span class="line">&lt;int&gt;   = randint(from_inclusive, to_inclusive)</span><br><span class="line">&lt;el&gt;    = choice(&lt;list&gt;)</span><br><span class="line">shuffle(&lt;list&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="Bin-Hex"><a href="#Bin-Hex" class="headerlink" title="Bin, Hex"></a>Bin, Hex</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;int&gt;     = <span class="number">0</span>b&lt;bin&gt;                   <span class="comment"># Or: 0x&lt;hex&gt;</span></span><br><span class="line">&lt;int&gt;     = int(<span class="string">'&lt;bin&gt;'</span>, <span class="number">2</span>)           <span class="comment"># Or: int('&lt;hex&gt;', 16)</span></span><br><span class="line">&lt;int&gt;     = int(<span class="string">'0b&lt;bin&gt;'</span>, <span class="number">0</span>)         <span class="comment"># Or: int('0x&lt;hex&gt;', 0)</span></span><br><span class="line"><span class="string">'0b&lt;bin&gt;'</span> = bin(&lt;int&gt;)                <span class="comment"># Or: '0x&lt;hex&gt;' = hex(&lt;int&gt;)</span></span><br></pre></td></tr></table></figure>

<h3 id="Bitwise-Operators"><a href="#Bitwise-Operators" class="headerlink" title="Bitwise Operators"></a>Bitwise Operators</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;int&gt;     = &lt;int&gt; &amp; &lt;int&gt;             <span class="comment"># And</span></span><br><span class="line">&lt;int&gt;     = &lt;int&gt; | &lt;int&gt;             <span class="comment"># Or</span></span><br><span class="line">&lt;int&gt;     = &lt;int&gt; ^ &lt;int&gt;             <span class="comment"># Xor (0 if both bits equal)</span></span><br><span class="line">&lt;int&gt;     = &lt;int&gt; &lt;&lt; n_bits           <span class="comment"># Shift left</span></span><br><span class="line">&lt;int&gt;     = &lt;int&gt; &gt;&gt; n_bits           <span class="comment"># Shift right</span></span><br><span class="line">&lt;int&gt;     = ~&lt;int&gt;                    <span class="comment"># Compliment (flips bits)</span></span><br></pre></td></tr></table></figure>


<h2 id="Combinatorics"><a href="#Combinatorics" class="headerlink" title="Combinatorics"></a>Combinatorics</h2><ul>
<li><strong>Every function returns an iterator.</strong></li>
<li><strong>If you want to print the iterator, you need to pass it to the list() function!</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product, combinations, combinations_with_replacement, permutations</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>product([<span class="number">0</span>, <span class="number">1</span>], repeat=<span class="number">3</span>)</span><br><span class="line">[(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>), (<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line"> (<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>), (<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>), (<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>product(<span class="string">'ab'</span>, <span class="string">'12'</span>)</span><br><span class="line">[(<span class="string">'a'</span>, <span class="string">'1'</span>), (<span class="string">'a'</span>, <span class="string">'2'</span>),</span><br><span class="line"> (<span class="string">'b'</span>, <span class="string">'1'</span>), (<span class="string">'b'</span>, <span class="string">'2'</span>)]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>combinations(<span class="string">'abc'</span>, <span class="number">2</span>)</span><br><span class="line">[(<span class="string">'a'</span>, <span class="string">'b'</span>), (<span class="string">'a'</span>, <span class="string">'c'</span>), (<span class="string">'b'</span>, <span class="string">'c'</span>)]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>combinations_with_replacement(<span class="string">'abc'</span>, <span class="number">2</span>)</span><br><span class="line">[(<span class="string">'a'</span>, <span class="string">'a'</span>), (<span class="string">'a'</span>, <span class="string">'b'</span>), (<span class="string">'a'</span>, <span class="string">'c'</span>),</span><br><span class="line"> (<span class="string">'b'</span>, <span class="string">'b'</span>), (<span class="string">'b'</span>, <span class="string">'c'</span>),</span><br><span class="line"> (<span class="string">'c'</span>, <span class="string">'c'</span>)]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>permutations(<span class="string">'abc'</span>, <span class="number">2</span>)</span><br><span class="line">[(<span class="string">'a'</span>, <span class="string">'b'</span>), (<span class="string">'a'</span>, <span class="string">'c'</span>),</span><br><span class="line"> (<span class="string">'b'</span>, <span class="string">'a'</span>), (<span class="string">'b'</span>, <span class="string">'c'</span>),</span><br><span class="line"> (<span class="string">'c'</span>, <span class="string">'a'</span>), (<span class="string">'c'</span>, <span class="string">'b'</span>)]</span><br></pre></td></tr></table></figure>


<h2 id="Datetime"><a href="#Datetime" class="headerlink" title="Datetime"></a>Datetime</h2><ul>
<li><strong>Module ‘datetime’ provides ‘date’ <code>&lt;D&gt;</code>, ‘time’ <code>&lt;T&gt;</code>, ‘datetime’ <code>&lt;DT&gt;</code> and ‘timedelta’ <code>&lt;TD&gt;</code> classes. All are immutable and hashable.</strong></li>
<li><strong>Time and datetime can be ‘aware’ <code>&lt;a&gt;</code>, meaning they have defined timezone, or ‘naive’ <code>&lt;n&gt;</code>, meaning they don’t.</strong></li>
<li><strong>If object is naive, it is presumed to be in the system’s timezone.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date, time, datetime, timedelta</span><br><span class="line"><span class="keyword">from</span> dateutil.tz <span class="keyword">import</span> UTC, tzlocal, gettz, resolve_imaginary</span><br></pre></td></tr></table></figure>

<h3 id="Constructors"><a href="#Constructors" class="headerlink" title="Constructors"></a>Constructors</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;D&gt;  = date(year, month, day)</span><br><span class="line">&lt;T&gt;  = time(hour=<span class="number">0</span>, minute=<span class="number">0</span>, second=<span class="number">0</span>, microsecond=<span class="number">0</span>, tzinfo=<span class="literal">None</span>, fold=<span class="number">0</span>)</span><br><span class="line">&lt;DT&gt; = datetime(year, month, day, hour=<span class="number">0</span>, minute=<span class="number">0</span>, second=<span class="number">0</span>, ...)</span><br><span class="line">&lt;TD&gt; = timedelta(days=<span class="number">0</span>, seconds=<span class="number">0</span>, microseconds=<span class="number">0</span>, milliseconds=<span class="number">0</span>,</span><br><span class="line">                 minutes=<span class="number">0</span>, hours=<span class="number">0</span>, weeks=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Use <code>&#39;&lt;D/DT&gt;.weekday()&#39;</code> to get the day of the week (Mon == 0).</strong></li>
<li><strong><code>&#39;fold=1&#39;</code> means second pass in case of time jumping back for one hour.</strong></li>
<li><strong><code>&#39;&lt;DTa&gt; = resolve_imaginary(&lt;DTa&gt;)&#39;</code> fixes DTs that fall into missing hour.</strong></li>
</ul>
<h3 id="Now"><a href="#Now" class="headerlink" title="Now"></a>Now</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;D/DTn&gt;  = D/DT.today()                     <span class="comment"># Current local date or naive datetime.</span></span><br><span class="line">&lt;DTn&gt;    = DT.utcnow()                      <span class="comment"># Naive datetime from current UTC time.</span></span><br><span class="line">&lt;DTa&gt;    = DT.now(&lt;tzinfo&gt;)                 <span class="comment"># Aware datetime from current tz time.</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>To extract time use <code>&#39;&lt;DTn&gt;.time()&#39;</code>, <code>&#39;&lt;DTa&gt;.time()&#39;</code> or <code>&#39;&lt;DTa&gt;.timetz()&#39;</code>.</strong></li>
</ul>
<h3 id="Timezone"><a href="#Timezone" class="headerlink" title="Timezone"></a>Timezone</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;tzinfo&gt; = UTC                              <span class="comment"># UTC timezone. London without DST.</span></span><br><span class="line">&lt;tzinfo&gt; = tzlocal()                        <span class="comment"># Local timezone. Also gettz().</span></span><br><span class="line">&lt;tzinfo&gt; = gettz(<span class="string">'&lt;Cont.&gt;/&lt;City&gt;'</span>)          <span class="comment"># 'Continent/City_Name' timezone or None.</span></span><br><span class="line">&lt;DTa&gt;    = &lt;DT&gt;.astimezone(&lt;tzinfo&gt;)        <span class="comment"># Datetime, converted to passed timezone.</span></span><br><span class="line">&lt;Ta/DTa&gt; = &lt;T/DT&gt;.replace(tzinfo=&lt;tzinfo&gt;)  <span class="comment"># Unconverted object with new timezone.</span></span><br></pre></td></tr></table></figure>

<h3 id="Encode"><a href="#Encode" class="headerlink" title="Encode"></a>Encode</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;D/T/DT&gt; = D/T/DT.fromisoformat(<span class="string">'&lt;iso&gt;'</span>)    <span class="comment"># Object from ISO string. Raises ValueError.</span></span><br><span class="line">&lt;DT&gt;     = DT.strptime(&lt;str&gt;, <span class="string">'&lt;format&gt;'</span>)   <span class="comment"># Datetime from str, according to format.</span></span><br><span class="line">&lt;D/DTn&gt;  = D/DT.fromordinal(&lt;int&gt;)          <span class="comment"># D/DTn from days since Christ, at midnight.</span></span><br><span class="line">&lt;DTn&gt;    = DT.fromtimestamp(&lt;real&gt;)         <span class="comment"># Local time DTn from seconds since Epoch.</span></span><br><span class="line">&lt;DTa&gt;    = DT.fromtimestamp(&lt;real&gt;, &lt;tz.&gt;)  <span class="comment"># Aware datetime from seconds since Epoch.</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>ISO strings come in following forms: <code>&#39;YYYY-MM-DD&#39;</code>, <code>&#39;HH:MM:SS.ffffff[±&lt;offset&gt;]&#39;</code>, or both separated by an arbitrary character. Offset is formatted as: <code>&#39;HH:MM&#39;</code>.</strong></li>
<li><strong>On Unix systems Epoch is <code>&#39;1970-01-01 00:00 UTC&#39;</code>, <code>&#39;1970-01-01 01:00 CET&#39;</code>, …</strong></li>
</ul>
<h3 id="Decode"><a href="#Decode" class="headerlink" title="Decode"></a>Decode</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;str&gt;    = &lt;D/T/DT&gt;.isoformat(sep=<span class="string">'T'</span>)      <span class="comment"># Also timespec='auto/hours/minutes/seconds'.</span></span><br><span class="line">&lt;str&gt;    = &lt;D/T/DT&gt;.strftime(<span class="string">'&lt;format&gt;'</span>)    <span class="comment"># Custom string representation.</span></span><br><span class="line">&lt;int&gt;    = &lt;D/DT&gt;.toordinal()               <span class="comment"># Days since Christ, ignoring time and tz.</span></span><br><span class="line">&lt;float&gt;  = &lt;DTn&gt;.timestamp()                <span class="comment"># Seconds since Epoch from DTn in local time.</span></span><br><span class="line">&lt;float&gt;  = &lt;DTa&gt;.timestamp()                <span class="comment"># Seconds since Epoch from DTa.</span></span><br></pre></td></tr></table></figure>

<h3 id="Format-1"><a href="#Format-1" class="headerlink" title="Format"></a>Format</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dt = datetime.strptime(<span class="string">'2015-05-14 23:39:00.00 +0200'</span>, <span class="string">'%Y-%m-%d %H:%M:%S.%f %z'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dt.strftime(<span class="string">"%A, %dth of %B '%y, %I:%M%p %Z"</span>)</span><br><span class="line"><span class="string">"Thursday, 14th of May '15, 11:39PM UTC+02:00"</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>When parsing, <code>&#39;%z&#39;</code> also accepts <code>&#39;±HH:MM&#39;</code>.</strong></li>
<li><strong>For abbreviated weekday and month use <code>&#39;%a&#39;</code> and <code>&#39;%b&#39;</code>.</strong></li>
</ul>
<h3 id="Arithmetics"><a href="#Arithmetics" class="headerlink" title="Arithmetics"></a>Arithmetics</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;D/DT&gt;   = &lt;D/DT&gt;   ± &lt;TD&gt;                  <span class="comment"># Returned datetime can fall into missing hour.</span></span><br><span class="line">&lt;TD&gt;     = &lt;D/DTn&gt;  - &lt;D/DTn&gt;               <span class="comment"># Returns the difference, ignoring time jumps.</span></span><br><span class="line">&lt;TD&gt;     = &lt;DTa&gt;    - &lt;DTa&gt;                 <span class="comment"># Ignores time jumps if they share tzinfo object.</span></span><br><span class="line">&lt;TD&gt;     = &lt;DT_UTC&gt; - &lt;DT_UTC&gt;              <span class="comment"># Convert DTs to UTC to get the actual delta.</span></span><br></pre></td></tr></table></figure>


<h2 id="Arguments"><a href="#Arguments" class="headerlink" title="Arguments"></a>Arguments</h2><h3 id="Inside-Function-Call"><a href="#Inside-Function-Call" class="headerlink" title="Inside Function Call"></a>Inside Function Call</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;function&gt;(&lt;positional_args&gt;)                  <span class="comment"># f(0, 0)</span></span><br><span class="line">&lt;function&gt;(&lt;keyword_args&gt;)                     <span class="comment"># f(x=0, y=0)</span></span><br><span class="line">&lt;function&gt;(&lt;positional_args&gt;, &lt;keyword_args&gt;)  <span class="comment"># f(0, y=0)</span></span><br></pre></td></tr></table></figure>

<h3 id="Inside-Function-Definition"><a href="#Inside-Function-Definition" class="headerlink" title="Inside Function Definition"></a>Inside Function Definition</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(&lt;nondefault_args&gt;)</span>:</span>                      <span class="comment"># def f(x, y):</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(&lt;default_args&gt;)</span>:</span>                         <span class="comment"># def f(x=0, y=0):</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(&lt;nondefault_args&gt;, &lt;default_args&gt;)</span>:</span>      <span class="comment"># def f(x, y=0):</span></span><br></pre></td></tr></table></figure>


<h2 id="Splat-Operator"><a href="#Splat-Operator" class="headerlink" title="Splat Operator"></a>Splat Operator</h2><h3 id="Inside-Function-Call-1"><a href="#Inside-Function-Call-1" class="headerlink" title="Inside Function Call"></a>Inside Function Call</h3><p><strong>Splat expands a collection into positional arguments, while splatty-splat expands a dictionary into keyword arguments.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">args   = (<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">kwargs = &#123;<span class="string">'x'</span>: <span class="number">3</span>, <span class="string">'y'</span>: <span class="number">4</span>, <span class="string">'z'</span>: <span class="number">5</span>&#125;</span><br><span class="line">func(*args, **kwargs)</span><br></pre></td></tr></table></figure>

<h4 id="Is-the-same-as"><a href="#Is-the-same-as" class="headerlink" title="Is the same as:"></a>Is the same as:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func(<span class="number">1</span>, <span class="number">2</span>, x=<span class="number">3</span>, y=<span class="number">4</span>, z=<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Inside-Function-Definition-1"><a href="#Inside-Function-Definition-1" class="headerlink" title="Inside Function Definition"></a>Inside Function Definition</h3><p><strong>Splat combines zero or more positional arguments into a tuple, while splatty-splat combines zero or more keyword arguments into a dictionary.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(*a)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> sum(a)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>add(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="number">6</span></span><br></pre></td></tr></table></figure>

<h4 id="Legal-argument-combinations"><a href="#Legal-argument-combinations" class="headerlink" title="Legal argument combinations:"></a>Legal argument combinations:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x, y, z)</span>:</span>                <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3) | f(1, 2, 3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(*, x, y, z)</span>:</span>             <span class="comment"># f(x=1, y=2, z=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x, *, y, z)</span>:</span>             <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x, y, *, z)</span>:</span>             <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(*args)</span>:</span>                  <span class="comment"># f(1, 2, 3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x, *args)</span>:</span>               <span class="comment"># f(1, 2, 3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(*args, z)</span>:</span>               <span class="comment"># f(1, 2, z=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x, *args, z)</span>:</span>            <span class="comment"># f(1, 2, z=3)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(**kwargs)</span>:</span>               <span class="comment"># f(x=1, y=2, z=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x, **kwargs)</span>:</span>            <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(*, x, **kwargs)</span>:</span>         <span class="comment"># f(x=1, y=2, z=3)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(*args, **kwargs)</span>:</span>        <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3) | f(1, 2, 3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x, *args, **kwargs)</span>:</span>     <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3) | f(1, 2, 3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(*args, y, **kwargs)</span>:</span>     <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x, *args, z, **kwargs)</span>:</span>  <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3)</span></span><br></pre></td></tr></table></figure>

<h3 id="Other-Uses"><a href="#Other-Uses" class="headerlink" title="Other Uses"></a>Other Uses</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;list&gt;  = [*&lt;collection&gt; [, ...]]</span><br><span class="line">&lt;set&gt;   = &#123;*&lt;collection&gt; [, ...]&#125;</span><br><span class="line">&lt;tuple&gt; = (*&lt;collection&gt;, [...])</span><br><span class="line">&lt;dict&gt;  = &#123;**&lt;dict&gt; [, ...]&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head, *body, tail = &lt;collection&gt;</span><br></pre></td></tr></table></figure>


<h2 id="Inline"><a href="#Inline" class="headerlink" title="Inline"></a>Inline</h2><h3 id="Lambda"><a href="#Lambda" class="headerlink" title="Lambda"></a>Lambda</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;function&gt; = <span class="keyword">lambda</span>: &lt;return_value&gt;</span><br><span class="line">&lt;function&gt; = <span class="keyword">lambda</span> &lt;argument_1&gt;, &lt;argument_2&gt;: &lt;return_value&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Comprehension"><a href="#Comprehension" class="headerlink" title="Comprehension"></a>Comprehension</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;list&gt; = [i+<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)]                   <span class="comment"># [1, 2, ..., 10]</span></span><br><span class="line">&lt;set&gt;  = &#123;i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>) <span class="keyword">if</span> i &gt; <span class="number">5</span>&#125;            <span class="comment"># &#123;6, 7, 8, 9&#125;</span></span><br><span class="line">&lt;iter&gt; = (i+<span class="number">5</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>))                   <span class="comment"># (5, 6, ..., 14)</span></span><br><span class="line">&lt;dict&gt; = &#123;i: i*<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)&#125;                <span class="comment"># &#123;0: 0, 1: 2, ..., 9: 18&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">out = [i+j <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>) <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">10</span>)]</span><br></pre></td></tr></table></figure>

<h4 id="Is-the-same-as-1"><a href="#Is-the-same-as-1" class="headerlink" title="Is the same as:"></a>Is the same as:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">out = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        out.append(i+j)</span><br></pre></td></tr></table></figure>

<h3 id="Map-Filter-Reduce"><a href="#Map-Filter-Reduce" class="headerlink" title="Map, Filter, Reduce"></a>Map, Filter, Reduce</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line">&lt;iter&gt; = map(<span class="keyword">lambda</span> x: x + <span class="number">1</span>, range(<span class="number">10</span>))            <span class="comment"># (1, 2, ..., 10)</span></span><br><span class="line">&lt;iter&gt; = filter(<span class="keyword">lambda</span> x: x &gt; <span class="number">5</span>, range(<span class="number">10</span>))         <span class="comment"># (6, 7, 8, 9)</span></span><br><span class="line">&lt;obj&gt;  = reduce(<span class="keyword">lambda</span> out, x: out + x, range(<span class="number">10</span>))  <span class="comment"># 45</span></span><br></pre></td></tr></table></figure>

<h3 id="Any-All"><a href="#Any-All" class="headerlink" title="Any, All"></a>Any, All</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;bool&gt; = any(&lt;collection&gt;)                          <span class="comment"># False if empty.</span></span><br><span class="line">&lt;bool&gt; = all(el[<span class="number">1</span>] <span class="keyword">for</span> el <span class="keyword">in</span> &lt;collection&gt;)          <span class="comment"># True if empty.</span></span><br></pre></td></tr></table></figure>

<h3 id="If-Else"><a href="#If-Else" class="headerlink" title="If - Else"></a>If - Else</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;obj&gt; = &lt;expression_if_true&gt; <span class="keyword">if</span> &lt;condition&gt; <span class="keyword">else</span> &lt;expression_if_false&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>[a <span class="keyword">if</span> a <span class="keyword">else</span> <span class="string">'zero'</span> <span class="keyword">for</span> a <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)]</span><br><span class="line">[<span class="string">'zero'</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<h3 id="Namedtuple-Enum-Dataclass"><a href="#Namedtuple-Enum-Dataclass" class="headerlink" title="Namedtuple, Enum, Dataclass"></a>Namedtuple, Enum, Dataclass</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line">Point     = namedtuple(<span class="string">'Point'</span>, <span class="string">'x y'</span>)</span><br><span class="line">point     = Point(<span class="number">0</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</span><br><span class="line">Direction = Enum(<span class="string">'Direction'</span>, <span class="string">'n e s w'</span>)</span><br><span class="line">direction = Direction.n</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> make_dataclass</span><br><span class="line">Creature  = make_dataclass(<span class="string">'Creature'</span>, [<span class="string">'location'</span>, <span class="string">'direction'</span>])</span><br><span class="line">creature  = Creature(Point(<span class="number">0</span>, <span class="number">0</span>), Direction.n)</span><br></pre></td></tr></table></figure>


<h2 id="Closure"><a href="#Closure" class="headerlink" title="Closure"></a>Closure</h2><p><strong>We have a closure in Python when:</strong></p>
<ul>
<li><strong>A nested function references a value of its enclosing function and then</strong></li>
<li><strong>the enclosing function returns the nested function.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_multiplier</span><span class="params">(a)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">out</span><span class="params">(b)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> a * b</span><br><span class="line">    <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>multiply_by_3 = get_multiplier(<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>multiply_by_3(<span class="number">10</span>)</span><br><span class="line"><span class="number">30</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>If multiple nested functions within enclosing function reference the same value, that value gets shared.</strong></li>
<li><strong>To dynamically access function’s first free variable use <code>&#39;&lt;function&gt;.__closure__[0].cell_contents&#39;</code>.</strong></li>
</ul>
<h3 id="Partial"><a href="#Partial" class="headerlink" title="Partial"></a>Partial</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> partial</span><br><span class="line">&lt;function&gt; = partial(&lt;function&gt; [, &lt;arg_1&gt;, &lt;arg_2&gt;, ...])</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> operator <span class="keyword">as</span> op</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>multiply_by_3 = partial(op.mul, <span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>multiply_by_3(<span class="number">10</span>)</span><br><span class="line"><span class="number">30</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Partial is also useful in cases when function needs to be passed as an argument, because it enables us to set its arguments beforehand.</strong></li>
<li><strong>A few examples being: <code>&#39;defaultdict(&lt;function&gt;)&#39;</code>, <code>&#39;iter(&lt;function&gt;, to_exclusive)&#39;</code> and dataclass’s <code>&#39;field(default_factory=&lt;function&gt;)&#39;</code>.</strong></li>
</ul>
<h3 id="Nonlocal"><a href="#Nonlocal" class="headerlink" title="Nonlocal"></a>Nonlocal</h3><p><strong>If variable is being assigned to anywhere in the scope, it is regarded as a local variable, unless it is declared as a ‘global’ or a ‘nonlocal’.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_counter</span><span class="params">()</span>:</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">out</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">nonlocal</span> i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> i</span><br><span class="line">    <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter = get_counter()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter(), counter(), counter()</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Decorator"><a href="#Decorator" class="headerlink" title="Decorator"></a>Decorator</h2><p><strong>A decorator takes a function, adds some functionality and returns it.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@decorator_name</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">function_that_gets_passed_to_decorator</span><span class="params">()</span>:</span></span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<h3 id="Debugger-Example"><a href="#Debugger-Example" class="headerlink" title="Debugger Example"></a>Debugger Example</h3><p><strong>Decorator that prints function’s name every time it gets called.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(func)</span>:</span></span><br><span class="line"><span class="meta">    @wraps(func)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">out</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">        print(func.__name__)</span><br><span class="line">        <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="meta">@debug</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x + y</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Wraps is a helper decorator that copies the metadata of the passed function (func) to the function it is wrapping (out).</strong></li>
<li><strong>Without it <code>&#39;add.__name__&#39;</code> would return <code>&#39;out&#39;</code>.</strong></li>
</ul>
<h3 id="LRU-Cache"><a href="#LRU-Cache" class="headerlink" title="LRU Cache"></a>LRU Cache</h3><p><strong>Decorator that caches function’s return values. All function’s arguments must be hashable.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> lru_cache</span><br><span class="line"></span><br><span class="line"><span class="meta">@lru_cache(maxsize=None)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> n <span class="keyword">if</span> n &lt; <span class="number">2</span> <span class="keyword">else</span> fib(n<span class="number">-2</span>) + fib(n<span class="number">-1</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>CPython interpreter limits recursion depth to 1000 by default. To increase it use <code>&#39;sys.setrecursionlimit(&lt;depth&gt;)&#39;</code>.</strong></li>
</ul>
<h3 id="Parametrized-Decorator"><a href="#Parametrized-Decorator" class="headerlink" title="Parametrized Decorator"></a>Parametrized Decorator</h3><p><strong>A decorator that accepts arguments and returns a normal decorator that accepts a function.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(print_result=False)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decorator</span><span class="params">(func)</span>:</span></span><br><span class="line"><span class="meta">        @wraps(func)</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">out</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">            result = func(*args, **kwargs)</span><br><span class="line">            print(func.__name__, result <span class="keyword">if</span> print_result <span class="keyword">else</span> <span class="string">''</span>)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line">    <span class="keyword">return</span> decorator</span><br><span class="line"></span><br><span class="line"><span class="meta">@debug(print_result=True)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x + y</span><br></pre></td></tr></table></figure>


<h2 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> &lt;<span class="title">name</span>&gt;:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a)</span>:</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        class_name = self.__class__.__name__</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f'<span class="subst">&#123;class_name&#125;</span>(<span class="subst">&#123;self.a!r&#125;</span>)'</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> str(self.a)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_class_name</span><span class="params">(cls)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> cls.__name__</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Return value of repr() should be unambiguous and of str() readable.</strong></li>
<li><strong>If only repr() is defined, it will also be used for str().</strong></li>
</ul>
<h4 id="Str-use-cases"><a href="#Str-use-cases" class="headerlink" title="Str() use cases:"></a>Str() use cases:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(&lt;el&gt;)</span><br><span class="line">print(<span class="string">f'<span class="subst">&#123;&lt;el&gt;&#125;</span>'</span>)</span><br><span class="line"><span class="keyword">raise</span> Exception(&lt;el&gt;)</span><br><span class="line">loguru.logger.debug(&lt;el&gt;)</span><br><span class="line">csv.writer(&lt;file&gt;).writerow([&lt;el&gt;])</span><br></pre></td></tr></table></figure>

<h4 id="Repr-use-cases"><a href="#Repr-use-cases" class="headerlink" title="Repr() use cases:"></a>Repr() use cases:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print([&lt;el&gt;])</span><br><span class="line">print(<span class="string">f'<span class="subst">&#123;&lt;el&gt;!r&#125;</span>'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;el&gt;</span><br><span class="line">loguru.logger.exception()</span><br><span class="line">Z = dataclasses.make_dataclass(<span class="string">'Z'</span>, [<span class="string">'a'</span>]); print(Z(&lt;el&gt;))</span><br></pre></td></tr></table></figure>

<h3 id="Constructor-Overloading"><a href="#Constructor-Overloading" class="headerlink" title="Constructor Overloading"></a>Constructor Overloading</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> &lt;<span class="title">name</span>&gt;:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a=None)</span>:</span></span><br><span class="line">        self.a = a</span><br></pre></td></tr></table></figure>

<h3 id="Inheritance"><a href="#Inheritance" class="headerlink" title="Inheritance"></a>Inheritance</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age  = age</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span><span class="params">(Person)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, staff_num)</span>:</span></span><br><span class="line">        super().__init__(name, age)</span><br><span class="line">        self.staff_num = staff_num</span><br></pre></td></tr></table></figure>

<h3 id="Multiple-Inheritance"><a href="#Multiple-Inheritance" class="headerlink" title="Multiple Inheritance"></a>Multiple Inheritance</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span> <span class="keyword">pass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span> <span class="keyword">pass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span><span class="params">(A, B)</span>:</span> <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p><strong>MRO determines the order in which parent classes are traversed when searching for a method:</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>C.mro()</span><br><span class="line">[&lt;class 'C'&gt;, &lt;class 'A'&gt;, &lt;class 'B'&gt;, &lt;class 'object'&gt;]</span><br></pre></td></tr></table></figure>

<h3 id="Property"><a href="#Property" class="headerlink" title="Property"></a>Property</h3><p><strong>Pythonic way of implementing getters and setters.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span>:</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">a</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._a</span><br><span class="line"></span><br><span class="line"><span class="meta">    @a.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">a</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        self._a = value</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>el = MyClass()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>el.a = <span class="number">123</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>el.a</span><br><span class="line"><span class="number">123</span></span><br></pre></td></tr></table></figure>

<h3 id="Dataclass"><a href="#Dataclass" class="headerlink" title="Dataclass"></a>Dataclass</h3><p><strong>Decorator that automatically generates init(), repr() and eq() special methods.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass, field</span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass(order=False, frozen=False)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> &lt;<span class="title">class_name</span>&gt;:</span></span><br><span class="line">    &lt;attr_name_1&gt;: &lt;type&gt;</span><br><span class="line">    &lt;attr_name_2&gt;: &lt;type&gt; = &lt;default_value&gt;</span><br><span class="line">    &lt;attr_name_3&gt;: list/dict/set = field(default_factory=list/dict/set)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Objects can be made sortable with <code>&#39;order=True&#39;</code> and/or immutable and hashable with <code>&#39;frozen=True&#39;</code>.</strong></li>
<li><strong>Function field() is needed because <code>&#39;&lt;attr_name&gt;: list = []&#39;</code> would make a list that is shared among all instances.</strong></li>
<li><strong>Default_factory can be any <a href="#callable">callable</a>.</strong></li>
</ul>
<h4 id="Inline-1"><a href="#Inline-1" class="headerlink" title="Inline:"></a>Inline:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> make_dataclass</span><br><span class="line">&lt;class&gt; = make_dataclass('&lt;class_name&gt;', &lt;coll_of_attribute_names&gt;)</span><br><span class="line">&lt;class&gt; = make_dataclass('&lt;class_name&gt;', &lt;coll_of_tuples&gt;)</span><br><span class="line">&lt;tuple&gt; = (<span class="string">'&lt;attr_name&gt;'</span>, &lt;type&gt; [, &lt;default_value&gt;])</span><br></pre></td></tr></table></figure>

<h3 id="Slots"><a href="#Slots" class="headerlink" title="Slots"></a>Slots</h3><p><strong>Mechanism that restricts objects to attributes listed in ‘slots’ and significantly reduces their memory footprint.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClassWithSlots</span>:</span></span><br><span class="line">    __slots__ = [<span class="string">'a'</span>]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.a = <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="Copy"><a href="#Copy" class="headerlink" title="Copy"></a>Copy</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> copy, deepcopy</span><br><span class="line">&lt;object&gt; = copy(&lt;object&gt;)</span><br><span class="line">&lt;object&gt; = deepcopy(&lt;object&gt;)</span><br></pre></td></tr></table></figure>


<h2 id="Duck-Types"><a href="#Duck-Types" class="headerlink" title="Duck Types"></a>Duck Types</h2><p><strong>A duck type is an implicit type that prescribes a set of special methods. Any object that has those methods defined is considered a member of that duck type.</strong></p>
<h3 id="Comparable"><a href="#Comparable" class="headerlink" title="Comparable"></a>Comparable</h3><ul>
<li><strong>If eq() method is not overridden, it returns <code>&#39;id(self) == id(other)&#39;</code>, which is the same as <code>&#39;self is other&#39;</code>.</strong></li>
<li><strong>That means all objects compare not equal by default.</strong></li>
<li><strong>Only the left side object has eq() method called, unless it returns NotImplemented, in which case the right object is consulted.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComparable</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a)</span>:</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(other, type(self)):</span><br><span class="line">            <span class="keyword">return</span> self.a == other.a</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">NotImplemented</span></span><br></pre></td></tr></table></figure>

<h3 id="Hashable"><a href="#Hashable" class="headerlink" title="Hashable"></a>Hashable</h3><ul>
<li><strong>Hashable object needs both hash() and eq() methods and its hash value should never change.</strong></li>
<li><strong>Hashable objects that compare equal must have the same hash value, meaning default hash() that returns <code>&#39;id(self)&#39;</code> will not do.</strong></li>
<li><strong>That is why Python automatically makes classes unhashable if you only implement eq().</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHashable</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a)</span>:</span></span><br><span class="line">        self._a = copy.deepcopy(a)</span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">a</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(other, type(self)):</span><br><span class="line">            <span class="keyword">return</span> self.a == other.a</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">NotImplemented</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__hash__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> hash(self.a)</span><br></pre></td></tr></table></figure>

<h3 id="Sortable"><a href="#Sortable" class="headerlink" title="Sortable"></a>Sortable</h3><ul>
<li><strong>With total_ordering decorator you only need to provide eq() and one of lt(), gt(), le() or ge() special methods.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> total_ordering</span><br><span class="line"></span><br><span class="line"><span class="meta">@total_ordering</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySortable</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a)</span>:</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(other, type(self)):</span><br><span class="line">            <span class="keyword">return</span> self.a == other.a</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">NotImplemented</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(other, type(self)):</span><br><span class="line">            <span class="keyword">return</span> self.a &lt; other.a</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">NotImplemented</span></span><br></pre></td></tr></table></figure>

<h3 id="Iterator-1"><a href="#Iterator-1" class="headerlink" title="Iterator"></a>Iterator</h3><ul>
<li><strong>Any object that has methods next() and iter() is an iterator.</strong></li>
<li><strong>Next() should return next item or raise StopIteration.</strong></li>
<li><strong>Iter() should return ‘self’.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.i = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> self.i</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter = Counter()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>next(counter), next(counter), next(counter)</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Python-has-many-different-iterator-objects"><a href="#Python-has-many-different-iterator-objects" class="headerlink" title="Python has many different iterator objects:"></a>Python has many different iterator objects:</h4><ul>
<li><strong>Iterators returned by the <a href="#iterator">iter()</a> function, such as list_iterator and set_iterator.</strong></li>
<li><strong>Objects returned by the <a href="#itertools">itertools</a> module, such as count, repeat and cycle.</strong></li>
<li><strong>Generators returned by the <a href="#generator">generator functions</a> and <a href="#comprehension">generator expressions</a>.</strong></li>
<li><strong>File objects returned by the <a href="#open">open()</a> function, etc.</strong></li>
</ul>
<h3 id="Callable"><a href="#Callable" class="headerlink" title="Callable"></a>Callable</h3><ul>
<li><strong>All functions and classes have a call() method, hence are callable.</strong></li>
<li><strong>When this cheatsheet uses <code>&#39;&lt;function&gt;&#39;</code> for an argument, it actually means <code>&#39;&lt;callable&gt;&#39;</code>.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.i = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> self.i</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter = Counter()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter(), counter(), counter()</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Context-Manager"><a href="#Context-Manager" class="headerlink" title="Context Manager"></a>Context Manager</h3><ul>
<li><strong>Enter() should lock the resources and return an object.</strong></li>
<li><strong>Exit() should release the resources.</strong></li>
<li><strong>Any exception that happens inside the with block is passed to the exit() method.</strong></li>
<li><strong>If it wishes to suppress the exception it must return a true value.</strong> </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyOpen</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, filename)</span>:</span></span><br><span class="line">        self.filename = filename</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__enter__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.file = open(self.filename)</span><br><span class="line">        <span class="keyword">return</span> self.file</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__exit__</span><span class="params">(self, exc_type, exc_value, traceback)</span>:</span></span><br><span class="line">        self.file.close()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> open(<span class="string">'test.txt'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> file:</span><br><span class="line"><span class="meta">... </span>    file.write(<span class="string">'Hello World!'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> MyOpen(<span class="string">'test.txt'</span>) <span class="keyword">as</span> file:</span><br><span class="line"><span class="meta">... </span>    print(file.read())</span><br><span class="line">Hello World!</span><br></pre></td></tr></table></figure>


<h2 id="Iterable-Duck-Types"><a href="#Iterable-Duck-Types" class="headerlink" title="Iterable Duck Types"></a>Iterable Duck Types</h2><h3 id="Iterable"><a href="#Iterable" class="headerlink" title="Iterable"></a>Iterable</h3><ul>
<li><strong>Only required method is iter(). It should return an iterator of object’s items.</strong></li>
<li><strong>Contains() automatically works on any object that has iter() defined.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyIterable</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a)</span>:</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> el <span class="keyword">in</span> self.a:</span><br><span class="line">            <span class="keyword">yield</span> el</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>z = MyIterable([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>iter(z)</span><br><span class="line">&lt;generator object MyIterable.__iter__&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span> <span class="keyword">in</span> z</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h3 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h3><ul>
<li><strong>Only required methods are iter() and len().</strong></li>
<li><strong>This cheatsheet actually means <code>&#39;&lt;iterable&gt;&#39;</code> when it uses <code>&#39;&lt;collection&gt;&#39;</code>.</strong></li>
<li><strong>I chose not to use the name ‘iterable’ because it sounds scarier and more vague than ‘collection’.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyCollection</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a)</span>:</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> iter(self.a)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__contains__</span><span class="params">(self, el)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> el <span class="keyword">in</span> self.a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> len(self.a)</span><br></pre></td></tr></table></figure>

<h3 id="Sequence"><a href="#Sequence" class="headerlink" title="Sequence"></a>Sequence</h3><ul>
<li><strong>Only required methods are len() and getitem().</strong></li>
<li><strong>Getitem() should return an item at index or raise IndexError.</strong></li>
<li><strong>Iter() and contains() automatically work on any object that has getitem() defined.</strong></li>
<li><strong>Reversed() automatically works on any object that has getitem() and len() defined.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySequence</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a)</span>:</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> iter(self.a)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__contains__</span><span class="params">(self, el)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> el <span class="keyword">in</span> self.a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> len(self.a)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span><span class="params">(self, i)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.a[i]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reversed__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> reversed(self.a)</span><br></pre></td></tr></table></figure>

<h3 id="Collections-abc-Sequence"><a href="#Collections-abc-Sequence" class="headerlink" title="Collections.abc.Sequence"></a>Collections.abc.Sequence</h3><ul>
<li><strong>It’s a richer interface than the basic sequence.</strong></li>
<li><strong>Extending it generates iter(), contains(), reversed(), index(), and count().</strong></li>
<li><strong>Unlike <code>&#39;abc.Iterable&#39;</code> and <code>&#39;abc.Collection&#39;</code>, it is not a duck type. That is why <code>&#39;issubclass(MySequence, collections.abc.Sequence)&#39;</code> would return False even if MySequence had all the methods defined.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyAbcSequence</span><span class="params">(collections.abc.Sequence)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a)</span>:</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> len(self.a)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span><span class="params">(self, i)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.a[i]</span><br></pre></td></tr></table></figure>

<h4 id="Table-of-required-and-automatically-available-special-methods"><a href="#Table-of-required-and-automatically-available-special-methods" class="headerlink" title="Table of required and automatically available special methods:"></a>Table of required and automatically available special methods:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+------------+------------+------------+------------+--------------+</span><br><span class="line">|            |  Iterable  | Collection |  Sequence  | abc.Sequence |</span><br><span class="line">+------------+------------+------------+------------+--------------+</span><br><span class="line">| iter()     |    REQ     |    REQ     |    yes     |     yes      |</span><br><span class="line">| contains() |    yes     |    yes     |    yes     |     yes      |</span><br><span class="line">| len()      |            |    REQ     |    REQ     |     REQ      |</span><br><span class="line">| getitem()  |            |            |    REQ     |     REQ      |</span><br><span class="line">| reversed() |            |            |    yes     |     yes      |</span><br><span class="line">| index()    |            |            |            |     yes      |</span><br><span class="line">| count()    |            |            |            |     yes      |</span><br><span class="line">+------------+------------+------------+------------+--------------+</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Other ABCs that generate missing methods are: MutableSequence, Set, MutableSet, Mapping and MutableMapping.</strong></li>
<li><strong>Names of their required methods are stored in <code>&#39;&lt;abc&gt;.__abstractmethods__&#39;</code>.</strong></li>
</ul>
<h2 id="Enum"><a href="#Enum" class="headerlink" title="Enum"></a>Enum</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum, auto</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> &lt;<span class="title">enum_name</span>&gt;<span class="params">(Enum)</span>:</span></span><br><span class="line">    &lt;member_name_1&gt; = &lt;value_1&gt;</span><br><span class="line">    &lt;member_name_2&gt; = &lt;value_2_a&gt;, &lt;value_2_b&gt;</span><br><span class="line">    &lt;member_name_3&gt; = auto()</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>If there are no numeric values before auto(), it returns 1.</strong></li>
<li><strong>Otherwise it returns an increment of the last numeric value.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;member&gt; = &lt;enum&gt;.&lt;member_name&gt;                <span class="comment"># Returns a member.</span></span><br><span class="line">&lt;member&gt; = &lt;enum&gt;[<span class="string">'&lt;member_name&gt;'</span>]             <span class="comment"># Returns a member or raises KeyError.</span></span><br><span class="line">&lt;member&gt; = &lt;enum&gt;(&lt;value&gt;)                     <span class="comment"># Returns a member or raises ValueError.</span></span><br><span class="line">&lt;str&gt;    = &lt;member&gt;.name                       <span class="comment"># Returns member's name.</span></span><br><span class="line">&lt;obj&gt;    = &lt;member&gt;.value                      <span class="comment"># Returns member's value.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list_of_members = list(&lt;enum&gt;)</span><br><span class="line">member_names    = [a.name <span class="keyword">for</span> a <span class="keyword">in</span> &lt;enum&gt;]</span><br><span class="line">member_values   = [a.value <span class="keyword">for</span> a <span class="keyword">in</span> &lt;enum&gt;]</span><br><span class="line">random_member   = random.choice(list(&lt;enum&gt;))</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_next_member</span><span class="params">(member)</span>:</span></span><br><span class="line">    members = list(member.__class__)</span><br><span class="line">    index   = (members.index(member) + <span class="number">1</span>) % len(members)</span><br><span class="line">    <span class="keyword">return</span> members[index]</span><br></pre></td></tr></table></figure>

<h3 id="Inline-2"><a href="#Inline-2" class="headerlink" title="Inline"></a>Inline</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Cutlery = Enum(<span class="string">'Cutlery'</span>, [<span class="string">'fork'</span>, <span class="string">'knife'</span>, <span class="string">'spoon'</span>])</span><br><span class="line">Cutlery = Enum(<span class="string">'Cutlery'</span>, <span class="string">'fork knife spoon'</span>)</span><br><span class="line">Cutlery = Enum(<span class="string">'Cutlery'</span>, &#123;<span class="string">'fork'</span>: <span class="number">1</span>, <span class="string">'knife'</span>: <span class="number">2</span>, <span class="string">'spoon'</span>: <span class="number">3</span>&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="Functions-can-not-be-values-so-they-must-be-wrapped"><a href="#Functions-can-not-be-values-so-they-must-be-wrapped" class="headerlink" title="Functions can not be values, so they must be wrapped:"></a>Functions can not be values, so they must be wrapped:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> partial</span><br><span class="line">LogicOp = Enum(<span class="string">'LogicOp'</span>, &#123;<span class="string">'AND'</span>: partial(<span class="keyword">lambda</span> l, r: l <span class="keyword">and</span> r),</span><br><span class="line">                           <span class="string">'OR'</span> : partial(<span class="keyword">lambda</span> l, r: l <span class="keyword">or</span> r)&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Another solution in this particular case, is to use <code>&#39;and_&#39;</code> and <code>&#39;or_&#39;</code> functions from module <a href="#operator">operator</a>.</strong></li>
</ul>
<h2 id="Exceptions"><a href="#Exceptions" class="headerlink" title="Exceptions"></a>Exceptions</h2><h3 id="Basic-Example"><a href="#Basic-Example" class="headerlink" title="Basic Example"></a>Basic Example</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    &lt;code&gt;</span><br><span class="line"><span class="keyword">except</span> &lt;exception&gt;:</span><br><span class="line">    &lt;code&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Complex-Example"><a href="#Complex-Example" class="headerlink" title="Complex Example"></a>Complex Example</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    &lt;code_1&gt;</span><br><span class="line"><span class="keyword">except</span> &lt;exception_a&gt;:</span><br><span class="line">    &lt;code_2_a&gt;</span><br><span class="line"><span class="keyword">except</span> &lt;exception_b&gt;:</span><br><span class="line">    &lt;code_2_b&gt;</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    &lt;code_2_c&gt;</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    &lt;code_3&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Catching-Exceptions"><a href="#Catching-Exceptions" class="headerlink" title="Catching Exceptions"></a>Catching Exceptions</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">except</span> &lt;exception&gt;:</span><br><span class="line"><span class="keyword">except</span> &lt;exception&gt; <span class="keyword">as</span> &lt;name&gt;:</span><br><span class="line"><span class="keyword">except</span> (&lt;exception&gt;, ...):</span><br><span class="line"><span class="keyword">except</span> (&lt;exception&gt;, ...) <span class="keyword">as</span> &lt;name&gt;:</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Also catches subclasses of the exception.</strong></li>
</ul>
<h3 id="Raising-Exceptions"><a href="#Raising-Exceptions" class="headerlink" title="Raising Exceptions"></a>Raising Exceptions</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">raise</span> &lt;exception&gt;</span><br><span class="line"><span class="keyword">raise</span> &lt;exception&gt;()</span><br><span class="line"><span class="keyword">raise</span> &lt;exception&gt;(&lt;el_1&gt; [, ...])</span><br></pre></td></tr></table></figure>

<h4 id="Re-raising-caught-exception"><a href="#Re-raising-caught-exception" class="headerlink" title="Re-raising caught exception:"></a>Re-raising caught exception:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">except</span> &lt;exception&gt;:</span><br><span class="line">    &lt;code&gt;</span><br><span class="line">    <span class="keyword">raise</span></span><br></pre></td></tr></table></figure>

<h4 id="Useful-built-in-exceptions"><a href="#Useful-built-in-exceptions" class="headerlink" title="Useful built-in exceptions:"></a>Useful built-in exceptions:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">raise</span> ValueError(<span class="string">'Argument is of right type but inappropriate value!'</span>)</span><br><span class="line"><span class="keyword">raise</span> TypeError(<span class="string">'Argument is of wrong type!'</span>)</span><br><span class="line"><span class="keyword">raise</span> RuntimeError(<span class="string">'None of above!'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Common-Built-in-Exceptions"><a href="#Common-Built-in-Exceptions" class="headerlink" title="Common Built-in Exceptions"></a>Common Built-in Exceptions</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">BaseException</span><br><span class="line"> +-- SystemExit                   # Raised by the sys.exit() function.</span><br><span class="line"> +-- KeyboardInterrupt            # Raised when the user hits the interrupt key (ctrl-c).</span><br><span class="line"> +-- Exception                    # User-defined exceptions should be derived from this class.</span><br><span class="line">      +-- StopIteration           # Raised by next() when run on an empty iterator.</span><br><span class="line">      +-- ArithmeticError         # Base class for arithmetic errors.</span><br><span class="line">      |    +-- ZeroDivisionError  # Raised when dividing by zero.</span><br><span class="line">      +-- AttributeError          # Raised when an attribute is missing.</span><br><span class="line">      +-- EOFError                # Raised by input() when it hits end-of-file condition.</span><br><span class="line">      +-- LookupError             # Raised when a look-up on a collection fails.</span><br><span class="line">      |    +-- IndexError         # Raised when a sequence index is out of range.</span><br><span class="line">      |    +-- KeyError           # Raised when a dictionary key or set element is not found.</span><br><span class="line">      +-- NameError               # Raised when a variable name is not found.</span><br><span class="line">      +-- OSError                 # Failures such as “file not found” or “disk full”.</span><br><span class="line">      |    +-- FileNotFoundError  # When a file or directory is requested but doesn&#39;t exist.</span><br><span class="line">      +-- RuntimeError            # Raised by errors that don&#39;t fall in other categories.</span><br><span class="line">      |    +-- RecursionError     # Raised when the the maximum recursion depth is exceeded.</span><br><span class="line">      +-- TypeError               # Raised when an argument is of wrong type.</span><br><span class="line">      +-- ValueError              # When an argument is of right type but inappropriate value.</span><br><span class="line">           +-- UnicodeError       # Raised when encoding&#x2F;decoding strings from&#x2F;to bytes fails.</span><br></pre></td></tr></table></figure>

<h4 id="Collections-and-their-exceptions"><a href="#Collections-and-their-exceptions" class="headerlink" title="Collections and their exceptions:"></a>Collections and their exceptions:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+-----------+------------+------------+------------+</span><br><span class="line">|           |    list    |    dict    |    set     |</span><br><span class="line">+-----------+------------+------------+------------+</span><br><span class="line">| getitem() | IndexError |  KeyError  |            |</span><br><span class="line">| pop()     | IndexError |  KeyError  |  KeyError  |</span><br><span class="line">| remove()  | ValueError |            |  KeyError  |</span><br><span class="line">| index()   | ValueError |            |            |</span><br><span class="line">+-----------+------------+------------+------------+</span><br></pre></td></tr></table></figure>

<h3 id="User-defined-Exceptions"><a href="#User-defined-Exceptions" class="headerlink" title="User-defined Exceptions"></a>User-defined Exceptions</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyError</span><span class="params">(Exception)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyInputError</span><span class="params">(MyError)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>


<h2 id="Print"><a href="#Print" class="headerlink" title="Print"></a>Print</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(&lt;el_1&gt;, ..., sep=<span class="string">' '</span>, end=<span class="string">'\n'</span>, file=sys.stdout, flush=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Use <code>&#39;file=sys.stderr&#39;</code> for errors.</strong></li>
<li><strong>Use <code>&#39;flush=True&#39;</code> to forcibly flush the stream.</strong></li>
</ul>
<h3 id="Pretty-Print"><a href="#Pretty-Print" class="headerlink" title="Pretty Print"></a>Pretty Print</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint</span><br><span class="line">pprint(&lt;collection&gt;, width=<span class="number">80</span>, depth=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Levels deeper than ‘depth’ get replaced by ‘…’.</strong></li>
</ul>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p><strong>Reads a line from user input or pipe if present.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;str&gt; = input(prompt=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Trailing newline gets stripped.</strong></li>
<li><strong>Prompt string is printed to the standard output before reading input.</strong></li>
<li><strong>Raises EOFError when user hits EOF (ctrl-d) or input stream gets exhausted.</strong></li>
</ul>
<h2 id="Command-Line-Arguments"><a href="#Command-Line-Arguments" class="headerlink" title="Command Line Arguments"></a>Command Line Arguments</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">script_name = sys.argv[<span class="number">0</span>]</span><br><span class="line">arguments   = sys.argv[<span class="number">1</span>:]</span><br></pre></td></tr></table></figure>

<h3 id="Argparse"><a href="#Argparse" class="headerlink" title="Argparse"></a>Argparse</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> argparse <span class="keyword">import</span> ArgumentParser, FileType</span><br><span class="line">p = ArgumentParser(description=&lt;str&gt;)</span><br><span class="line">p.add_argument(<span class="string">'-&lt;short_name&gt;'</span>, <span class="string">'--&lt;name&gt;'</span>, action=<span class="string">'store_true'</span>)  <span class="comment"># Flag</span></span><br><span class="line">p.add_argument(<span class="string">'-&lt;short_name&gt;'</span>, <span class="string">'--&lt;name&gt;'</span>, type=&lt;type&gt;)          <span class="comment"># Option</span></span><br><span class="line">p.add_argument(<span class="string">'&lt;name&gt;'</span>, type=&lt;type&gt;, nargs=<span class="number">1</span>)                    <span class="comment"># First argument</span></span><br><span class="line">p.add_argument(<span class="string">'&lt;name&gt;'</span>, type=&lt;type&gt;, nargs=<span class="string">'+'</span>)                  <span class="comment"># Remaining arguments</span></span><br><span class="line">p.add_argument(<span class="string">'&lt;name&gt;'</span>, type=&lt;type&gt;, nargs=<span class="string">'*'</span>)                  <span class="comment"># Optional arguments</span></span><br><span class="line">args  = p.parse_args()                                            <span class="comment"># Exits on error.</span></span><br><span class="line">value = args.&lt;name&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Use <code>&#39;help=&lt;str&gt;&#39;</code> to set argument description.</strong></li>
<li><strong>Use <code>&#39;default=&lt;el&gt;&#39;</code> to set the default value.</strong></li>
<li><strong>Use <code>&#39;type=FileType(&lt;mode&gt;)&#39;</code> for files.</strong></li>
</ul>
<h2 id="Open"><a href="#Open" class="headerlink" title="Open"></a>Open</h2><p><strong>Opens the file and returns a corresponding file object.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;file&gt; = open(<span class="string">'&lt;path&gt;'</span>, mode=<span class="string">'r'</span>, encoding=<span class="literal">None</span>, newline=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>&#39;encoding=None&#39;</code> means that the default encoding is used, which is platform dependent. Best practice is to use <code>&#39;encoding=&quot;utf-8&quot;&#39;</code> whenever possible.</strong></li>
<li><strong><code>&#39;newline=None&#39;</code> means all different end of line combinations are converted to ‘\n’ on read, while on write all ‘\n’ characters are converted to system’s default line separator.</strong></li>
<li><strong><code>&#39;newline=&quot;&quot;&#39;</code> means no conversions take place, but input is still broken into chunks by readline() and readlines() on either ‘\n’, ‘\r’ or ‘\r\n’.</strong></li>
</ul>
<h3 id="Modes"><a href="#Modes" class="headerlink" title="Modes"></a>Modes</h3><ul>
<li><strong><code>&#39;r&#39;</code>  - Read (default).</strong></li>
<li><strong><code>&#39;w&#39;</code>  - Write (truncate).</strong></li>
<li><strong><code>&#39;x&#39;</code>  - Write or fail if the file already exists.</strong></li>
<li><strong><code>&#39;a&#39;</code>  - Append.</strong></li>
<li><strong><code>&#39;w+&#39;</code> - Read and write (truncate).</strong></li>
<li><strong><code>&#39;r+&#39;</code> - Read and write from the start.</strong></li>
<li><strong><code>&#39;a+&#39;</code> - Read and write from the end.</strong></li>
<li><strong><code>&#39;t&#39;</code>  - Text mode (default).</strong></li>
<li><strong><code>&#39;b&#39;</code>  - Binary mode.</strong></li>
</ul>
<h3 id="Exceptions-1"><a href="#Exceptions-1" class="headerlink" title="Exceptions"></a>Exceptions</h3><ul>
<li><strong><code>&#39;FileNotFoundError&#39;</code> can be risen when reading with <code>&#39;r&#39;</code> or <code>&#39;r+&#39;</code>.</strong></li>
<li><strong><code>&#39;FileExistsError&#39;</code> can be risen when writing with <code>&#39;x&#39;</code>.</strong></li>
<li><strong><code>&#39;IsADirectoryError&#39;</code> and <code>&#39;PermissionError&#39;</code> can be risen by any.</strong></li>
<li><strong><code>&#39;OSError&#39;</code> is the parent class of all listed exceptions.</strong></li>
</ul>
<h3 id="File-Object"><a href="#File-Object" class="headerlink" title="File Object"></a>File Object</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;file&gt;.seek(<span class="number">0</span>)                      <span class="comment"># Moves to the start of the file.</span></span><br><span class="line">&lt;file&gt;.seek(offset)                 <span class="comment"># Moves 'offset' chars/bytes from the start.</span></span><br><span class="line">&lt;file&gt;.seek(<span class="number">0</span>, <span class="number">2</span>)                   <span class="comment"># Moves to the end of the file.</span></span><br><span class="line">&lt;bin_file&gt;.seek(±offset, &lt;anchor&gt;)  <span class="comment"># Anchor: 0 start, 1 current pos., 2 end.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;str/bytes&gt; = &lt;file&gt;.read(size=<span class="number">-1</span>)  <span class="comment"># Reads 'size' chars/bytes or until EOF.</span></span><br><span class="line">&lt;str/bytes&gt; = &lt;file&gt;.readline()     <span class="comment"># Returns a line or empty string/bytes on EOF.</span></span><br><span class="line">&lt;list&gt;      = &lt;file&gt;.readlines()    <span class="comment"># Returns a list of remaining lines.</span></span><br><span class="line">&lt;str/bytes&gt; = next(&lt;file&gt;)          <span class="comment"># Returns a line using buffer. Do not mix.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;file&gt;.write(&lt;str/bytes&gt;)           <span class="comment"># Writes a string or bytes object.</span></span><br><span class="line">&lt;file&gt;.writelines(&lt;collection&gt;)     <span class="comment"># Writes a coll. of strings or bytes objects.</span></span><br><span class="line">&lt;file&gt;.flush()                      <span class="comment"># Flushes write buffer.</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Methods do not add or strip trailing newlines, even writelines().</strong></li>
</ul>
<h3 id="Read-Text-from-File"><a href="#Read-Text-from-File" class="headerlink" title="Read Text from File"></a>Read Text from File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_file</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> file.readlines()</span><br></pre></td></tr></table></figure>

<h3 id="Write-Text-to-File"><a href="#Write-Text-to-File" class="headerlink" title="Write Text to File"></a>Write Text to File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to_file</span><span class="params">(filename, text)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(text)</span><br></pre></td></tr></table></figure>


<h2 id="Path"><a href="#Path" class="headerlink" title="Path"></a>Path</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> getcwd, path, listdir</span><br><span class="line"><span class="keyword">from</span> glob <span class="keyword">import</span> glob</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;str&gt;  = getcwd()                   <span class="comment"># Returns the current working directory.</span></span><br><span class="line">&lt;str&gt;  = path.join(&lt;path&gt;, ...)     <span class="comment"># Joins two or more pathname components.</span></span><br><span class="line">&lt;str&gt;  = path.abspath(&lt;path&gt;)       <span class="comment"># Return an absolute path.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;str&gt;  = path.basename(&lt;path&gt;)      <span class="comment"># Returns final component.</span></span><br><span class="line">&lt;str&gt;  = path.dirname(&lt;path&gt;)       <span class="comment"># Returns path without final component.</span></span><br><span class="line">&lt;tup.&gt; = path.splitext(&lt;path&gt;)      <span class="comment"># Splits on last period of final component.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;list&gt; = listdir(path=<span class="string">'.'</span>)          <span class="comment"># Returns filenames located at path.</span></span><br><span class="line">&lt;list&gt; = glob(<span class="string">'&lt;pattern&gt;'</span>)          <span class="comment"># Returns paths matching the wildcard pattern.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;bool&gt; = path.exists(&lt;path&gt;)        <span class="comment"># Or: &lt;Path&gt;.exists()</span></span><br><span class="line">&lt;bool&gt; = path.isfile(&lt;path&gt;)        <span class="comment"># Or: &lt;DirEntry/Path&gt;.is_file()</span></span><br><span class="line">&lt;bool&gt; = path.isdir(&lt;path&gt;)         <span class="comment"># Or: &lt;DirEntry/Path&gt;.is_dir()</span></span><br></pre></td></tr></table></figure>

<h3 id="DirEntry"><a href="#DirEntry" class="headerlink" title="DirEntry"></a>DirEntry</h3><p><strong>Using scandir() instead of listdir() can significantly increase the performance of code that also needs file type information.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> scandir</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;iter&gt; = scandir(path=<span class="string">'.'</span>)          <span class="comment"># Returns DirEntry objects located at path.</span></span><br><span class="line">&lt;str&gt;  = &lt;DirEntry&gt;.path            <span class="comment"># Returns path as a string.</span></span><br><span class="line">&lt;str&gt;  = &lt;DirEntry&gt;.name            <span class="comment"># Returns final component as a string.</span></span><br><span class="line">&lt;file&gt; = open(&lt;DirEntry&gt;)           <span class="comment"># Opens the file and returns a file object.</span></span><br></pre></td></tr></table></figure>

<h3 id="Path-Object"><a href="#Path-Object" class="headerlink" title="Path Object"></a>Path Object</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;Path&gt; = Path(&lt;path&gt; [, ...])       <span class="comment"># Accepts strings, Paths and DirEntry objects.</span></span><br><span class="line">&lt;Path&gt; = &lt;path&gt; / &lt;path&gt; [/ ...]    <span class="comment"># One of the paths must be a Path object.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Path&gt; = Path()                     <span class="comment"># Returns relative cwd. Also Path('.').</span></span><br><span class="line">&lt;Path&gt; = Path.cwd()                 <span class="comment"># Returns absolute cwd. Also Path().resolve().</span></span><br><span class="line">&lt;Path&gt; = &lt;Path&gt;.resolve()           <span class="comment"># Returns absolute Path without symlinks.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Path&gt; = &lt;Path&gt;.parent              <span class="comment"># Returns Path without final component.</span></span><br><span class="line">&lt;str&gt;  = &lt;Path&gt;.name                <span class="comment"># Returns final component as a string.</span></span><br><span class="line">&lt;str&gt;  = &lt;Path&gt;.stem                <span class="comment"># Returns final component without extension.</span></span><br><span class="line">&lt;str&gt;  = &lt;Path&gt;.suffix              <span class="comment"># Returns final component's extension.</span></span><br><span class="line">&lt;tup.&gt; = &lt;Path&gt;.parts               <span class="comment"># Returns all components as strings.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;iter&gt; = &lt;Path&gt;.iterdir()           <span class="comment"># Returns dir contents as Path objects.</span></span><br><span class="line">&lt;iter&gt; = &lt;Path&gt;.glob(<span class="string">'&lt;pattern&gt;'</span>)   <span class="comment"># Returns Paths matching the wildcard pattern.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;str&gt;  = str(&lt;Path&gt;)                <span class="comment"># Returns path as a string.</span></span><br><span class="line">&lt;file&gt; = open(&lt;Path&gt;)               <span class="comment"># Opens the file and returns a file object.</span></span><br></pre></td></tr></table></figure>


<h2 id="OS-Commands"><a href="#OS-Commands" class="headerlink" title="OS Commands"></a>OS Commands</h2><h3 id="Files-and-Directories"><a href="#Files-and-Directories" class="headerlink" title="Files and Directories"></a>Files and Directories</h3><ul>
<li><strong>Paths can be either strings, Paths, or DirEntry objects.</strong></li>
<li><strong>Functions report OS related errors by raising either OSError or one of its <a href="#exceptions-1">subclasses</a>.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os, shutil</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">os.chdir(&lt;path&gt;)                    <span class="comment"># Changes current working directory.</span></span><br><span class="line">os.mkdir(&lt;path&gt;, mode=<span class="number">0o777</span>)        <span class="comment"># Creates a directory. Mode is in octal.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shutil.copy(<span class="keyword">from</span>, to)               <span class="comment"># Copies the file.</span></span><br><span class="line">shutil.copytree(<span class="keyword">from</span>, to)           <span class="comment"># Copies the directory.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">os.rename(<span class="keyword">from</span>, to)                 <span class="comment"># Renames the file or directory.</span></span><br><span class="line">os.replace(<span class="keyword">from</span>, to)                <span class="comment"># Same, but overwrites 'to' if it exists.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">os.remove(&lt;path&gt;)                   <span class="comment"># Deletes the file.</span></span><br><span class="line">os.rmdir(&lt;path&gt;)                    <span class="comment"># Deletes empty directory.</span></span><br><span class="line">shutil.rmtree(&lt;path&gt;)               <span class="comment"># Deletes non-empty directory.</span></span><br></pre></td></tr></table></figure>

<h3 id="Shell-Commands"><a href="#Shell-Commands" class="headerlink" title="Shell Commands"></a>Shell Commands</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">&lt;str&gt; = os.popen(<span class="string">'&lt;shell_command&gt;'</span>).read()</span><br></pre></td></tr></table></figure>

<h4 id="Using-subprocess"><a href="#Using-subprocess" class="headerlink" title="Using subprocess:"></a>Using subprocess:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> subprocess, shlex</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = subprocess.run(shlex.split(<span class="string">'ls -a'</span>), stdout=subprocess.PIPE)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.stdout</span><br><span class="line"><span class="string">b'.\n..\nfile1.txt\nfile2.txt\n'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.returncode</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>


<h2 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h2><p><strong>Text file format for storing collections of strings and numbers.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line">&lt;str&gt;    = json.dumps(&lt;object&gt;, ensure_ascii=<span class="literal">True</span>, indent=<span class="literal">None</span>)</span><br><span class="line">&lt;object&gt; = json.loads(&lt;str&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="Read-Object-from-JSON-File"><a href="#Read-Object-from-JSON-File" class="headerlink" title="Read Object from JSON File"></a>Read Object from JSON File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_json_file</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> json.load(file)</span><br></pre></td></tr></table></figure>

<h3 id="Write-Object-to-JSON-File"><a href="#Write-Object-to-JSON-File" class="headerlink" title="Write Object to JSON File"></a>Write Object to JSON File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to_json_file</span><span class="params">(filename, an_object)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        json.dump(an_object, file, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Pickle"><a href="#Pickle" class="headerlink" title="Pickle"></a>Pickle</h2><p><strong>Binary file format for storing objects.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line">&lt;bytes&gt;  = pickle.dumps(&lt;object&gt;)</span><br><span class="line">&lt;object&gt; = pickle.loads(&lt;bytes&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="Read-Object-from-File"><a href="#Read-Object-from-File" class="headerlink" title="Read Object from File"></a>Read Object from File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_pickle_file</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">'rb'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> pickle.load(file)</span><br></pre></td></tr></table></figure>

<h3 id="Write-Object-to-File"><a href="#Write-Object-to-File" class="headerlink" title="Write Object to File"></a>Write Object to File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to_pickle_file</span><span class="params">(filename, an_object)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">'wb'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        pickle.dump(an_object, file)</span><br></pre></td></tr></table></figure>


<h2 id="CSV"><a href="#CSV" class="headerlink" title="CSV"></a>CSV</h2><p><strong>Text file format for storing spreadsheets.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br></pre></td></tr></table></figure>

<h3 id="Read"><a href="#Read" class="headerlink" title="Read"></a>Read</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;reader&gt; = csv.reader(&lt;file&gt;, dialect=<span class="string">'excel'</span>, delimiter=<span class="string">','</span>)</span><br><span class="line">&lt;list&gt;   = next(&lt;reader&gt;)           <span class="comment"># Returns next row as a list of strings.</span></span><br><span class="line">&lt;list&gt;   = list(&lt;reader&gt;)           <span class="comment"># Returns list of remaining rows.</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>File must be opened with <code>&#39;newline=&quot;&quot;&#39;</code> argument, or newlines embedded inside quoted fields will not be interpreted correctly!</strong></li>
</ul>
<h3 id="Write"><a href="#Write" class="headerlink" title="Write"></a>Write</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;writer&gt; = csv.writer(&lt;file&gt;, dialect=<span class="string">'excel'</span>, delimiter=<span class="string">','</span>)</span><br><span class="line">&lt;writer&gt;.writerow(&lt;collection&gt;)     <span class="comment"># Encodes objects using `str(&lt;el&gt;)`.</span></span><br><span class="line">&lt;writer&gt;.writerows(&lt;coll_of_coll&gt;)  <span class="comment"># Appends multiple rows.</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>File must be opened with <code>&#39;newline=&quot;&quot;&#39;</code> argument, or an extra ‘\r’ will be added on platforms that use ‘\r\n’ linendings!</strong></li>
</ul>
<h3 id="Parameters"><a href="#Parameters" class="headerlink" title="Parameters"></a>Parameters</h3><ul>
<li><strong><code>&#39;dialect&#39;</code> - Master parameter that sets the default values.</strong></li>
<li><strong><code>&#39;delimiter&#39;</code> - A one-character string used to separate fields.</strong></li>
<li><strong><code>&#39;quotechar&#39;</code> - Character for quoting fields that contain special characters.</strong></li>
<li><strong><code>&#39;doublequote&#39;</code> - Whether quotechars inside fields get doubled or escaped.</strong></li>
<li><strong><code>&#39;skipinitialspace&#39;</code> - Whether whitespace after delimiter gets stripped.</strong></li>
<li><strong><code>&#39;lineterminator&#39;</code> - How does writer terminate lines.</strong></li>
<li><strong><code>&#39;quoting&#39;</code> - Controls the amount of quoting: 0 - as necessary, 1 - all.</strong></li>
<li><strong><code>&#39;escapechar&#39;</code> - Character for escaping ‘quotechar’ if ‘doublequote’ is false.</strong></li>
</ul>
<h3 id="Dialects"><a href="#Dialects" class="headerlink" title="Dialects"></a>Dialects</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+------------------+--------------+--------------+--------------+</span><br><span class="line">|                  |     excel    |   excel-tab  |     unix     |</span><br><span class="line">+------------------+--------------+--------------+--------------+</span><br><span class="line">| delimiter        |       &#39;,&#39;    |      &#39;\t&#39;    |       &#39;,&#39;    |</span><br><span class="line">| quotechar        |       &#39;&quot;&#39;    |       &#39;&quot;&#39;    |       &#39;&quot;&#39;    |</span><br><span class="line">| doublequote      |      True    |      True    |      True    |</span><br><span class="line">| skipinitialspace |     False    |     False    |     False    |</span><br><span class="line">| lineterminator   |    &#39;\r\n&#39;    |    &#39;\r\n&#39;    |      &#39;\n&#39;    |</span><br><span class="line">| quoting          |         0    |         0    |         1    |</span><br><span class="line">| escapechar       |      None    |      None    |      None    |</span><br><span class="line">+------------------+--------------+--------------+--------------+</span><br></pre></td></tr></table></figure>

<h3 id="Read-Rows-from-CSV-File"><a href="#Read-Rows-from-CSV-File" class="headerlink" title="Read Rows from CSV File"></a>Read Rows from CSV File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_csv_file</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, encoding=<span class="string">'utf-8'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> list(csv.reader(file))</span><br></pre></td></tr></table></figure>

<h3 id="Write-Rows-to-CSV-File"><a href="#Write-Rows-to-CSV-File" class="headerlink" title="Write Rows to CSV File"></a>Write Rows to CSV File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to_csv_file</span><span class="params">(filename, rows)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> file:</span><br><span class="line">        writer = csv.writer(file)</span><br><span class="line">        writer.writerows(rows)</span><br></pre></td></tr></table></figure>


<h2 id="SQLite"><a href="#SQLite" class="headerlink" title="SQLite"></a>SQLite</h2><p><strong>Server-less database engine that stores each database into separate file.</strong></p>
<h3 id="Connect"><a href="#Connect" class="headerlink" title="Connect"></a>Connect</h3><p><strong>Opens a connection to the database file. Creates a new file if path doesn’t exist.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line">db = sqlite3.connect(<span class="string">'&lt;path&gt;'</span>)                  <span class="comment"># Also ':memory:'.</span></span><br><span class="line">...</span><br><span class="line">db.close()</span><br></pre></td></tr></table></figure>

<h3 id="Read-1"><a href="#Read-1" class="headerlink" title="Read"></a>Read</h3><p><strong>Returned values can be of type str, int, float, bytes or None.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;cursor&gt; = db.execute(<span class="string">'&lt;query&gt;'</span>)                <span class="comment"># Can raise sqlite3.OperationalError.</span></span><br><span class="line">&lt;tuple&gt;  = &lt;cursor&gt;.fetchone()                  <span class="comment"># Returns next row. Also next(&lt;cursor&gt;).</span></span><br><span class="line">&lt;list&gt;   = &lt;cursor&gt;.fetchall()                  <span class="comment"># Returns remaining rows.</span></span><br></pre></td></tr></table></figure>

<h3 id="Write-1"><a href="#Write-1" class="headerlink" title="Write"></a>Write</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.execute(<span class="string">'&lt;query&gt;'</span>)</span><br><span class="line">db.commit()</span><br></pre></td></tr></table></figure>

<h4 id="Or"><a href="#Or" class="headerlink" title="Or:"></a>Or:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> db:</span><br><span class="line">    db.execute(<span class="string">'&lt;query&gt;'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Placeholders"><a href="#Placeholders" class="headerlink" title="Placeholders"></a>Placeholders</h3><ul>
<li><strong>Passed values can be of type str, int, float, bytes, None, bool, datetime.date or datetime.datetme.</strong></li>
<li><strong>Bools will be stored and returned as ints and dates as <a href="#encode">ISO formatted strings</a>.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.execute(<span class="string">'&lt;query&gt;'</span>, &lt;list/tuple&gt;)             <span class="comment"># Replaces '?'s in query with values.</span></span><br><span class="line">db.execute(<span class="string">'&lt;query&gt;'</span>, &lt;dict/namedtuple&gt;)        <span class="comment"># Replaces ':&lt;key&gt;'s with values.</span></span><br><span class="line">db.executemany(<span class="string">'&lt;query&gt;'</span>, &lt;coll_of_above&gt;)      <span class="comment"># Runs execute() many times.</span></span><br></pre></td></tr></table></figure>

<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p><strong>In this example values are not actually saved because <code>&#39;db.commit()&#39;</code> is omitted!</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>db = sqlite3.connect(<span class="string">'test.db'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>db.execute(<span class="string">'create table t (a, b, c)'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>db.execute(<span class="string">'insert into t values (1, 2, 3)'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>db.execute(<span class="string">'select * from t'</span>).fetchall()</span><br><span class="line">[(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)]</span><br></pre></td></tr></table></figure>

<h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><p><strong>Has a very similar interface, with differences listed below.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install mysql-connector</span></span><br><span class="line"><span class="keyword">from</span> mysql <span class="keyword">import</span> connector</span><br><span class="line">db = connector.connect(host=&lt;str&gt;, user=&lt;str&gt;, password=&lt;str&gt;, database=&lt;str&gt;)</span><br><span class="line">&lt;cursor&gt; = db.cursor()</span><br><span class="line">&lt;cursor&gt;.execute(<span class="string">'&lt;query&gt;'</span>)                     <span class="comment"># Only cursor has execute method.</span></span><br><span class="line">&lt;cursor&gt;.execute(<span class="string">'&lt;query&gt;'</span>, &lt;list/tuple&gt;)       <span class="comment"># Replaces '%s's in query with values.</span></span><br><span class="line">&lt;cursor&gt;.execute(<span class="string">'&lt;query&gt;'</span>, &lt;dict/namedtuple&gt;)  <span class="comment"># Replaces '%(&lt;key&gt;)s's with values.</span></span><br></pre></td></tr></table></figure>


<h2 id="Bytes"><a href="#Bytes" class="headerlink" title="Bytes"></a>Bytes</h2><p><strong>Bytes object is an immutable sequence of single bytes. Mutable version is called bytearray.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;bytes&gt; = <span class="string">b'&lt;str&gt;'</span>                       <span class="comment"># Only accepts ASCII characters and \x00 - \xff.</span></span><br><span class="line">&lt;int&gt;   = &lt;bytes&gt;[&lt;index&gt;]               <span class="comment"># Returns int in range from 0 to 255.</span></span><br><span class="line">&lt;bytes&gt; = &lt;bytes&gt;[&lt;slice&gt;]               <span class="comment"># Returns bytes even if it has only one element.</span></span><br><span class="line">&lt;bytes&gt; = &lt;bytes&gt;.join(&lt;coll_of_bytes&gt;)  <span class="comment"># Joins elements using bytes object as separator.</span></span><br></pre></td></tr></table></figure>

<h3 id="Encode-1"><a href="#Encode-1" class="headerlink" title="Encode"></a>Encode</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;bytes&gt; = bytes(&lt;coll_of_ints&gt;)          <span class="comment"># Ints must be in range from 0 to 255.</span></span><br><span class="line">&lt;bytes&gt; = bytes(&lt;str&gt;, <span class="string">'utf-8'</span>)          <span class="comment"># Or: &lt;str&gt;.encode('utf-8')</span></span><br><span class="line">&lt;bytes&gt; = &lt;int&gt;.to_bytes(n_bytes, byteorder=<span class="string">'big/little'</span>, signed=<span class="literal">False</span>)</span><br><span class="line">&lt;bytes&gt; = bytes.fromhex(<span class="string">'&lt;hex&gt;'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Decode-1"><a href="#Decode-1" class="headerlink" title="Decode"></a>Decode</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;list&gt;  = list(&lt;bytes&gt;)                  <span class="comment"># Returns ints in range from 0 to 255.</span></span><br><span class="line">&lt;str&gt;   = str(&lt;bytes&gt;, <span class="string">'utf-8'</span>)          <span class="comment"># Or: &lt;bytes&gt;.decode('utf-8')</span></span><br><span class="line">&lt;int&gt;   = int.from_bytes(&lt;bytes&gt;, byteorder=<span class="string">'big/little'</span>, signed=<span class="literal">False</span>)</span><br><span class="line"><span class="string">'&lt;hex&gt;'</span> = &lt;bytes&gt;.hex()</span><br></pre></td></tr></table></figure>

<h3 id="Read-Bytes-from-File"><a href="#Read-Bytes-from-File" class="headerlink" title="Read Bytes from File"></a>Read Bytes from File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_bytes</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">'rb'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> file.read()</span><br></pre></td></tr></table></figure>

<h3 id="Write-Bytes-to-File"><a href="#Write-Bytes-to-File" class="headerlink" title="Write Bytes to File"></a>Write Bytes to File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_bytes</span><span class="params">(filename, bytes_obj)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">'wb'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(bytes_obj)</span><br></pre></td></tr></table></figure>


<h2 id="Struct"><a href="#Struct" class="headerlink" title="Struct"></a>Struct</h2><ul>
<li><strong>Module that performs conversions between a sequence of numbers and a bytes object.</strong></li>
<li><strong>Machine’s native type sizes and byte order are used by default.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack, unpack, iter_unpack</span><br><span class="line">&lt;bytes&gt;  = pack(<span class="string">'&lt;format&gt;'</span>, &lt;num_1&gt; [, &lt;num_2&gt;, ...])</span><br><span class="line">&lt;tuple&gt;  = unpack(<span class="string">'&lt;format&gt;'</span>, &lt;bytes&gt;)</span><br><span class="line">&lt;tuples&gt; = iter_unpack(<span class="string">'&lt;format&gt;'</span>, &lt;bytes&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>pack(<span class="string">'&gt;hhl'</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="string">b'\x00\x01\x00\x02\x00\x00\x00\x03'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>unpack(<span class="string">'&gt;hhl'</span>, <span class="string">b'\x00\x01\x00\x02\x00\x00\x00\x03'</span>)</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Format-2"><a href="#Format-2" class="headerlink" title="Format"></a>Format</h3><h4 id="For-standard-sizes-start-format-string-with"><a href="#For-standard-sizes-start-format-string-with" class="headerlink" title="For standard sizes start format string with:"></a>For standard sizes start format string with:</h4><ul>
<li><strong><code>&#39;=&#39;</code> - native byte order</strong></li>
<li><strong><code>&#39;&lt;&#39;</code> - little-endian</strong></li>
<li><strong><code>&#39;&gt;&#39;</code> - big-endian (also <code>&#39;!&#39;</code>)</strong></li>
</ul>
<h4 id="Integer-types-Use-capital-letter-for-unsigned-type-Standard-sizes-are-in-brackets"><a href="#Integer-types-Use-capital-letter-for-unsigned-type-Standard-sizes-are-in-brackets" class="headerlink" title="Integer types. Use capital letter for unsigned type. Standard sizes are in brackets:"></a>Integer types. Use capital letter for unsigned type. Standard sizes are in brackets:</h4><ul>
<li><strong><code>&#39;x&#39;</code> - pad byte</strong></li>
<li><strong><code>&#39;b&#39;</code> - char (1)</strong></li>
<li><strong><code>&#39;h&#39;</code> - short (2)</strong></li>
<li><strong><code>&#39;i&#39;</code> - int (4)</strong></li>
<li><strong><code>&#39;l&#39;</code> - long (4)</strong></li>
<li><strong><code>&#39;q&#39;</code> - long long (8)</strong></li>
</ul>
<h4 id="Floating-point-types"><a href="#Floating-point-types" class="headerlink" title="Floating point types:"></a>Floating point types:</h4><ul>
<li><strong><code>&#39;f&#39;</code> - float (4)</strong></li>
<li><strong><code>&#39;d&#39;</code> - double (8)</strong></li>
</ul>
<h2 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h2><p><strong>List that can only hold numbers of a predefined type. Available types and their sizes in bytes are listed above.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> array <span class="keyword">import</span> array</span><br><span class="line">&lt;array&gt; = array(<span class="string">'&lt;typecode&gt;'</span>, &lt;collection&gt;)    <span class="comment"># Array from coll. of numbers.</span></span><br><span class="line">&lt;array&gt; = array(<span class="string">'&lt;typecode&gt;'</span>, &lt;bytes&gt;)         <span class="comment"># Array from bytes object.</span></span><br><span class="line">&lt;bytes&gt; = bytes(&lt;array&gt;)                       <span class="comment"># Or: &lt;array&gt;.tobytes()</span></span><br></pre></td></tr></table></figure>


<h2 id="Memory-View"><a href="#Memory-View" class="headerlink" title="Memory View"></a>Memory View</h2><ul>
<li><strong>A sequence object that points to the memory of another object.</strong></li>
<li><strong>Each element can reference a single or multiple consecutive bytes, depending on format.</strong></li>
<li><strong>Order and number of elements can be changed with slicing.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;mview&gt; = memoryview(&lt;bytes/bytearray/array&gt;)  <span class="comment"># Immutable if bytes, else mutable.</span></span><br><span class="line">&lt;real&gt;  = &lt;mview&gt;[&lt;index&gt;]                     <span class="comment"># Returns an int or a float.</span></span><br><span class="line">&lt;mview&gt; = &lt;mview&gt;[&lt;slice&gt;]                     <span class="comment"># Mview with rearranged elements.</span></span><br><span class="line">&lt;mview&gt; = &lt;mview&gt;.cast(<span class="string">'&lt;typecode&gt;'</span>)           <span class="comment"># Casts memoryview to the new format.</span></span><br><span class="line">&lt;mview&gt;.release()                              <span class="comment"># Releases the object's memory buffer.</span></span><br></pre></td></tr></table></figure>

<h3 id="Decode-2"><a href="#Decode-2" class="headerlink" title="Decode"></a>Decode</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;bin_file&gt;.write(&lt;mview&gt;)                      <span class="comment"># Appends mview to the binary file.</span></span><br><span class="line">&lt;bytes&gt; = bytes(&lt;mview&gt;)                       <span class="comment"># Creates a new bytes object.</span></span><br><span class="line">&lt;bytes&gt; = &lt;bytes&gt;.join(&lt;coll_of_mviews&gt;)       <span class="comment"># Joins mviews using bytes object as sep.</span></span><br><span class="line">&lt;list&gt;  = list(&lt;mview&gt;)                        <span class="comment"># Returns list of ints or floats.</span></span><br><span class="line">&lt;str&gt;   = str(&lt;mview&gt;, <span class="string">'utf-8'</span>)                <span class="comment"># Treats mview as a seqence of bytes.</span></span><br><span class="line">&lt;int&gt;   = int.from_bytes(&lt;mview&gt;, byteorder=<span class="string">'big/little'</span>, signed=<span class="literal">False</span>)</span><br><span class="line"><span class="string">'&lt;hex&gt;'</span> = &lt;mview&gt;.hex()</span><br></pre></td></tr></table></figure>


<h2 id="Deque"><a href="#Deque" class="headerlink" title="Deque"></a>Deque</h2><p><strong>A thread-safe list with efficient appends and pops from either side. Pronounced “deck”.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line">&lt;deque&gt; = deque(&lt;collection&gt;, maxlen=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;deque&gt;.appendleft(&lt;el&gt;)                       <span class="comment"># Opposite element is dropped if full.</span></span><br><span class="line">&lt;el&gt; = &lt;deque&gt;.popleft()                       <span class="comment"># Raises IndexError if empty.</span></span><br><span class="line">&lt;deque&gt;.extendleft(&lt;collection&gt;)               <span class="comment"># Collection gets reversed.</span></span><br><span class="line">&lt;deque&gt;.rotate(n=<span class="number">1</span>)                            <span class="comment"># Rotates elements to the right.</span></span><br></pre></td></tr></table></figure>


<h2 id="Threading"><a href="#Threading" class="headerlink" title="Threading"></a>Threading</h2><ul>
<li><strong>CPython interpreter can only run a single thread at a time.</strong></li>
<li><strong>That is why using multiple threads won’t result in a faster execution, unless there is an I/O operation in the thread.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread, RLock</span><br></pre></td></tr></table></figure>

<h3 id="Thread"><a href="#Thread" class="headerlink" title="Thread"></a>Thread</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">thread = Thread(target=&lt;function&gt;, args=(&lt;first_arg&gt;, ))</span><br><span class="line">thread.start()</span><br><span class="line">...</span><br><span class="line">&lt;bool&gt; = thread.is_alive()           <span class="comment"># Checks if thread has finished executing.</span></span><br><span class="line">thread.join()                        <span class="comment"># Waits for thread to finish.</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Use <code>&#39;kwargs=&lt;dict&gt;&#39;</code> to pass keyword arguments to the function.</strong></li>
<li><strong>Use <code>&#39;daemon=True&#39;</code>, or the program will not be able to exit while the thread is alive.</strong></li>
</ul>
<h3 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lock = RLock()</span><br><span class="line">lock.acquire()                       <span class="comment"># Waits for lock to be available.</span></span><br><span class="line">...</span><br><span class="line">lock.release()</span><br></pre></td></tr></table></figure>

<h4 id="Or-1"><a href="#Or-1" class="headerlink" title="Or:"></a>Or:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lock = RLock()</span><br><span class="line"><span class="keyword">with</span> lock:</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<h3 id="Thread-Pool-Executor"><a href="#Thread-Pool-Executor" class="headerlink" title="Thread Pool Executor"></a>Thread Pool Executor</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"><span class="keyword">with</span> ThreadPoolExecutor(max_workers=<span class="literal">None</span>) <span class="keyword">as</span> executor:</span><br><span class="line">    &lt;iter&gt;   = executor.map(<span class="keyword">lambda</span> x: x + <span class="number">1</span>, range(<span class="number">3</span>))         <span class="comment"># (1, 2, 3)</span></span><br><span class="line">    &lt;iter&gt;   = executor.map(<span class="keyword">lambda</span> x, y: x + y, <span class="string">'abc'</span>, <span class="string">'123'</span>)  <span class="comment"># ('a1', 'b2', 'c3')</span></span><br><span class="line">    &lt;Future&gt; = executor.submit(&lt;function&gt; [, &lt;arg_1&gt;, ...])</span><br></pre></td></tr></table></figure>

<h4 id="Future"><a href="#Future" class="headerlink" title="Future:"></a>Future:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;bool&gt; = &lt;Future&gt;.done()             <span class="comment"># Checks if thread has finished executing.</span></span><br><span class="line">&lt;obj&gt;  = &lt;Future&gt;.result()           <span class="comment"># Waits for thread to finish and returns result.</span></span><br></pre></td></tr></table></figure>

<h3 id="Queue"><a href="#Queue" class="headerlink" title="Queue"></a>Queue</h3><p><strong>A thread-safe FIFO queue. For LIFO queue use LifoQueue.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue</span><br><span class="line">&lt;Queue&gt; = Queue(maxsize=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Queue&gt;.put(&lt;el&gt;)                    <span class="comment"># Blocks until queue stops being full.</span></span><br><span class="line">&lt;Queue&gt;.put_nowait(&lt;el&gt;)             <span class="comment"># Raises queue.Full exception if full.</span></span><br><span class="line">&lt;el&gt; = &lt;Queue&gt;.get()                 <span class="comment"># Blocks until queue stops being empty.</span></span><br><span class="line">&lt;el&gt; = &lt;Queue&gt;.get_nowait()          <span class="comment"># Raises _queue.Empty exception if empty.</span></span><br></pre></td></tr></table></figure>


<h2 id="Operator"><a href="#Operator" class="headerlink" title="Operator"></a>Operator</h2><p><strong>Module of functions that provide the functionality of operators.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> add, sub, mul, truediv, floordiv, mod, pow, neg, abs</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> eq, ne, lt, le, gt, ge</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> and_, or_, not_</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter, attrgetter, methodcaller</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> operator <span class="keyword">as</span> op</span><br><span class="line">sorted_by_second = sorted(&lt;collection&gt;, key=op.itemgetter(<span class="number">1</span>))</span><br><span class="line">sorted_by_both   = sorted(&lt;collection&gt;, key=op.itemgetter(<span class="number">1</span>, <span class="number">0</span>))</span><br><span class="line">product_of_elems = functools.reduce(op.mul, &lt;collection&gt;)</span><br><span class="line">LogicOp          = enum.Enum(<span class="string">'LogicOp'</span>, &#123;<span class="string">'AND'</span>: op.and_, <span class="string">'OR'</span> : op.or_&#125;)</span><br><span class="line">last_el          = op.methodcaller(<span class="string">'pop'</span>)(&lt;list&gt;)</span><br></pre></td></tr></table></figure>


<h2 id="Introspection"><a href="#Introspection" class="headerlink" title="Introspection"></a>Introspection</h2><p><strong>Inspecting code at runtime.</strong></p>
<h3 id="Variables"><a href="#Variables" class="headerlink" title="Variables"></a>Variables</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;list&gt; = dir()                       <span class="comment"># Returns names of variables in current scope.</span></span><br><span class="line">&lt;dict&gt; = locals()                    <span class="comment"># Returns dict of local variables. Also vars().</span></span><br><span class="line">&lt;dict&gt; = globals()                   <span class="comment"># Returns dict of global variables.</span></span><br></pre></td></tr></table></figure>

<h3 id="Attributes-1"><a href="#Attributes-1" class="headerlink" title="Attributes"></a>Attributes</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dict&gt; = vars(&lt;object&gt;)</span><br><span class="line">&lt;bool&gt; = hasattr(&lt;object&gt;, <span class="string">'&lt;attr_name&gt;'</span>)</span><br><span class="line">value  = getattr(&lt;object&gt;, <span class="string">'&lt;attr_name&gt;'</span>)</span><br><span class="line">setattr(&lt;object&gt;, <span class="string">'&lt;attr_name&gt;'</span>, value)</span><br></pre></td></tr></table></figure>

<h3 id="Parameters-1"><a href="#Parameters-1" class="headerlink" title="Parameters"></a>Parameters</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> inspect <span class="keyword">import</span> signature</span><br><span class="line">&lt;sig&gt;        = signature(&lt;function&gt;)</span><br><span class="line">no_of_params = len(&lt;sig&gt;.parameters)</span><br><span class="line">param_names  = list(&lt;sig&gt;.parameters.keys())</span><br></pre></td></tr></table></figure>


<h2 id="Metaprograming"><a href="#Metaprograming" class="headerlink" title="Metaprograming"></a>Metaprograming</h2><p><strong>Code that generates code.</strong></p>
<h3 id="Type-1"><a href="#Type-1" class="headerlink" title="Type"></a>Type</h3><p><strong>Type is the root class. If only passed an object it returns its type (class). Otherwise it creates a new class.</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;class&gt; = type('&lt;class_name&gt;', &lt;parents_tuple&gt;, &lt;attributes_dict&gt;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>Z = type(<span class="string">'Z'</span>, (), &#123;<span class="string">'a'</span>: <span class="string">'abcde'</span>, <span class="string">'b'</span>: <span class="number">12345</span>&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>z = Z()</span><br></pre></td></tr></table></figure>

<h3 id="Meta-Class"><a href="#Meta-Class" class="headerlink" title="Meta Class"></a>Meta Class</h3><p><strong>Class that creates classes.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_meta_class</span><span class="params">(name, parents, attrs)</span>:</span></span><br><span class="line">    attrs[<span class="string">'a'</span>] = <span class="string">'abcde'</span></span><br><span class="line">    <span class="keyword">return</span> type(name, parents, attrs)</span><br></pre></td></tr></table></figure>

<h4 id="Or-2"><a href="#Or-2" class="headerlink" title="Or:"></a>Or:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyMetaClass</span><span class="params">(type)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, name, parents, attrs)</span>:</span></span><br><span class="line">        attrs[<span class="string">'a'</span>] = <span class="string">'abcde'</span></span><br><span class="line">        <span class="keyword">return</span> type.__new__(cls, name, parents, attrs)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>New() is a class method that gets called before init(). If it returns an instance of its class, then that instance gets passed to init() as a ‘self’ argument.</strong></li>
<li><strong>It receives the same arguments as init(), except for the first one that specifies the desired type of the returned instance (MyMetaClass in our case).</strong></li>
<li><strong>Like in our case, new() can also be called directly, usually from a new() method of a child class (</strong><code>def __new__(cls): return super().__new__(cls)</code><strong>).</strong></li>
<li><strong>The only difference between the examples above is that my_meta_class() returns a class of type type, while MyMetaClass() returns a class of type MyMetaClass.</strong></li>
</ul>
<h3 id="Metaclass-Attribute"><a href="#Metaclass-Attribute" class="headerlink" title="Metaclass Attribute"></a>Metaclass Attribute</h3><p><strong>Right before a class is created it checks if it has a ‘metaclass’ attribute defined. If not, it recursively checks if any of his parents has it defined and eventually comes to type().</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">(metaclass=MyMetaClass)</span>:</span></span><br><span class="line">    b = <span class="number">12345</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>MyClass.a, MyClass.b</span><br><span class="line">(<span class="string">'abcde'</span>, <span class="number">12345</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Type-Diagram"><a href="#Type-Diagram" class="headerlink" title="Type Diagram"></a>Type Diagram</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type(MyClass)     == MyMetaClass     <span class="comment"># MyClass is an instance of MyMetaClass.</span></span><br><span class="line">type(MyMetaClass) == type            <span class="comment"># MyMetaClass is an instance of type.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+-------------+-------------+</span><br><span class="line">|   Classes   | Metaclasses |</span><br><span class="line">+-------------+-------------|</span><br><span class="line">|   MyClass --&gt; MyMetaClass |</span><br><span class="line">|             |     v       |</span><br><span class="line">|    object -----&gt; type &lt;+  |</span><br><span class="line">|             |    ^ +---+  |</span><br><span class="line">|     str ---------+        |</span><br><span class="line">+-------------+-------------+</span><br></pre></td></tr></table></figure>

<h3 id="Inheritance-Diagram"><a href="#Inheritance-Diagram" class="headerlink" title="Inheritance Diagram"></a>Inheritance Diagram</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MyClass.__base__     == object       <span class="comment"># MyClass is a subclass of object.</span></span><br><span class="line">MyMetaClass.__base__ == type         <span class="comment"># MyMetaClass is a subclass of type.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+-------------+-------------+</span><br><span class="line">|   Classes   | Metaclasses |</span><br><span class="line">+-------------+-------------|</span><br><span class="line">|   MyClass   | MyMetaClass |</span><br><span class="line">|      v      |     v       |</span><br><span class="line">|    object &lt;----- type     |</span><br><span class="line">|      ^      |             |</span><br><span class="line">|     str     |             |</span><br><span class="line">+-------------+-------------+</span><br></pre></td></tr></table></figure>


<h2 id="Eval"><a href="#Eval" class="headerlink" title="Eval"></a>Eval</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> ast <span class="keyword">import</span> literal_eval</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>literal_eval(<span class="string">'1 + 2'</span>)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>literal_eval(<span class="string">'[1, 2, 3]'</span>)</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>literal_eval(<span class="string">'abs(1)'</span>)</span><br><span class="line">ValueError: malformed node <span class="keyword">or</span> string</span><br></pre></td></tr></table></figure>


<h2 id="Coroutine"><a href="#Coroutine" class="headerlink" title="Coroutine"></a>Coroutine</h2><ul>
<li><strong>Any function that contains a <code>&#39;(yield)&#39;</code> expression returns a coroutine.</strong></li>
<li><strong>Coroutines are similar to iterators, but data needs to be pulled out of an iterator by calling <code>&#39;next(&lt;iter&gt;)&#39;</code>, while we push data into the coroutine by calling <code>&#39;&lt;coroutine&gt;.send(&lt;el&gt;)&#39;</code>.</strong></li>
<li><strong>Coroutines provide more powerful data routing possibilities than iterators.</strong></li>
</ul>
<h3 id="Helper-Decorator"><a href="#Helper-Decorator" class="headerlink" title="Helper Decorator"></a>Helper Decorator</h3><ul>
<li><strong>All coroutines must first be “primed” by calling <code>&#39;next(&lt;coroutine&gt;)&#39;</code>.</strong></li>
<li><strong>Remembering to call next() is easy to forget.</strong></li>
<li><strong>Solved by wrapping coroutine functions with the following decorator:</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">coroutine</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">out</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">        cr = func(*args, **kwargs)</span><br><span class="line">        next(cr)</span><br><span class="line">        <span class="keyword">return</span> cr</span><br><span class="line">    <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>

<h3 id="Pipeline-Example"><a href="#Pipeline-Example" class="headerlink" title="Pipeline Example"></a>Pipeline Example</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reader</span><span class="params">(target)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        target.send(i)</span><br><span class="line">    target.close()</span><br><span class="line"></span><br><span class="line"><span class="meta">@coroutine</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">adder</span><span class="params">(target)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        value = (<span class="keyword">yield</span>)</span><br><span class="line">        target.send(value + <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@coroutine</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printer</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        value = (<span class="keyword">yield</span>)</span><br><span class="line">        print(value, end=<span class="string">' '</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>reader(adder(printer()))</span><br><span class="line"><span class="number">100</span> <span class="number">101</span> <span class="number">102</span> <span class="number">103</span> <span class="number">104</span> <span class="number">105</span> <span class="number">106</span> <span class="number">107</span> <span class="number">108</span> <span class="number">109</span></span><br></pre></td></tr></table></figure>

<br>


<h1 id="Libraries"><a href="#Libraries" class="headerlink" title="Libraries"></a>Libraries</h1><h2 id="Progress-Bar"><a href="#Progress-Bar" class="headerlink" title="Progress Bar"></a>Progress Bar</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install tqdm</span></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">for</span> el <span class="keyword">in</span> tqdm([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]):</span><br><span class="line">    sleep(<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Plot"><a href="#Plot" class="headerlink" title="Plot"></a>Plot</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install matplotlib</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot</span><br><span class="line">pyplot.plot(&lt;y_data&gt; [, label=&lt;str&gt;])</span><br><span class="line">pyplot.plot(&lt;x_data&gt;, &lt;y_data&gt;)</span><br><span class="line">pyplot.legend()                                <span class="comment"># Adds a legend.</span></span><br><span class="line">pyplot.savefig(&lt;filename&gt;)                     <span class="comment"># Saves the figure.</span></span><br><span class="line">pyplot.show()                                  <span class="comment"># Displays the figure.</span></span><br><span class="line">pyplot.clf()                                   <span class="comment"># Clears the figure.</span></span><br></pre></td></tr></table></figure>


<h2 id="Table"><a href="#Table" class="headerlink" title="Table"></a>Table</h2><h4 id="Prints-a-CSV-file-as-an-ASCII-table"><a href="#Prints-a-CSV-file-as-an-ASCII-table" class="headerlink" title="Prints a CSV file as an ASCII table:"></a>Prints a CSV file as an ASCII table:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install tabulate</span></span><br><span class="line"><span class="keyword">import</span> csv, tabulate</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'test.csv'</span>, encoding=<span class="string">'utf-8'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> file:</span><br><span class="line">    rows   = csv.reader(file)</span><br><span class="line">    header = [a.title() <span class="keyword">for</span> a <span class="keyword">in</span> next(rows)]</span><br><span class="line">    table  = tabulate.tabulate(rows, header)</span><br><span class="line">    print(table)</span><br></pre></td></tr></table></figure>


<h2 id="Curses"><a href="#Curses" class="headerlink" title="Curses"></a>Curses</h2><h4 id="Clears-the-terminal-prints-a-message-and-waits-for-an-ESC-key-press"><a href="#Clears-the-terminal-prints-a-message-and-waits-for-an-ESC-key-press" class="headerlink" title="Clears the terminal, prints a message and waits for an ESC key press:"></a>Clears the terminal, prints a message and waits for an ESC key press:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> curses <span class="keyword">import</span> wrapper, curs_set, ascii</span><br><span class="line"><span class="keyword">from</span> curses <span class="keyword">import</span> KEY_UP, KEY_RIGHT, KEY_DOWN, KEY_LEFT</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    wrapper(draw)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">draw</span><span class="params">(screen)</span>:</span></span><br><span class="line">    curs_set(<span class="number">0</span>)                                <span class="comment"># Makes cursor invisible.</span></span><br><span class="line">    screen.nodelay(<span class="literal">True</span>)                       <span class="comment"># Makes getch() non-blocking.</span></span><br><span class="line">    screen.clear()</span><br><span class="line">    screen.addstr(<span class="number">0</span>, <span class="number">0</span>, <span class="string">'Press ESC to quit.'</span>)</span><br><span class="line">    <span class="keyword">while</span> screen.getch() != ascii.ESC:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_border</span><span class="params">(screen)</span>:</span></span><br><span class="line">    <span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line">    P = namedtuple(<span class="string">'P'</span>, <span class="string">'x y'</span>)</span><br><span class="line">    height, width = screen.getmaxyx()</span><br><span class="line">    <span class="keyword">return</span> P(width - <span class="number">1</span>, height - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>


<h2 id="Logging"><a href="#Logging" class="headerlink" title="Logging"></a>Logging</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install loguru</span></span><br><span class="line"><span class="keyword">from</span> loguru <span class="keyword">import</span> logger</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">logger.add(<span class="string">'debug_&#123;time&#125;.log'</span>, colorize=<span class="literal">True</span>)  <span class="comment"># Connects a log file.</span></span><br><span class="line">logger.add(<span class="string">'error_&#123;time&#125;.log'</span>, level=<span class="string">'ERROR'</span>)  <span class="comment"># Another file for errors or higher.</span></span><br><span class="line">logger.&lt;level&gt;(<span class="string">'A logging message.'</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Levels: <code>&#39;debug&#39;</code>, <code>&#39;info&#39;</code>, <code>&#39;success&#39;</code>, <code>&#39;warning&#39;</code>, <code>&#39;error&#39;</code>, <code>&#39;critical&#39;</code>.</strong></li>
</ul>
<h3 id="Exceptions-2"><a href="#Exceptions-2" class="headerlink" title="Exceptions"></a>Exceptions</h3><p><strong>Exception description, stack trace and values of variables are appended automatically.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">except</span> &lt;exception&gt;:</span><br><span class="line">    logger.exception(<span class="string">'An error happened.'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Rotation"><a href="#Rotation" class="headerlink" title="Rotation"></a>Rotation</h3><p><strong>Argument that sets a condition when a new log file is created.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rotation=&lt;int&gt;|&lt;datetime.timedelta&gt;|&lt;datetime.time&gt;|&lt;str&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>&#39;&lt;int&gt;&#39;</code> - Max file size in bytes.</strong></li>
<li><strong><code>&#39;&lt;timedelta&gt;&#39;</code> - Max age of a file.</strong></li>
<li><strong><code>&#39;&lt;time&gt;&#39;</code> - Time of day.</strong></li>
<li><strong><code>&#39;&lt;str&gt;&#39;</code> - Any of above as a string: <code>&#39;100 MB&#39;</code>, <code>&#39;1 month&#39;</code>, <code>&#39;monday at 12:00&#39;</code>, …</strong></li>
</ul>
<h3 id="Retention"><a href="#Retention" class="headerlink" title="Retention"></a>Retention</h3><p><strong>Sets a condition which old log files get deleted.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">retention=&lt;int&gt;|&lt;datetime.timedelta&gt;|&lt;str&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>&#39;&lt;int&gt;&#39;</code> - Max number of files.</strong></li>
<li><strong><code>&#39;&lt;timedelta&gt;&#39;</code> - Max age of a file.</strong></li>
<li><strong><code>&#39;&lt;str&gt;&#39;</code> - Max age as a string: <code>&#39;1 week, 3 days&#39;</code>, <code>&#39;2 months&#39;</code>, …</strong></li>
</ul>
<h2 id="Scraping"><a href="#Scraping" class="headerlink" title="Scraping"></a>Scraping</h2><h4 id="Scrapes-Python’s-URL-version-number-and-logo-from-Wikipedia-page"><a href="#Scrapes-Python’s-URL-version-number-and-logo-from-Wikipedia-page" class="headerlink" title="Scrapes Python’s URL, version number and logo from Wikipedia page:"></a>Scrapes Python’s URL, version number and logo from Wikipedia page:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install requests beautifulsoup4</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">URL = <span class="string">'https://en.wikipedia.org/wiki/Python_(programming_language)'</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    html  = requests.get(URL).text</span><br><span class="line">    doc   = BeautifulSoup(html, <span class="string">'html.parser'</span>)</span><br><span class="line">    table = doc.find(<span class="string">'table'</span>, class_=<span class="string">'infobox vevent'</span>)</span><br><span class="line">    rows  = table.find_all(<span class="string">'tr'</span>)</span><br><span class="line">    link  = rows[<span class="number">11</span>].find(<span class="string">'a'</span>)[<span class="string">'href'</span>]</span><br><span class="line">    ver   = rows[<span class="number">6</span>].find(<span class="string">'div'</span>).text.split()[<span class="number">0</span>]</span><br><span class="line">    url_i = rows[<span class="number">0</span>].find(<span class="string">'img'</span>)[<span class="string">'src'</span>]</span><br><span class="line">    image = requests.get(<span class="string">f'https:<span class="subst">&#123;url_i&#125;</span>'</span>).content</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'test.png'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(image)</span><br><span class="line">    print(link, ver)</span><br><span class="line"><span class="keyword">except</span> requests.exceptions.ConnectionError:</span><br><span class="line">    print(<span class="string">"You've got problems with connection."</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install bottle</span></span><br><span class="line"><span class="keyword">from</span> bottle <span class="keyword">import</span> run, route, static_file, template, post, request, response</span><br><span class="line"><span class="keyword">import</span> json</span><br></pre></td></tr></table></figure>

<h3 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">run(host=<span class="string">'localhost'</span>, port=<span class="number">8080</span>)        <span class="comment"># Runs locally.</span></span><br><span class="line">run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">80</span>)            <span class="comment"># Runs globally.</span></span><br></pre></td></tr></table></figure>

<h3 id="Static-Request"><a href="#Static-Request" class="headerlink" title="Static Request"></a>Static Request</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@route('/img/&lt;image&gt;')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_image</span><span class="params">(image)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> static_file(image, <span class="string">'img_dir/'</span>, mimetype=<span class="string">'image/png'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Dynamic-Request"><a href="#Dynamic-Request" class="headerlink" title="Dynamic Request"></a>Dynamic Request</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@route('/&lt;sport&gt;')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_page</span><span class="params">(sport)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> template(<span class="string">'&lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;'</span>, title=sport)</span><br></pre></td></tr></table></figure>

<h3 id="REST-Request"><a href="#REST-Request" class="headerlink" title="REST Request"></a>REST Request</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@post('/odds/&lt;sport&gt;')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">odds_handler</span><span class="params">(sport)</span>:</span></span><br><span class="line">    team = request.forms.get(<span class="string">'team'</span>)</span><br><span class="line">    home_odds, away_odds = <span class="number">2.44</span>, <span class="number">3.29</span></span><br><span class="line">    response.headers[<span class="string">'Content-Type'</span>] = <span class="string">'application/json'</span></span><br><span class="line">    response.headers[<span class="string">'Cache-Control'</span>] = <span class="string">'no-cache'</span></span><br><span class="line">    <span class="keyword">return</span> json.dumps([team, home_odds, away_odds])</span><br></pre></td></tr></table></figure>

<h4 id="Test"><a href="#Test" class="headerlink" title="Test:"></a>Test:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install requests</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> requests</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>url  = <span class="string">'http://localhost:8080/odds/football'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = &#123;<span class="string">'team'</span>: <span class="string">'arsenal f.c.'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>response = requests.post(url, data=data)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>response.json()</span><br><span class="line">[<span class="string">'arsenal f.c.'</span>, <span class="number">2.44</span>, <span class="number">3.29</span>]</span><br></pre></td></tr></table></figure>


<h2 id="Profiling"><a href="#Profiling" class="headerlink" title="Profiling"></a>Profiling</h2><h3 id="Stopwatch"><a href="#Stopwatch" class="headerlink" title="Stopwatch"></a>Stopwatch</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line">start_time = time()                     <span class="comment"># Seconds since the Epoch.</span></span><br><span class="line">...</span><br><span class="line">duration = time() - start_time</span><br></pre></td></tr></table></figure>

<h4 id="High-performance"><a href="#High-performance" class="headerlink" title="High performance:"></a>High performance:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> perf_counter</span><br><span class="line">start_time = perf_counter()             <span class="comment"># Seconds since restart.</span></span><br><span class="line">...</span><br><span class="line">duration = perf_counter() - start_time</span><br></pre></td></tr></table></figure>

<h3 id="Timing-a-Snippet"><a href="#Timing-a-Snippet" class="headerlink" title="Timing a Snippet"></a>Timing a Snippet</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> timeit <span class="keyword">import</span> timeit</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>timeit(<span class="string">'"-".join(str(a) for a in range(100))'</span>,</span><br><span class="line"><span class="meta">... </span>       number=<span class="number">10000</span>, globals=globals(), setup=<span class="string">'pass'</span>)</span><br><span class="line"><span class="number">0.34986</span></span><br></pre></td></tr></table></figure>

<h3 id="Profiling-by-Line"><a href="#Profiling-by-Line" class="headerlink" title="Profiling by Line"></a>Profiling by Line</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install line_profiler memory_profiler</span></span><br><span class="line"><span class="meta">@profile</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    a = [*range(<span class="number">10000</span>)]</span><br><span class="line">    b = &#123;*range(<span class="number">10000</span>)&#125;</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ kernprof -lv test.py</span><br><span class="line">Line #   Hits     Time  Per Hit   % Time  Line Contents</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">     1                                    @profile</span><br><span class="line">     2                                    def main():</span><br><span class="line">     3      1   1128.0   1128.0     27.4      a &#x3D; [*range(10000)]</span><br><span class="line">     4      1   2994.0   2994.0     72.6      b &#x3D; &#123;*range(10000)&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ python3 -m memory_profiler test.py</span><br><span class="line">Line #         Mem usage      Increment   Line Contents</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">     1        35.387 MiB     35.387 MiB   @profile</span><br><span class="line">     2                                    def main():</span><br><span class="line">     3        35.734 MiB      0.348 MiB       a &#x3D; [*range(10000)]</span><br><span class="line">     4        36.160 MiB      0.426 MiB       b &#x3D; &#123;*range(10000)&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Call-Graph"><a href="#Call-Graph" class="headerlink" title="Call Graph"></a>Call Graph</h3><h4 id="Generates-a-PNG-image-of-a-call-graph-with-highlighted-bottlenecks"><a href="#Generates-a-PNG-image-of-a-call-graph-with-highlighted-bottlenecks" class="headerlink" title="Generates a PNG image of a call graph with highlighted bottlenecks:"></a>Generates a PNG image of a call graph with highlighted bottlenecks:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install pycallgraph</span></span><br><span class="line"><span class="keyword">from</span> pycallgraph <span class="keyword">import</span> output, PyCallGraph</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line">time_str = datetime.now().strftime(<span class="string">'%Y%m%d%H%M%S'</span>)</span><br><span class="line">filename = <span class="string">f'profile-<span class="subst">&#123;time_str&#125;</span>.png'</span></span><br><span class="line">drawer = output.GraphvizOutput(output_file=filename)</span><br><span class="line"><span class="keyword">with</span> PyCallGraph(drawer):</span><br><span class="line">    &lt;code_to_be_profiled&gt;</span><br></pre></td></tr></table></figure>


<h2 id="NumPy"><a href="#NumPy" class="headerlink" title="NumPy"></a>NumPy</h2><p><strong>Array manipulation mini language. Can run up to one hundred times faster than equivalent Python code.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install numpy</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;array&gt; = np.array(&lt;list&gt;)</span><br><span class="line">&lt;array&gt; = np.arange(from_inclusive, to_exclusive, ±step_size)</span><br><span class="line">&lt;array&gt; = np.ones(&lt;shape&gt;)</span><br><span class="line">&lt;array&gt; = np.random.randint(from_inclusive, to_exclusive, &lt;shape&gt;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;array&gt;.shape = &lt;shape&gt;</span><br><span class="line">&lt;view&gt;  = &lt;array&gt;.reshape(&lt;shape&gt;)</span><br><span class="line">&lt;view&gt;  = np.broadcast_to(&lt;array&gt;, &lt;shape&gt;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;array&gt; = &lt;array&gt;.sum(axis)</span><br><span class="line">indexes = &lt;array&gt;.argmin(axis)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Shape is a tuple of dimension sizes.</strong></li>
<li><strong>Axis is an index of dimension that gets collapsed. Leftmost dimension has index 0.</strong></li>
</ul>
<h3 id="Indexing"><a href="#Indexing" class="headerlink" title="Indexing"></a>Indexing</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;el&gt;       = &lt;2d_array&gt;[0, 0]        <span class="comment"># First element.</span></span><br><span class="line">&lt;1d_view&gt;  = &lt;2d_array&gt;[0]           <span class="comment"># First row.</span></span><br><span class="line">&lt;1d_view&gt;  = &lt;2d_array&gt;[:, 0]        <span class="comment"># First column. Also [..., 0].</span></span><br><span class="line">&lt;3d_view&gt;  = &lt;2d_array&gt;[None, :, :]  <span class="comment"># Expanded by dimension of size 1.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;1d_array&gt; = &lt;2d_array&gt;[&lt;1d_row_indexes&gt;, &lt;1d_column_indexes&gt;]</span><br><span class="line">&lt;2d_array&gt; = &lt;2d_array&gt;[&lt;2d_row_indexes&gt;, &lt;2d_column_indexes&gt;]</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;2d_bools&gt; = &lt;2d_array&gt; &gt; 0</span><br><span class="line">&lt;1d_array&gt; = &lt;2d_array&gt;[&lt;2d_bools&gt;]</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>If row and column indexes differ in shape, they are combined with broadcasting.</strong></li>
</ul>
<h3 id="Broadcasting"><a href="#Broadcasting" class="headerlink" title="Broadcasting"></a>Broadcasting</h3><p><strong>Broadcasting is a set of rules by which NumPy functions operate on arrays of different sizes and/or dimensions.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">left  = [[<span class="number">0.1</span>], [<span class="number">0.6</span>], [<span class="number">0.8</span>]]        <span class="comment"># Shape: (3, 1)</span></span><br><span class="line">right = [ <span class="number">0.1</span> ,  <span class="number">0.6</span> ,  <span class="number">0.8</span> ]        <span class="comment"># Shape: (3)</span></span><br></pre></td></tr></table></figure>

<h4 id="1-If-array-shapes-differ-in-length-left-pad-the-shorter-shape-with-ones"><a href="#1-If-array-shapes-differ-in-length-left-pad-the-shorter-shape-with-ones" class="headerlink" title="1. If array shapes differ in length, left-pad the shorter shape with ones:"></a>1. If array shapes differ in length, left-pad the shorter shape with ones:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">left  = [[<span class="number">0.1</span>], [<span class="number">0.6</span>], [<span class="number">0.8</span>]]        <span class="comment"># Shape: (3, 1)</span></span><br><span class="line">right = [[<span class="number">0.1</span> ,  <span class="number">0.6</span> ,  <span class="number">0.8</span>]]        <span class="comment"># Shape: (1, 3) &lt;- !</span></span><br></pre></td></tr></table></figure>

<h4 id="2-If-any-dimensions-differ-in-size-expand-the-ones-that-have-size-1-by-duplicating-their-elements"><a href="#2-If-any-dimensions-differ-in-size-expand-the-ones-that-have-size-1-by-duplicating-their-elements" class="headerlink" title="2. If any dimensions differ in size, expand the ones that have size 1 by duplicating their elements:"></a>2. If any dimensions differ in size, expand the ones that have size 1 by duplicating their elements:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">left  = [[<span class="number">0.1</span>, <span class="number">0.1</span>, <span class="number">0.1</span>], [<span class="number">0.6</span>, <span class="number">0.6</span>, <span class="number">0.6</span>], [<span class="number">0.8</span>, <span class="number">0.8</span>, <span class="number">0.8</span>]]  <span class="comment"># Shape: (3, 3) &lt;- !</span></span><br><span class="line">right = [[<span class="number">0.1</span>, <span class="number">0.6</span>, <span class="number">0.8</span>], [<span class="number">0.1</span>, <span class="number">0.6</span>, <span class="number">0.8</span>], [<span class="number">0.1</span>, <span class="number">0.6</span>, <span class="number">0.8</span>]]  <span class="comment"># Shape: (3, 3) &lt;- !</span></span><br></pre></td></tr></table></figure>

<h4 id="3-If-neither-non-matching-dimension-has-size-1-rise-an-error"><a href="#3-If-neither-non-matching-dimension-has-size-1-rise-an-error" class="headerlink" title="3. If neither non-matching dimension has size 1, rise an error."></a>3. If neither non-matching dimension has size 1, rise an error.</h4><h3 id="Example-2"><a href="#Example-2" class="headerlink" title="Example"></a>Example</h3><h4 id="For-each-point-returns-index-of-its-nearest-point-0-1-0-6-0-8-gt-1-2-1"><a href="#For-each-point-returns-index-of-its-nearest-point-0-1-0-6-0-8-gt-1-2-1" class="headerlink" title="For each point returns index of its nearest point ([0.1, 0.6, 0.8] =&gt; [1, 2, 1]):"></a>For each point returns index of its nearest point (<code>[0.1, 0.6, 0.8] =&gt; [1, 2, 1]</code>):</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>points = np.array([<span class="number">0.1</span>, <span class="number">0.6</span>, <span class="number">0.8</span>])</span><br><span class="line"> [ <span class="number">0.1</span>,  <span class="number">0.6</span>,  <span class="number">0.8</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>wrapped_points = points.reshape(<span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line">[[ <span class="number">0.1</span>],</span><br><span class="line"> [ <span class="number">0.6</span>],</span><br><span class="line"> [ <span class="number">0.8</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>distances = wrapped_points - points</span><br><span class="line">[[ <span class="number">0.</span> , <span class="number">-0.5</span>, <span class="number">-0.7</span>],</span><br><span class="line"> [ <span class="number">0.5</span>,  <span class="number">0.</span> , <span class="number">-0.2</span>],</span><br><span class="line"> [ <span class="number">0.7</span>,  <span class="number">0.2</span>,  <span class="number">0.</span> ]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>distances = np.abs(distances)</span><br><span class="line">[[ <span class="number">0.</span> ,  <span class="number">0.5</span>,  <span class="number">0.7</span>],</span><br><span class="line"> [ <span class="number">0.5</span>,  <span class="number">0.</span> ,  <span class="number">0.2</span>],</span><br><span class="line"> [ <span class="number">0.7</span>,  <span class="number">0.2</span>,  <span class="number">0.</span> ]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>i = np.arange(<span class="number">3</span>)</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>distances[i, i] = np.inf</span><br><span class="line">[[ inf,  <span class="number">0.5</span>,  <span class="number">0.7</span>],</span><br><span class="line"> [ <span class="number">0.5</span>,  inf,  <span class="number">0.2</span>],</span><br><span class="line"> [ <span class="number">0.7</span>,  <span class="number">0.2</span>,  inf]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>distances.argmin(<span class="number">1</span>)</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>


<h2 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install pillow</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Image&gt; = Image.new(<span class="string">'&lt;mode&gt;'</span>, (width, height))</span><br><span class="line">&lt;Image&gt; = Image.open(<span class="string">'&lt;path&gt;'</span>)</span><br><span class="line">&lt;Image&gt; = &lt;Image&gt;.convert(<span class="string">'&lt;mode&gt;'</span>)</span><br><span class="line">&lt;Image&gt;.save(<span class="string">'&lt;path&gt;'</span>)</span><br><span class="line">&lt;Image&gt;.show()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;tuple/int&gt; = &lt;Image&gt;.getpixel((x, y))          <span class="comment"># Returns a pixel.</span></span><br><span class="line">&lt;Image&gt;.putpixel((x, y), &lt;tuple/int&gt;)           <span class="comment"># Writes a pixel to image.</span></span><br><span class="line">&lt;ImagingCore&gt; = &lt;Image&gt;.getdata()               <span class="comment"># Returns a sequence of pixels.</span></span><br><span class="line">&lt;Image&gt;.putdata(&lt;list/ImagingCore&gt;)             <span class="comment"># Writes a sequence of pixels.</span></span><br><span class="line">&lt;Image&gt;.paste(&lt;Image&gt;, (x, y))                  <span class="comment"># Writes an image to image.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;2d_array&gt; = np.array(&lt;Image&gt;)                  <span class="comment"># NumPy array from greyscale image.</span></span><br><span class="line">&lt;3d_array&gt; = np.array(&lt;Image&gt;)                  <span class="comment"># NumPy array from color image.</span></span><br><span class="line">&lt;Image&gt;    = Image.fromarray(&lt;array&gt;)           <span class="comment"># Image from NumPy array.</span></span><br></pre></td></tr></table></figure>

<h3 id="Modes-1"><a href="#Modes-1" class="headerlink" title="Modes"></a>Modes</h3><ul>
<li><strong><code>&#39;1&#39;</code> - 1-bit pixels, black and white, stored with one pixel per byte.</strong></li>
<li><strong><code>&#39;L&#39;</code> - 8-bit pixels, greyscale.</strong></li>
<li><strong><code>&#39;RGB&#39;</code> - 3x8-bit pixels, true color.</strong></li>
<li><strong><code>&#39;RGBA&#39;</code> - 4x8-bit pixels, true color with transparency mask.</strong></li>
<li><strong><code>&#39;HSV&#39;</code> - 3x8-bit pixels, Hue, Saturation, Value color space.</strong></li>
</ul>
<h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><h4 id="Creates-a-PNG-image-of-a-rainbow-gradient"><a href="#Creates-a-PNG-image-of-a-rainbow-gradient" class="headerlink" title="Creates a PNG image of a rainbow gradient:"></a>Creates a PNG image of a rainbow gradient:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">WIDTH, HEIGHT = <span class="number">100</span>, <span class="number">100</span></span><br><span class="line">size = WIDTH * HEIGHT</span><br><span class="line">hues = [<span class="number">255</span> * i/size <span class="keyword">for</span> i <span class="keyword">in</span> range(size)]</span><br><span class="line">img = Image.new(<span class="string">'HSV'</span>, (WIDTH, HEIGHT))</span><br><span class="line">img.putdata([(int(h), <span class="number">255</span>, <span class="number">255</span>) <span class="keyword">for</span> h <span class="keyword">in</span> hues])</span><br><span class="line">img.convert(<span class="string">'RGB'</span>).save(<span class="string">'test.png'</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Adds-noise-to-a-PNG-image"><a href="#Adds-noise-to-a-PNG-image" class="headerlink" title="Adds noise to a PNG image:"></a>Adds noise to a PNG image:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line">add_noise = <span class="keyword">lambda</span> value: max(<span class="number">0</span>, min(<span class="number">255</span>, value + randint(<span class="number">-20</span>, <span class="number">20</span>)))</span><br><span class="line">img = Image.open(<span class="string">'test.png'</span>).convert(<span class="string">'HSV'</span>)</span><br><span class="line">img.putdata([(add_noise(h), s, v) <span class="keyword">for</span> h, s, v <span class="keyword">in</span> img.getdata()])</span><br><span class="line">img.convert(<span class="string">'RGB'</span>).save(<span class="string">'test.png'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Drawing"><a href="#Drawing" class="headerlink" title="Drawing"></a>Drawing</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageDraw</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;ImageDraw&gt; = ImageDraw.Draw(&lt;Image&gt;)</span><br><span class="line">&lt;ImageDraw&gt;.point((x, y), fill=<span class="literal">None</span>)</span><br><span class="line">&lt;ImageDraw&gt;.line((x1, y1, x2, y2 [, ...]), fill=<span class="literal">None</span>, width=<span class="number">0</span>, joint=<span class="literal">None</span>) </span><br><span class="line">&lt;ImageDraw&gt;.arc((x1, y1, x2, y2), from_deg, to_deg, fill=<span class="literal">None</span>, width=<span class="number">0</span>)</span><br><span class="line">&lt;ImageDraw&gt;.rectangle((x1, y1, x2, y2), fill=<span class="literal">None</span>, outline=<span class="literal">None</span>, width=<span class="number">0</span>)</span><br><span class="line">&lt;ImageDraw&gt;.polygon((x1, y1, x2, y2 [, ...]), fill=<span class="literal">None</span>, outline=<span class="literal">None</span>)</span><br><span class="line">&lt;ImageDraw&gt;.ellipse((x1, y1, x2, y2), fill=<span class="literal">None</span>, outline=<span class="literal">None</span>, width=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Use <code>&#39;fill=&lt;color&gt;&#39;</code> to set the primary color.</strong></li>
<li><strong>Use <code>&#39;outline=&lt;color&gt;&#39;</code> to set the secondary color.</strong></li>
<li><strong>Color can be specified as a tuple, int, <code>&#39;#rrggbb&#39;</code> string or a color name.</strong></li>
</ul>
<h2 id="Animation"><a href="#Animation" class="headerlink" title="Animation"></a>Animation</h2><h4 id="Creates-a-GIF-of-a-bouncing-ball"><a href="#Creates-a-GIF-of-a-bouncing-ball" class="headerlink" title="Creates a GIF of a bouncing ball:"></a>Creates a GIF of a bouncing ball:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install pillow imageio</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw</span><br><span class="line"><span class="keyword">import</span> imageio</span><br><span class="line">WIDTH, R = <span class="number">126</span>, <span class="number">10</span></span><br><span class="line">frames = []</span><br><span class="line"><span class="keyword">for</span> velocity <span class="keyword">in</span> range(<span class="number">15</span>):</span><br><span class="line">    y = sum(range(velocity+<span class="number">1</span>))</span><br><span class="line">    frame = Image.new(<span class="string">'L'</span>, (WIDTH, WIDTH))</span><br><span class="line">    draw  = ImageDraw.Draw(frame)</span><br><span class="line">    draw.ellipse((WIDTH/<span class="number">2</span>-R, y, WIDTH/<span class="number">2</span>+R, y+<span class="number">2</span>*R), fill=<span class="string">'white'</span>)</span><br><span class="line">    frames.append(frame)</span><br><span class="line">frames += reversed(frames[<span class="number">1</span>:<span class="number">-1</span>])</span><br><span class="line">imageio.mimsave(<span class="string">'test.gif'</span>, frames, duration=<span class="number">0.03</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Audio"><a href="#Audio" class="headerlink" title="Audio"></a>Audio</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> wave</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;Wave_read&gt;  = wave.open(<span class="string">'&lt;path&gt;'</span>, <span class="string">'rb'</span>)</span><br><span class="line">framerate    = &lt;Wave_read&gt;.getframerate()       <span class="comment"># Number of frames per second.</span></span><br><span class="line">nchannels    = &lt;Wave_read&gt;.getnchannels()       <span class="comment"># Number of samples per frame.</span></span><br><span class="line">sampwidth    = &lt;Wave_read&gt;.getsampwidth()       <span class="comment"># Sample size in bytes.</span></span><br><span class="line">nframes      = &lt;Wave_read&gt;.getnframes()         <span class="comment"># Number of frames.</span></span><br><span class="line">&lt;params&gt;     = &lt;Wave_read&gt;.getparams()          <span class="comment"># Immutable collection of above.</span></span><br><span class="line">&lt;bytes&gt;      = &lt;Wave_read&gt;.readframes(nframes)  <span class="comment"># Returns next 'nframes' frames.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;Wave_write&gt; = wave.open(<span class="string">'&lt;path&gt;'</span>, <span class="string">'wb'</span>)</span><br><span class="line">&lt;Wave_write&gt;.setframerate(&lt;int&gt;)                <span class="comment"># 44100 for CD, 48000 for video.</span></span><br><span class="line">&lt;Wave_write&gt;.setnchannels(&lt;int&gt;)                <span class="comment"># 1 for mono, 2 for stereo.</span></span><br><span class="line">&lt;Wave_write&gt;.setsampwidth(&lt;int&gt;)                <span class="comment"># 2 for CD quality sound.</span></span><br><span class="line">&lt;Wave_write&gt;.setparams(&lt;params&gt;)                <span class="comment"># Sets all parameters.</span></span><br><span class="line">&lt;Wave_write&gt;.writeframes(&lt;bytes&gt;)               <span class="comment"># Appends frames to file.</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Bytes object contains a sequence of frames, each consisting of one or more samples.</strong></li>
<li><strong>In stereo signal first sample of a frame belongs to the left channel.</strong></li>
<li><strong>Each sample consists of one or more bytes that, when converted to an integer, indicate the displacement of a speaker membrane at a given moment.</strong></li>
<li><strong>If sample width is one, then the integer should be encoded unsigned.</strong></li>
<li><strong>For all other sizes the integer should be encoded signed with little-endian byte order.</strong></li>
</ul>
<h3 id="Sample-Values"><a href="#Sample-Values" class="headerlink" title="Sample Values"></a>Sample Values</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+-----------+-------------+------+-------------+</span><br><span class="line">| sampwidth |     min     | zero |     max     |</span><br><span class="line">+-----------+-------------+------+-------------+</span><br><span class="line">|     1     |           0 |  128 |         255 |</span><br><span class="line">|     2     |      -32768 |    0 |       32767 |</span><br><span class="line">|     3     |    -8388608 |    0 |     8388607 |</span><br><span class="line">|     4     | -2147483648 |    0 |  2147483647 |</span><br><span class="line">+-----------+-------------+------+-------------+</span><br></pre></td></tr></table></figure>

<h3 id="Read-Float-Samples-from-WAV-File"><a href="#Read-Float-Samples-from-WAV-File" class="headerlink" title="Read Float Samples from WAV File"></a>Read Float Samples from WAV File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_wav_file</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_int</span><span class="params">(a_bytes)</span>:</span></span><br><span class="line">        an_int = int.from_bytes(a_bytes, <span class="string">'little'</span>, signed=width!=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> an_int - <span class="number">128</span> * (width == <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">with</span> wave.open(filename, <span class="string">'rb'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        width  = file.getsampwidth()</span><br><span class="line">        frames = file.readframes(file.getnframes())</span><br><span class="line">    byte_samples = (frames[i: i + width] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(frames), width))</span><br><span class="line">    <span class="keyword">return</span> [get_int(b) / pow(<span class="number">2</span>, width * <span class="number">8</span> - <span class="number">1</span>) <span class="keyword">for</span> b <span class="keyword">in</span> byte_samples]</span><br></pre></td></tr></table></figure>

<h3 id="Write-Float-Samples-to-WAV-File"><a href="#Write-Float-Samples-to-WAV-File" class="headerlink" title="Write Float Samples to WAV File"></a>Write Float Samples to WAV File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to_wav_file</span><span class="params">(filename, float_samples, nchannels=<span class="number">1</span>, sampwidth=<span class="number">2</span>, framerate=<span class="number">44100</span>)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_bytes</span><span class="params">(a_float)</span>:</span></span><br><span class="line">        a_float = max(<span class="number">-1</span>, min(<span class="number">1</span> - <span class="number">2e-16</span>, a_float))</span><br><span class="line">        a_float += sampwidth == <span class="number">1</span></span><br><span class="line">        a_float *= pow(<span class="number">2</span>, sampwidth * <span class="number">8</span> - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> int(a_float).to_bytes(sampwidth, <span class="string">'little'</span>, signed=sampwidth!=<span class="number">1</span>) </span><br><span class="line">    <span class="keyword">with</span> wave.open(filename, <span class="string">'wb'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.setnchannels(nchannels)</span><br><span class="line">        file.setsampwidth(sampwidth)</span><br><span class="line">        file.setframerate(framerate)</span><br><span class="line">        file.writeframes(<span class="string">b''</span>.join(get_bytes(f) <span class="keyword">for</span> f <span class="keyword">in</span> float_samples))</span><br></pre></td></tr></table></figure>

<h3 id="Examples-1"><a href="#Examples-1" class="headerlink" title="Examples"></a>Examples</h3><h4 id="Saves-a-sine-wave-to-a-mono-WAV-file"><a href="#Saves-a-sine-wave-to-a-mono-WAV-file" class="headerlink" title="Saves a sine wave to a mono WAV file:"></a>Saves a sine wave to a mono WAV file:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> pi, sin</span><br><span class="line">samples_f = (sin(i * <span class="number">2</span> * pi * <span class="number">440</span> / <span class="number">44100</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>))</span><br><span class="line">write_to_wav_file(<span class="string">'test.wav'</span>, samples_f)</span><br></pre></td></tr></table></figure>

<h4 id="Adds-noise-to-a-mono-WAV-file"><a href="#Adds-noise-to-a-mono-WAV-file" class="headerlink" title="Adds noise to a mono WAV file:"></a>Adds noise to a mono WAV file:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> random</span><br><span class="line">add_noise = <span class="keyword">lambda</span> value: value + (random() - <span class="number">0.5</span>) * <span class="number">0.03</span></span><br><span class="line">samples_f = (add_noise(f) <span class="keyword">for</span> f <span class="keyword">in</span> read_wav_file(<span class="string">'test.wav'</span>))</span><br><span class="line">write_to_wav_file(<span class="string">'test.wav'</span>, samples_f)</span><br></pre></td></tr></table></figure>

<h4 id="Plays-a-WAV-file"><a href="#Plays-a-WAV-file" class="headerlink" title="Plays a WAV file:"></a>Plays a WAV file:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install simpleaudio</span></span><br><span class="line"><span class="keyword">from</span> simpleaudio <span class="keyword">import</span> play_buffer</span><br><span class="line"><span class="keyword">with</span> wave.open(<span class="string">'test.wav'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> file:</span><br><span class="line">    p = file.getparams()</span><br><span class="line">    frames = file.readframes(p.nframes)</span><br><span class="line">    play_buffer(frames, p.nchannels, p.sampwidth, p.framerate)</span><br></pre></td></tr></table></figure>

<h3 id="Text-to-Speech"><a href="#Text-to-Speech" class="headerlink" title="Text to Speech"></a>Text to Speech</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install pyttsx3</span></span><br><span class="line"><span class="keyword">import</span> pyttsx3</span><br><span class="line">engine = pyttsx3.init()</span><br><span class="line">engine.say(<span class="string">'Sally sells seashells by the seashore.'</span>)</span><br><span class="line">engine.runAndWait()</span><br></pre></td></tr></table></figure>


<h2 id="Synthesizer"><a href="#Synthesizer" class="headerlink" title="Synthesizer"></a>Synthesizer</h2><h4 id="Plays-Popcorn-by-Gershon-Kingsley"><a href="#Plays-Popcorn-by-Gershon-Kingsley" class="headerlink" title="Plays Popcorn by Gershon Kingsley:"></a>Plays Popcorn by Gershon Kingsley:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install simpleaudio</span></span><br><span class="line"><span class="keyword">import</span> simpleaudio, math, struct</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain, repeat</span><br><span class="line">F  = <span class="number">44100</span></span><br><span class="line">P1 = <span class="string">'71♪,69,,71♪,66,,62♪,66,,59♪,,,'</span></span><br><span class="line">P2 = <span class="string">'71♪,73,,74♪,73,,74,,71,,73♪,71,,73,,69,,71♪,69,,71,,67,,71♪,,,'</span></span><br><span class="line">get_pause   = <span class="keyword">lambda</span> seconds: repeat(<span class="number">0</span>, int(seconds * F))</span><br><span class="line">sin_f       = <span class="keyword">lambda</span> i, hz: math.sin(i * <span class="number">2</span> * math.pi * hz / F)</span><br><span class="line">get_wave    = <span class="keyword">lambda</span> hz, seconds: (sin_f(i, hz) <span class="keyword">for</span> i <span class="keyword">in</span> range(int(seconds * F)))</span><br><span class="line">get_hz      = <span class="keyword">lambda</span> key: <span class="number">8.176</span> * <span class="number">2</span> ** (int(key) / <span class="number">12</span>)</span><br><span class="line">parse_note  = <span class="keyword">lambda</span> note: (get_hz(note[:<span class="number">2</span>]), <span class="number">0.25</span> <span class="keyword">if</span> <span class="string">'♪'</span> <span class="keyword">in</span> note <span class="keyword">else</span> <span class="number">0.125</span>)</span><br><span class="line">get_samples = <span class="keyword">lambda</span> note: get_wave(*parse_note(note)) <span class="keyword">if</span> note <span class="keyword">else</span> get_pause(<span class="number">0.125</span>)</span><br><span class="line">samples_f   = chain.from_iterable(get_samples(n) <span class="keyword">for</span> n <span class="keyword">in</span> <span class="string">f'<span class="subst">&#123;P1&#125;</span><span class="subst">&#123;P1&#125;</span><span class="subst">&#123;P2&#125;</span>'</span>.split(<span class="string">','</span>))</span><br><span class="line">samples_b   = <span class="string">b''</span>.join(struct.pack(<span class="string">'&lt;h'</span>, int(f * <span class="number">30000</span>)) <span class="keyword">for</span> f <span class="keyword">in</span> samples_f)</span><br><span class="line">simpleaudio.play_buffer(samples_b, <span class="number">1</span>, <span class="number">2</span>, F)</span><br></pre></td></tr></table></figure>


<h2 id="Basic-Script-Template"><a href="#Basic-Script-Template" class="headerlink" title="Basic Script Template"></a>Basic Script Template</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Usage: .py</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> make_dataclass</span><br><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> argv</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###</span></span><br><span class="line"><span class="comment">##  UTIL</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_file</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> file.readlines()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/%E6%8F%90%E9%97%AE%E7%9A%84%E8%89%BA%E6%9C%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yuanchen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yuanchen's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/06/%E6%8F%90%E9%97%AE%E7%9A%84%E8%89%BA%E6%9C%AF/" class="post-title-link" itemprop="url">提问的艺术</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-01-06 17:58:27 / Modified: 19:01:32" itemprop="dateCreated datePublished" datetime="2020-01-06T17:58:27-05:00">2020-01-06</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="在提问之前"><a href="#在提问之前" class="headerlink" title="在提问之前"></a>在提问之前</h2><p>在你准备要通过电子邮件、新闻群组或者聊天室提出技术问题前，请先做到以下事情：</p>
<pre><code>1. 尝试在你准备提问的论坛的旧文章中搜索答案。
2. 尝试上网搜索以找到答案。
3. 尝试阅读手册以找到答案。
4. 尝试阅读常见问题文件（FAQ）以找到答案。
5. 尝试自己检查或试验以找到答案。
6. 向你身边的强者朋友打听以找到答案。
7. 如果你是程序开发者，请尝试阅读源代码以找到答案。</code></pre><p>当你提出问题的时候，请先表明你已经做了上述的努力；这将有助于树立你并不是一个不劳而获且浪费别人的时间的提问者。如果你能一并表达在做了上述努力的过程中所<strong>学到</strong>的东西会更好，因为我们更乐于回答那些表现出能从答案中学习的人的问题。</p>
<p>运用某些策略，比如先用 Google 搜索你所遇到的各种错误信息（既搜索 <a href="http://groups.google.com/" target="_blank" rel="noopener">Google 论坛</a>，也搜索网页），这样很可能直接就找到了能解决问题的文件或邮件列表线索。即使没有结果，在邮件列表或新闻组寻求帮助时加上一句 <code>我在 Google 中搜过下列句子但没有找到什么有用的东西</code> 也是件好事，即使它只是表明了搜索引擎不能提供哪些帮助。这么做（加上搜索过的字串）也让遇到相似问题的其他人能被搜索引擎引导到你的提问来。</p>
<p>别着急，不要指望几秒钟的 Google 搜索就能解决一个复杂的问题。在向专家求助之前，再阅读一下常见问题文件（FAQ）、放轻松、坐舒服一些，再花点时间思考一下这个问题。相信我们，他们能从你的提问看出你做了多少阅读与思考，如果你是有备而来，将更有可能得到解答。不要将所有问题一股脑拋出，只因你的第一次搜索没有找到答案（或者找到太多答案）。</p>
<p>准备好你的问题，再将问题仔细的思考过一遍，因为草率的发问只能得到草率的回答，或者根本得不到任何答案。越是能表现出在寻求帮助前你为解决问题所付出的努力，你越有可能得到实质性的帮助。</p>
<p>小心别问错了问题。如果你的问题基于错误的假设，某个普通黑客（J. Random Hacker）多半会一边在心里想着<code>蠢问题…</code>， 一边用无意义的字面解释来答复你，希望着你会从问题的回答（而非你想得到的答案）中汲取教训。</p>
<p>绝不要自以为<strong>够格</strong>得到答案，你没有；你并没有。毕竟你没有为这种服务支付任何报酬。你将会是自己去<strong>挣到</strong>一个答案，靠提出有内涵的、有趣的、有思维激励作用的问题 —— 一个有潜力能贡献社区经验的问题，而不仅仅是被动的从他人处索取知识。</p>
<p>另一方面，表明你愿意在找答案的过程中做点什么是一个非常好的开端。<code>谁能给点提示？</code>、<code>我的这个例子里缺了什么？</code>以及<code>我应该检查什么地方</code>比<code>请把我需要的确切的过程贴出来</code>更容易得到答复。因为你表现出只要有人能指个正确方向，你就有完成它的能力和决心。</p>
<h2 id="当你提问时"><a href="#当你提问时" class="headerlink" title="当你提问时"></a>当你提问时</h2><h3 id="慎选提问的论坛"><a href="#慎选提问的论坛" class="headerlink" title="慎选提问的论坛"></a>慎选提问的论坛</h3><p>小心选择你要提问的场合。如果你做了下述的事情，你很可能被忽略掉或者被看作失败者：</p>
<ul>
<li>在与主题不合的论坛上贴出你的问题。</li>
<li>在探讨进阶技术问题的论坛张贴非常初级的问题；反之亦然。</li>
<li>在太多的不同新闻群组上重复转贴同样的问题（cross-post）。</li>
<li>向既非熟人也没有义务解决你问题的人发送私人电邮。</li>
</ul>
<p>黑客会剔除掉那些搞错场合的问题，以保护他们沟通的渠道不被无关的东西淹没。你不会想让这种事发生在自己身上的。</p>
<p>因此，第一步是找到对的论坛。再说一次，Google 和其它搜索引擎还是你的朋友，用它们来找到与你遭遇到困难的软硬件问题最相关的网站。通常那儿都有常见问题（FAQ）、邮件列表及相关说明文件的链接。如果你的努力（包括<strong>阅读</strong> FAQ）都没有结果，网站上也许还有报告 Bug（Bug-reporting）的流程或链接，如果是这样，链过去看看。</p>
<p>向陌生的人或论坛发送邮件最可能是风险最大的事情。举例来说，别假设一个提供丰富内容的网页的作者会想充当你的免费顾问。不要对你的问题是否会受到欢迎做太乐观的估计 – 如果你不确定，那就向别处发送，或者压根别发。</p>
<p>在选择论坛、新闻群组或邮件列表时，别太相信名字，先看看 FAQ 或者许可书以弄清楚你的问题是否切题。发文前先翻翻已有的话题，这样可以让你感受一下那里的文化。事实上，事先在新闻组或邮件列表的历史记录中搜索与你问题相关的关键词是个极好的主意，也许这样就找到答案了。即使没有，也能帮助你归纳出更好的问题。</p>
<p>别像机关枪似的一次”扫射”所有的帮助渠道，这就像大喊大叫一样会使人不快。要一个一个地来。</p>
<p>搞清楚你的主题！最典型的错误之一是在某种致力于跨平台可移植的语言、套件或工具的论坛中提关于 Unix 或 Windows 操作系统程序界面的问题。如果你不明白为什么这是大错，最好在搞清楚这之间差异之前什么也别问。</p>
<p>一般来说，在仔细挑选的公共论坛中提问，会比在私有论坛中提同样的问题更容易得到有用的回答。有几个理由可以支持这点，一是看潜在的回复者有多少，二是看观众有多少。黑客较愿意回答那些能帮助到许多人的问题。</p>
<p>可以理解的是，老练的黑客和一些热门软件的作者正在接受过多的错发信息。就像那根最后压垮骆驼背的稻草一样，你的加入也有可能使情况走向极端 —— 已经好几次了，一些热门软件的作者从自己软件的支持中抽身出来，因为伴随而来涌入其私人邮箱的无用邮件变得无法忍受。</p>
<h3 id="Stack-Overflow"><a href="#Stack-Overflow" class="headerlink" title="Stack Overflow"></a>Stack Overflow</h3><p>搜索，<strong>然后</strong> 在 Stack Exchange 问。</p>
<p>近年来，Stack Exchange community 社区已经成为回答技术及其他问题的主要渠道，尤其是那些开放源码的项目。</p>
<p>因为 Google 索引是即时的，在看 Stack Exchange 之前先在 Google 搜索。有很高的机率某人已经问了一个类似的问题，而且 Stack Exchange 网站们往往会是搜索结果中最前面几个。如果你在 Google 上没有找到任何答案，你再到特定相关主题的网站去找。用标签（Tag）搜索能让你更缩小你的搜索结果。</p>
<p>Stack Exchange 已经成长到<a href="http://stackexchange.com/sites" target="_blank" rel="noopener">超过一百个网站</a>，以下是最常用的几个站：</p>
<ul>
<li>Super User 是问一些通用的电脑问题，如果你的问题跟代码或是写程序无关，只是一些网络连线之类的，请到这里。</li>
<li>Stack Overflow 是问写程序有关的问题。</li>
<li>Server Fault 是问服务器和网管相关的问题。</li>
</ul>
<h3 id="网站和-IRC-论坛"><a href="#网站和-IRC-论坛" class="headerlink" title="网站和 IRC 论坛"></a>网站和 IRC 论坛</h3><p>本地的使用者群组（user group），或者你所用的 Linux 发行版本也许正在宣传他们的网页论坛或 IRC 频道，并提供新手帮助（在一些非英语国家，新手论坛很可能还是邮件列表）， 这些地方是开始提问的好首选，特别是当你觉得遇到的也许只是相对简单或者很普通的问题时。有广告赞助的 IRC 频道是公开欢迎提问的地方，通常可以即时得到回应。</p>
<p>事实上，如果程序出的问题只发生在特定 Linux 发行版提供的版本（这很常见），最好先去该发行版的论坛或邮件列表中提问，再到程序本身的论坛或邮件列表提问。（否则）该项目的黑客可能仅仅回复 “用<strong>我们的</strong>版本”。</p>
<p>在任何论坛发文以前，先确认一下有没有搜索功能。如果有，就试着搜索一下问题的几个关键词，也许这会有帮助。如果在此之前你已做过通用的网页搜索（你也该这样做），还是再搜索一下论坛，搜索引擎有可能没来得及索引此论坛的全部内容。</p>
<p>通过论坛或 IRC 频道来提供使用者支持服务有增长的趋势，电子邮件则大多为项目开发者间的交流而保留。所以最好先在论坛或 IRC 中寻求与该项目相关的协助。</p>
<p>在使用 IRC 的时候，首先最好不要发布很长的问题描述，有些人称之为频道洪水。最好通过一句话的问题描述来开始聊天。</p>
<h3 id="第二步，使用项目邮件列表"><a href="#第二步，使用项目邮件列表" class="headerlink" title="第二步，使用项目邮件列表"></a>第二步，使用项目邮件列表</h3><p>当某个项目提供开发者邮件列表时，要向列表而不是其中的个别成员提问，即使你确信他能最好地回答你的问题。查一查项目的文件和首页，找到项目的邮件列表并使用它。有几个很好的理由支持我们采用这种办法：</p>
<ul>
<li>任何好到需要向个别开发者提出的问题，也将对整个项目群组有益。反之，如果你认为自己的问题对整个项目群组来说太愚蠢，也不能成为骚扰个别开发者的理由。</li>
<li>向列表提问可以分散开发者的负担，个别开发者（尤其是项目领导人）也许太忙以至于没法回答你的问题。</li>
<li>大多数邮件列表都会被存档，那些被存档的内容将被搜索引擎索引。如果你向列表提问并得到解答，将来其它人可以通过网页搜索找到你的问题和答案，也就不用再次发问了。</li>
<li>如果某些问题经常被问到，开发者可以利用此信息来改进说明文件或软件本身，以使其更清楚。如果只是私下提问，就没有人能看到最常见问题的完整场景。</li>
</ul>
<p>如果一个项目既有”使用者” 也有”开发者”（或”黑客”）邮件列表或论坛，而你又不会动到那些源代码，那么就向”使用者”列表或论坛提问。不要假设自己会在开发者列表中受到欢迎，那些人多半会将你的提问视为干扰他们开发的噪音。</p>
<p>然而，如果你<strong>确信</strong>你的问题很特别，而且在”使用者” 列表或论坛中几天都没有回复，可以试试前往”开发者”列表或论坛发问。建议你在张贴前最好先暗地里观察几天以了解那里的行事方式（事实上这是参与任何私有或半私有列表的好主意）</p>
<p>如果你找不到一个项目的邮件列表，而只能查到项目维护者的电子邮件地址，尽管向他发信。即使是在这种情况下，也别假设（项目）邮件列表不存在。在你的电子邮件中，请陈述你已经试过但没有找到合适的邮件列表，也提及你不反对将自己的邮件转发给他人（许多人认为，即使没什么秘密，私人电子邮件也不应该被公开。通过允许将你的电子邮件转发他人，你给了相应人员处置你邮件的选择）。</p>
<h3 id="使用有意义且描述明确的标题"><a href="#使用有意义且描述明确的标题" class="headerlink" title="使用有意义且描述明确的标题"></a>使用有意义且描述明确的标题</h3><p>在邮件列表、新闻群组或论坛中，大约 50 字以内的标题是抓住资深专家注意力的好机会。别用喋喋不休的<code>帮帮忙</code>、<code>跪求</code>、<code>急</code>（更别说<code>救命啊！！！！</code>这样让人反感的话，用这种标题会被条件反射式地忽略）来浪费这个机会。不要妄想用你的痛苦程度来打动我们，而应该是在这点空间中使用极简单扼要的描述方式来提出问题。</p>
<p>一个好标题范例是<code>目标 —— 差异</code>式的描述，许多技术支持组织就是这样做的。在<code>目标</code>部分指出是哪一个或哪一组东西有问题，在<code>差异</code>部分则描述与期望的行为不一致的地方。</p>
<blockquote>
<p>蠢问题：救命啊！我的笔记本电脑不能正常显示了！</p>
</blockquote>
<blockquote>
<p>聪明问题：X.org 6.8.1 的鼠标光标会变形，某牌显卡 MV1005 芯片组。</p>
</blockquote>
<blockquote>
<p>更聪明问题：X.org 6.8.1 的鼠标光标，在某牌显卡 MV1005 芯片组环境下 - 会变形。</p>
</blockquote>
<p>编写<code>目标 —— 差异</code> 式描述的过程有助于你组织对问题的细致思考。是什么被影响了？ 仅仅是鼠标光标或者还有其它图形？只在 X.org 的 X 版中出现？或只是出现在 6.8.1 版中？ 是针对某牌显卡芯片组？或者只是其中的 MV1005 型号？ 一个黑客只需瞄一眼就能够立即明白你的环境<strong>和</strong>你遇到的问题。</p>
<p>总而言之，请想像一下你正在一个只显示标题的存档讨论串（Thread）索引中查寻。让你的标题更好地反映问题，可使下一个搜索类似问题的人能够关注这个讨论串，而不用再次提问相同的问题。</p>
<p>如果你想在回复中提出问题，记得要修改内容标题，以表明你是在问一个问题， 一个看起来像 <code>Re: 测试</code> 或者 <code>Re: 新 bug</code> 的标题很难引起足够重视。另外，在不影响连贯性之下，适当引用并删减前文的内容，能给新来的读者留下线索。</p>
<p>对于讨论串，不要直接点击回复来开始一个全新的讨论串，这将限制你的观众。因为有些邮件阅读程序，比如 mutt ，允许使用者按讨论串排序并通过折叠讨论串来隐藏消息，这样做的人永远看不到你发的消息。</p>
<p>仅仅改变标题还不够。mutt 和其它一些邮件阅读程序还会检查邮件标题以外的其它信息，以便为其指定讨论串。所以宁可发一个全新的邮件。</p>
<p>在网页论坛上，好的提问方式稍有不同，因为讨论串与特定的信息紧密结合，并且通常在讨论串外就看不到里面的内容，故通过回复提问，而非改变标题是可接受的。不是所有论坛都允许在回复中出现分离的标题，而且这样做了基本上没有人会去看。不过，通过回复提问，这本身就是暧昧的做法，因为它们只会被正在查看该标题的人读到。所以，除非你<strong>只想</strong>在该讨论串当前活跃的人群中提问，不然还是另起炉灶比较好。</p>
<h3 id="使问题容易回复"><a href="#使问题容易回复" class="headerlink" title="使问题容易回复"></a>使问题容易回复</h3><p>以<code>请将你的回复发送到……</code>来结束你的问题多半会使你得不到回答。如果你觉得花几秒钟在邮件客户端设置一下回复地址都麻烦，我们也觉得花几秒钟思考你的问题更麻烦。如果你的邮件程序不支持这样做，<a href="http://linuxmafia.com/faq/Mail/muas.html" target="_blank" rel="noopener">换个好点的</a>；如果是操作系统不支持这种邮件程序，也换个好点的。</p>
<p>在论坛，要求通过电子邮件回复是非常无礼的，除非你认为回复的信息可能比较敏感（有人会为了某些未知的原因，只让你而不是整个论坛知道答案）。如果你只是想在有人回复讨论串时得到电子邮件提醒，可以要求网页论坛发送给你。几乎所有论坛都支持诸如<code>追踪此讨论串</code>、<code>有回复时发送邮件提醒</code>等功能。</p>
<h3 id="用清晰、正确、精准并语法正确的语句"><a href="#用清晰、正确、精准并语法正确的语句" class="headerlink" title="用清晰、正确、精准并语法正确的语句"></a>用清晰、正确、精准并语法正确的语句</h3><p>我们从经验中发现，粗心的提问者通常也会粗心的写程序与思考（我敢打包票）。回答粗心大意者的问题很不值得，我们宁愿把时间耗在别处。</p>
<p>正确的拼写、标点符号和大小写是很重要的。一般来说，如果你觉得这样做很麻烦，不想在乎这些，那我们也觉得麻烦，不想在乎你的提问。花点额外的精力斟酌一下字句，用不着太僵硬与正式 —— 事实上，黑客文化很看重能准确地使用非正式、俚语和幽默的语句。但它<strong>必须很</strong>准确，而且有迹象表明你是在思考和关注问题。</p>
<p>正确地拼写、使用标点和大小写，不要将<code>its</code>混淆为<code>it&#39;s</code>，<code>loose</code>搞成<code>lose</code>或者将<code>discrete</code>弄成<code>discreet</code>。不要<strong>全部用大写</strong>，这会被视为无礼的大声嚷嚷（全部小写也好不到哪去，因为不易阅读。<a href="http://en.wikipedia.org/wiki/Alan_Cox" target="_blank" rel="noopener">Alan Cox</a> 也许可以这样做，但你不行）。</p>
<p>更白话的说，如果你写得像是个半文盲[译注：<a href="http://zh.wikipedia.org/wiki/小白" target="_blank" rel="noopener">小白</a>]，那多半得不到理睬。也不要使用即时通信中的简写或<a href="http://zh.wikipedia.org/wiki/火星文" target="_blank" rel="noopener">火星文</a>，如将<code>的</code>简化为<code>d</code>会使你看起来像一个为了少打几个键而省字的小白。更糟的是，如果像个小孩似地鬼画符那绝对是在找死，可以肯定没人会理你（或者最多是给你一大堆指责与挖苦）。</p>
<p>如果在使用非母语的论坛提问，你可以犯点拼写和语法上的小错，但决不能在思考上马虎（没错，我们通常能弄清两者的分别）。同时，除非你知道回复者使用的语言，否则请使用英语书写。繁忙的黑客一般会直接删除用他们看不懂语言写的消息。在网络上英语是通用语言，用英语书写可以将你的问题在尚未被阅读就被直接删除的可能性降到最低。</p>
<p>如果英文是你的外语（Second language），提示潜在回复者你有潜在的语言困难是很好的：<br>[译注：以下附上原文以供使用]</p>
<blockquote>
<p>English is not my native language; please excuse typing errors.</p>
</blockquote>
<ul>
<li>英文不是我的母语，请原谅我的错字或语法。</li>
</ul>
<blockquote>
<p>If you speak $LANGUAGE, please email/PM me;<br>I may need assistance translating my question.</p>
</blockquote>
<ul>
<li>如果你说<strong>某语言</strong>，请寄信/私讯给我；我需要有人协助我翻译我的问题。</li>
</ul>
<blockquote>
<p>I am familiar with the technical terms,<br>but some slang expressions and idioms are difficult for me.</p>
</blockquote>
<ul>
<li>我对技术名词很熟悉，但对于俗语或是特别用法比较不甚了解。</li>
</ul>
<blockquote>
<p>I’ve posted my question in $LANGUAGE and English.<br>I’ll be glad to translate responses, if you only use one or the other.</p>
</blockquote>
<ul>
<li>我把我的问题用<strong>某语言</strong>和英文写出来，如果你只用一种语言回答，我会乐意将其翻译成另一种。</li>
</ul>
<h3 id="使用易于读取且标准的文件格式发送问题"><a href="#使用易于读取且标准的文件格式发送问题" class="headerlink" title="使用易于读取且标准的文件格式发送问题"></a>使用易于读取且标准的文件格式发送问题</h3><p>如果你人为地将问题搞得难以阅读，它多半会被忽略，人们更愿读易懂的问题，所以：</p>
<ul>
<li>使用纯文字而不是 HTML (<a href="http://archive.birdhouse.org/etc/evilmail.html" target="_blank" rel="noopener">关闭 HTML</a> 并不难）。</li>
<li>使用 MIME 附件通常是可以的，前提是真正有内容（譬如附带的源代码或 patch），而不仅仅是邮件程序生成的模板（譬如只是信件内容的拷贝）。</li>
<li>不要发送一段文字只是一行句子但自动换行后会变成多行的邮件（这使得回复部分内容非常困难）。设想你的读者是在 80 个字符宽的终端机上阅读邮件，最好设置你的换行分割点小于 80 字。</li>
<li>但是，对一些特殊的文件<strong>不要</strong>设置固定宽度（譬如日志档案拷贝或会话记录）。数据应该原样包含，让回复者有信心他们看到的是和你看到的一样的东西。</li>
<li>在英语论坛中，不要使用<code>Quoted-Printable</code> MIME 编码发送消息。这种编码对于张贴非 ASCII 语言可能是必须的，但很多邮件程序并不支持这种编码。当它们处理换行时，那些文本中四处散布的<code>=20</code>符号既难看也分散注意力，甚至有可能破坏内容的语意。</li>
<li>绝对，<strong>永远</strong>不要指望黑客们阅读使用封闭格式编写的文档，像微软公司的 Word 或 Excel 文件等。大多数黑客对此的反应就像有人将还在冒热气的猪粪倒在你家门口时你的反应一样。即便他们能够处理，他们也很厌恶这么做。</li>
<li>如果你从使用 Windows 的电脑发送电子邮件，关闭微软愚蠢的<code>智能引号</code>功能 （从[选项] &gt; [校订] &gt; [自动校正选项]，勾选掉<code>智能引号</code>单选框），以免在你的邮件中到处散布垃圾字符。</li>
<li>在论坛，勿滥用<code>表情符号</code>和<code>HTML</code>功能（当它们提供时）。一两个表情符号通常没有问题，但花哨的彩色文本倾向于使人认为你是个无能之辈。过滥地使用表情符号、色彩和字体会使你看来像个傻笑的小姑娘。这通常不是个好主意，除非你只是对性而不是对答案感兴趣。</li>
</ul>
<p>如果你使用图形用户界面的邮件程序（如微软公司的 Outlook 或者其它类似的），注意它们的默认设置不一定满足这些要求。大多数这类程序有基于选单的<code>查看源代码</code>命令，用它来检查发送文件夹中的邮件，以确保发送的是纯文本文件同时没有一些奇怪的字符。</p>
<h3 id="精确地描述问题并言之有物"><a href="#精确地描述问题并言之有物" class="headerlink" title="精确地描述问题并言之有物"></a>精确地描述问题并言之有物</h3><ul>
<li>仔细、清楚地描述你的问题或 Bug 的症状。</li>
<li>描述问题发生的环境（机器配置、操作系统、应用程序、以及相关的信息），提供经销商的发行版和版本号（如：<code>Fedora Core 4</code>、<code>Slackware 9.1</code>等）。</li>
<li>描述在提问前你是怎样去研究和理解这个问题的。</li>
<li>描述在提问前为确定问题而采取的诊断步骤。</li>
<li>描述最近做过什么可能相关的硬件或软件变更。</li>
<li>尽可能的提供一个可以<code>重现这个问题的可控环境</code>的方法。</li>
</ul>
<p>尽量去揣测一个黑客会怎样反问你，在你提问之前预先将黑客们可能遇到的问题回答一遍。</p>
<p>以上几点中，当你报告的是你认为可能在代码中的问题时，给黑客一个可以重现你的问题的环境尤其重要。当你这么做时，你得到有效的回答的机会和速度都会大大的提升。</p>
<p><a href="http://www.chiark.greenend.org.uk/~sgtatham/" target="_blank" rel="noopener">Simon Tatham</a> 写过一篇名为《<a href="http://www.chiark.greenend.org.uk/~sgtatham/bugs-cn.html" target="_blank" rel="noopener">如何有效的报告 Bug</a>》的出色文章。强力推荐你也读一读。</p>
<h3 id="话不在多而在精"><a href="#话不在多而在精" class="headerlink" title="话不在多而在精"></a>话不在多而在精</h3><p>你需要提供精确有内容的信息。这并不是要求你简单的把成堆的出错代码或者资料完全转录到你的提问中。如果你有庞大而复杂的测试样例能重现程序挂掉的情境，尽量将它剪裁得越小越好。</p>
<p>这样做的用处至少有三点。<br>第一，表现出你为简化问题付出了努力，这可以使你得到回答的机会增加；<br>第二，简化问题使你更有可能得到<strong>有用</strong>的答案；<br>第三，在精炼你的 bug 报告的过程中，你很可能就自己找到了解决方法或权宜之计。</p>
<h3 id="别动辄声称找到-Bug"><a href="#别动辄声称找到-Bug" class="headerlink" title="别动辄声称找到 Bug"></a>别动辄声称找到 Bug</h3><p>当你在使用软件中遇到问题，除非你非常、<strong>非常</strong>的有根据，不要动辄声称找到了 Bug。提示：除非你能提供解决问题的源代码补丁，或者提供回归测试来表明前一版本中行为不正确，否则你都多半不够完全确信。这同样适用在网页和文件，如果你（声称）发现了文件的<code>Bug</code>，你应该能提供相应位置的修正或替代文件。</p>
<p>请记得，还有许多其它使用者没遇到你发现的问题，否则你在阅读文件或搜索网页时就应该发现了（你在抱怨前<a href="#在提问之前">已经做了这些，是吧</a>？）。这也意味着很有可能是你弄错了而不是软件本身有问题。</p>
<p>编写软件的人总是非常辛苦地使它尽可能完美。如果你声称找到了 Bug，也就是在质疑他们的能力，即使你是对的，也有可能会冒犯到其中某部分人。当你在标题中嚷嚷着有<code>Bug</code>时，这尤其严重。</p>
<p>提问时，即使你私下非常确信已经发现一个真正的 Bug，最好写得像是<strong>你</strong>做错了什么。如果真的有 Bug，你会在回复中看到这点。这样做的话，如果真有 Bug，维护者就会向你道歉，这总比你惹恼别人然后欠别人一个道歉要好一点。</p>
<h3 id="低声下气不能代替你的功课"><a href="#低声下气不能代替你的功课" class="headerlink" title="低声下气不能代替你的功课"></a>低声下气不能代替你的功课</h3><p>有些人明白他们不该粗鲁或傲慢的提问并要求得到答复，但他们选择另一个极端 —— 低声下气：<code>我知道我只是个可悲的新手，一个撸瑟，但...</code>。这既使人困扰，也没有用，尤其是伴随着与实际问题含糊不清的描述时更令人反感。</p>
<p>别用原始灵长类动物的把戏来浪费你我的时间。取而代之的是，尽可能清楚地描述背景条件和你的问题情况。这比低声下气更好地定位了你的位置。</p>
<p>有时网页论坛会设有专为新手提问的版面，如果你真的认为遇到了初学者的问题，到那去就是了，但一样别那么低声下气。</p>
<h3 id="描述问题症状而非你的猜测"><a href="#描述问题症状而非你的猜测" class="headerlink" title="描述问题症状而非你的猜测"></a>描述问题症状而非你的猜测</h3><p>告诉黑客们你认为问题是怎样造成的并没什么帮助。（如果你的推断如此有效，还用向别人求助吗？），因此要确信你原原本本告诉了他们问题的症状，而不是你的解释和理论；让黑客们来推测和诊断。如果你认为陈述自己的猜测很重要，清楚地说明这只是你的猜测，并描述为什么它们不起作用。</p>
<p><strong>蠢问题</strong></p>
<blockquote>
<p>我在编译内核时接连遇到 SIG11 错误，<br>我怀疑某条飞线搭在主板的走线上了，这种情况应该怎样检查最好？</p>
</blockquote>
<p><strong>聪明问题</strong></p>
<blockquote>
<p>我的组装电脑是 FIC-PA2007 主机板搭载 AMD K6/233 CPU（威盛 Apollo VP2 芯片组），<br>256MB Corsair PC133 SDRAM 内存，在编译内核时，从开机 20 分钟以后就频频产生 SIG11 错误，<br>但是在头 20 分钟内从没发生过相同的问题。重新启动也没有用，但是关机一晚上就又能工作 20 分钟。<br>所有内存都换过了，没有效果。相关部分的标准编译记录如下…。</p>
</blockquote>
<p>由于以上这点似乎让许多人觉得难以配合，这里有句话可以提醒你：<code>所有的诊断专家都来自密苏里州。</code> 美国国务院的官方座右铭则是：<code>让我看看</code>（出自国会议员 Willard D. Vandiver 在 1899 年时的讲话：<code>我来自一个出产玉米，棉花，牛蒡和民主党人的国家，滔滔雄辩既不能说服我，也不会让我满意。我来自密苏里州，你必须让我看看。</code>） 针对诊断者而言，这并不是一种怀疑，而只是一种真实而有用的需求，以便让他们看到的是与你看到的原始证据尽可能一致的东西，而不是你的猜测与归纳的结论。所以，大方的展示给我们看吧！</p>
<h3 id="按发生时间先后列出问题症状"><a href="#按发生时间先后列出问题症状" class="headerlink" title="按发生时间先后列出问题症状"></a>按发生时间先后列出问题症状</h3><p>问题发生前的一系列操作，往往就是对找出问题最有帮助的线索。因此，你的说明里应该包含你的操作步骤，以及机器和软件的反应，直到问题发生。在命令行处理的情况下，提供一段操作记录（例如运行脚本工具所生成的），并引用相关的若干行（如 20 行）记录会非常有帮助。</p>
<p>如果挂掉的程序有诊断选项（如 -v 的详述开关），试着选择这些能在记录中增加调试信息的选项。记住，<code>多</code>不等于<code>好</code>。试着选取适当的调试级别以便提供有用的信息而不是让读者淹没在垃圾中。</p>
<p>如果你的说明很长（如超过四个段落），在开头简述问题，接下来再按时间顺序详述会有所帮助。这样黑客们在读你的记录时就知道该注意哪些内容了。</p>
<h3 id="描述目标而不是过程"><a href="#描述目标而不是过程" class="headerlink" title="描述目标而不是过程"></a>描述目标而不是过程</h3><p>如果你想弄清楚如何做某事（而不是报告一个 Bug），在开头就描述你的目标，然后才陈述重现你所卡住的特定步骤。</p>
<p>经常寻求技术帮助的人在心中有个更高层次的目标，而他们在自以为能达到目标的特定道路上被卡住了，然后跑来问该怎么走，但没有意识到这条路本身就有问题。结果要费很大的劲才能搞定。</p>
<p><strong>蠢问题</strong></p>
<blockquote>
<p>我怎样才能从某绘图程序的颜色选择器中取得十六进制的的 RGB 值？</p>
</blockquote>
<p><strong>聪明问题</strong></p>
<blockquote>
<p>我正试着用替换一幅图片的色码（color table）成自己选定的色码，我现在知道的唯一方法是编辑每个色码区块（table slot），<br>但却无法从某绘图程序的颜色选择器取得十六进制的的 RGB 值。</p>
</blockquote>
<p>第二种提问法比较聪明，你可能得到像是<code>建议采用另一个更合适的工具</code>的回复。</p>
<h3 id="别要求使用私人电邮回复"><a href="#别要求使用私人电邮回复" class="headerlink" title="别要求使用私人电邮回复"></a>别要求使用私人电邮回复</h3><p>黑客们认为问题的解决过程应该公开、透明，此过程中如果更有经验的人注意到不完整或者不当之处，最初的回复才能够、也应该被纠正。同时，作为提供帮助者可以得到一些奖励，奖励就是他的能力和学识被其他同行看到。</p>
<p>当你要求私下回复时，这个过程和奖励都被中止。别这样做，让<strong>回复者</strong>来决定是否私下回答 —— 如果他真这么做了，通常是因为他认为问题编写太差或者太肤浅，以至于对其它人没有兴趣。</p>
<p>这条规则存在一条有限的例外，如果你确信提问可能会引来大量雷同的回复时，那么这个神奇的提问句会是<code>向我发电邮，我将为论坛归纳这些回复</code>。试着将邮件列表或新闻群组从洪水般的雷同回复中解救出来是非常有礼貌的 —— 但你必须信守诺言。</p>
<h3 id="清楚明确的表达你的问题以及需求"><a href="#清楚明确的表达你的问题以及需求" class="headerlink" title="清楚明确的表达你的问题以及需求"></a>清楚明确的表达你的问题以及需求</h3><p>漫无边际的提问是近乎无休无止的时间黑洞。最有可能给你有用答案的人通常也正是最忙的人（他们忙是因为要亲自完成大部分工作）。这样的人对无节制的时间黑洞相当厌恶，所以他们也倾向于厌恶那些漫无边际的提问。</p>
<p>如果你明确表述需要回答者做什么（如提供指点、发送一段代码、检查你的补丁、或是其他等等），就最有可能得到有用的答案。因为这会定出一个时间和精力的上限，便于回答者能集中精力来帮你。这么做很棒。</p>
<p>要理解专家们所处的世界，请把专业技能想像为充裕的资源，而回复的时间则是稀缺的资源。你要求他们奉献的时间越少，你越有可能从真正专业而且很忙的专家那里得到解答。</p>
<p>所以，界定一下你的问题，使专家花在辨识你的问题和回答所需要付出的时间减到最少，这技巧对你有用答案相当有帮助 —— 但这技巧通常和简化问题有所区别。因此，问<code>我想更好的理解 X，可否指点一下哪有好一点说明？</code>通常比问<code>你能解释一下 X 吗？</code>更好。如果你的代码不能运作，通常请别人看看哪里有问题，比要求别人替你改正要明智得多。</p>
<h3 id="询问有关代码的问题时"><a href="#询问有关代码的问题时" class="headerlink" title="询问有关代码的问题时"></a>询问有关代码的问题时</h3><p>别要求他人帮你调试有问题的代码，不提示一下应该从何入手。张贴几百行的代码，然后说一声：<code>它不能工作</code>会让你完全被忽略。只贴几十行代码，然后说一句：<code>在第七行以后，我期待它显示 &lt;x&gt;，但实际出现的是 &lt;y&gt;</code>比较有可能让你得到回应。</p>
<p>最有效描述程序问题的方法是提供最精简的 Bug 展示测试用例（bug-demonstrating test case）。什么是最精简的测试用例？那是问题的缩影；一小个程序片段能<strong>刚好</strong>展示出程序的异常行为，而不包含其他令人分散注意力的内容。怎么制作最精简的测试用例？如果你知道哪一行或哪一段代码会造成异常的行为，复制下来并加入足够重现这个状况的代码（例如，足以让这段代码能被编译/直译/被应用程序处理）。如果你无法将问题缩减到一个特定区块，就复制一份代码并移除不影响产生问题行为的部分。总之，测试用例越小越好（查看<a href="#话不在多而在精">话不在多而在精</a>一节）。</p>
<p>一般而言，要得到一段相当精简的测试用例并不太容易，但永远先尝试这样做的是种好习惯。这种方式可以帮助你了解如何自行解决这个问题 —— 而且即使你的尝试不成功，黑客们也会看到你在尝试取得答案的过程中付出了努力，这可以让他们更愿意与你合作。</p>
<p>如果你只是想让别人帮忙审查（Review）一下代码，在信的开头就要说出来，并且一定要提到你认为哪一部分特别需要关注以及为什么。</p>
<h3 id="别把自己家庭作业的问题贴上来"><a href="#别把自己家庭作业的问题贴上来" class="headerlink" title="别把自己家庭作业的问题贴上来"></a>别把自己家庭作业的问题贴上来</h3><p>黑客们很擅长分辨哪些问题是家庭作业式的问题；因为我们中的大多数都曾自己解决这类问题。同样，这些问题得由<strong>你</strong>来搞定，你会从中学到东西。你可以要求给点提示，但别要求得到完整的解决方案。</p>
<p>如果你怀疑自己碰到了一个家庭作业式的问题，但仍然无法解决，试试在使用者群组，论坛或（最后一招）在项目的<strong>使用者</strong>邮件列表或论坛中提问。尽管黑客们<strong>会</strong>看出来，但一些有经验的使用者也许仍会给你一些提示。</p>
<h3 id="去掉无意义的提问句"><a href="#去掉无意义的提问句" class="headerlink" title="去掉无意义的提问句"></a>去掉无意义的提问句</h3><p>避免用无意义的话结束提问，例如<code>有人能帮我吗？</code>或者<code>这有答案吗？</code>。</p>
<p>首先：如果你对问题的描述不是很好，这样问更是画蛇添足。</p>
<p>其次：由于这样问是画蛇添足，黑客们会很厌烦你 —— 而且通常会用逻辑上正确，但毫无意义的回答来表示他们的蔑视， 例如：<code>没错，有人能帮你</code>或者<code>不，没答案</code>。</p>
<p>一般来说，避免用 <code>是或否</code>、<code>对或错</code>、<code>有或没有</code>类型的问句，除非你想得到<a href="http://homepage.ntlworld.com./jonathan.deboynepollard/FGA/questions-with-yes-or-no-answers.html" target="_blank" rel="noopener">是或否类型的回答</a>。</p>
<h3 id="即使你很急也不要在标题写紧急"><a href="#即使你很急也不要在标题写紧急" class="headerlink" title="即使你很急也不要在标题写紧急"></a>即使你很急也不要在标题写<code>紧急</code></h3><p>这是你的问题，不是我们的。宣称<code>紧急</code>极有可能事与愿违：大多数黑客会直接删除无礼和自私地企图即时引起关注的问题。更严重的是，<code>紧急</code>这个字（或是其他企图引起关注的标题）通常会被垃圾信过滤器过滤掉 —— 你希望能看到你问题的人可能永远也看不到。</p>
<p>有半个例外的情况是，如果你是在一些很高调，会使黑客们兴奋的地方，也许值得这样去做。在这种情况下，如果你有时间压力，也很有礼貌地提到这点，人们也许会有兴趣回答快一点。</p>
<p>当然，这风险很大，因为黑客们兴奋的点多半与你的不同。譬如从 NASA 国际空间站（International Space Station）发这样的标题没有问题，但用自我感觉良好的慈善行为或政治原因发肯定不行。事实上，张贴诸如<code>紧急：帮我救救这个毛绒绒的小海豹！</code>肯定让你被黑客忽略或惹恼他们，即使他们认为毛绒绒的小海豹很重要。</p>
<p>如果你觉得这点很不可思议，最好再把这份指南剩下的内容多读几遍，直到你弄懂了再发文。</p>
<h3 id="礼多人不怪，而且有时还很有帮助"><a href="#礼多人不怪，而且有时还很有帮助" class="headerlink" title="礼多人不怪，而且有时还很有帮助"></a>礼多人不怪，而且有时还很有帮助</h3><p>彬彬有礼，多用<code>请</code>和<code>谢谢您的关注</code>，或<code>谢谢你的关照</code>。让大家都知道你对他们花时间免费提供帮助心存感激。</p>
<p>坦白说，这一点并没有比清晰、正确、精准并合法语法和避免使用专用格式重要（也不能取而代之）。黑客们一般宁可读有点唐突但技术上鲜明的 Bug 报告，而不是那种有礼但含糊的报告。（如果这点让你不解，记住我们是按问题能教给我们什么来评价问题的价值的）</p>
<p>然而，如果你有一串的问题待解决，客气一点肯定会增加你得到有用回应的机会。</p>
<p>（我们注意到，自从本指南发布后，从资深黑客那里得到的唯一严重缺陷反馈，就是对预先道谢这一条。一些黑客觉得<code>先谢了</code>意味着事后就不用再感谢任何人的暗示。我们的建议是要么先说<code>先谢了</code>，<strong>然后</strong>事后再对回复者表示感谢，或者换种方式表达感激，譬如用<code>谢谢你的关注</code>或<code>谢谢你的关照</code>。）</p>
<h3 id="问题解决后，加个简短的补充说明"><a href="#问题解决后，加个简短的补充说明" class="headerlink" title="问题解决后，加个简短的补充说明"></a>问题解决后，加个简短的补充说明</h3><p>问题解决后，向所有帮助过你的人发个说明，让他们知道问题是怎样解决的，并再一次向他们表示感谢。如果问题在新闻组或者邮件列表中引起了广泛关注，应该在那里贴一个说明比较恰当。</p>
<p>最理想的方式是向最初提问的话题回复此消息，并在标题中包含<code>已修正</code>，<code>已解决</code>或其它同等含义的明显标记。在人来人往的邮件列表里，一个看见讨论串<code>问题 X</code>和<code>问题 X - 已解决</code>的潜在回复者就明白不用再浪费时间了（除非他个人觉得<code>问题 X</code>的有趣），因此可以利用此时间去解决其它问题。</p>
<p>补充说明不必很长或是很深入；简单的一句<code>你好，原来是网线出了问题！谢谢大家 – Bill</code>比什么也不说要来的好。事实上，除非结论真的很有技术含量，否则简短可爱的小结比长篇大论更好。说明问题是怎样解决的，但大可不必将解决问题的过程复述一遍。</p>
<p>对于有深度的问题，张贴调试记录的摘要是有帮助的。描述问题的最终状态，说明是什么解决了问题，在此<strong>之后</strong>才指明可以避免的盲点。避免盲点的部分应放在正确的解决方案和其它总结材料之后，而不要将此信息搞成侦探推理小说。列出那些帮助过你的名字，会让你交到更多朋友。</p>
<p>除了有礼貌和有内涵以外，这种类型的补充也有助于他人在邮件列表/新闻群组/论坛中搜索到真正解决你问题的方案，让他们也从中受益。</p>
<p>至少，这种补充有助于让每位参与协助的人因问题的解决而从中得到满足感。如果你自己不是技术专家或者黑客，那就相信我们，这种感觉对于那些你向他们求助的大师或者专家而言，是非常重要的。问题悬而未决会让人灰心；黑客们渴望看到问题被解决。好人有好报，满足他们的渴望，你会在下次提问时尝到甜头。</p>
<p>思考一下怎样才能避免他人将来也遇到类似的问题，自问写一份文件或加个常见问题（FAQ）会不会有帮助。如果是的话就将它们发给维护者。</p>
<p>在黑客中，这种良好的后继行动实际上比传统的礼节更为重要，也是你如何透过善待他人而赢得声誉的方式，这是非常有价值的资产。</p>
<h2 id="如何解读答案"><a href="#如何解读答案" class="headerlink" title="如何解读答案"></a>如何解读答案</h2><h3 id="RTFM-和-STFW：如何知道你已完全搞砸了"><a href="#RTFM-和-STFW：如何知道你已完全搞砸了" class="headerlink" title="RTFM 和 STFW：如何知道你已完全搞砸了"></a>RTFM 和 STFW：如何知道你已完全搞砸了</h3><p>有一个古老而神圣的传统：如果你收到<code>RTFM （Read The Fucking Manual）</code>的回应，回答者认为你<strong>应该去读他妈的手册</strong>。当然，基本上他是对的，你应该去读一读。</p>
<p>RTFM 有一个年轻的亲戚。如果你收到<code>STFW（Search The Fucking Web）</code>的回应，回答者认为你<strong>应该到他妈的网上搜索</strong>。那人多半也是对的，去搜索一下吧。（更温和一点的说法是 <strong><a href="http://lmgtfy.com/" target="_blank" rel="noopener">Google 是你的朋友</a></strong>！）</p>
<p>在论坛，你也可能被要求去爬爬论坛的旧文。事实上，有人甚至可能热心地为你提供以前解决此问题的讨论串。但不要依赖这种关照，提问前应该先搜索一下旧文。</p>
<p>通常，用这两句之一回答你的人会给你一份包含你需要内容的手册或者一个网址，而且他们打这些字的时候也正在读着。这些答复意味着回答者认为</p>
<ul>
<li><strong>你需要的信息非常容易获得</strong>；</li>
<li><strong>你自己去搜索这些信息比灌给你，能让你学到更多</strong>。</li>
</ul>
<p>你不应该因此不爽；<strong>依照黑客的标准，他已经表示了对你一定程度的关注，而没有对你的要求视而不见</strong>。你应该对他祖母般的慈祥表示感谢。</p>
<h3 id="如果还是搞不懂"><a href="#如果还是搞不懂" class="headerlink" title="如果还是搞不懂"></a>如果还是搞不懂</h3><p>如果你看不懂回应，别立刻要求对方解释。像你以前试着自己解决问题时那样（利用手册，FAQ，网络，身边的高手），先试着去搞懂他的回应。如果你真的需要对方解释，记得表现出你已经从中学到了点什么。</p>
<p>比方说，如果我回答你：<code>看来似乎是 zentry 卡住了；你应该先清除它。</code>，然后，这是一个<strong>很糟的</strong>后续问题回应：<code>zentry 是什么？</code> <strong>好</strong>的问法应该是这样：<code>哦~~~我看过说明了但是只有 -z 和 -p 两个参数中提到了 zentries，而且还都没有清楚的解释如何清除它。你是指这两个中的哪一个吗？还是我看漏了什么？</code></p>
<h3 id="处理无礼的回应"><a href="#处理无礼的回应" class="headerlink" title="处理无礼的回应"></a>处理无礼的回应</h3><p>很多黑客圈子中看似无礼的行为并不是存心冒犯。相反，它是直接了当，一针见血式的交流风格，这种风格更注重解决问题，而不是使人感觉舒服而却模模糊糊。</p>
<p>如果你觉得被冒犯了，试着平静地反应。如果有人真的做了出格的事，邮件列表、新闻群组或论坛中的前辈多半会招呼他。如果这<strong>没有</strong>发生而你却发火了，那么你发火对象的言语可能在黑客社区中看起来是正常的，而<strong>你</strong>将被视为有错的一方，这将伤害到你获取信息或帮助的机会。</p>
<p>另一方面，你偶尔真的会碰到无礼和无聊的言行。与上述相反，对真正的冒犯者狠狠地打击，用犀利的语言将其驳得体无完肤都是可以接受的。然而，在行事之前一定要非常非常的有根据。纠正无礼的言论与开始一场毫无意义的口水战仅一线之隔，黑客们自己莽撞地越线的情况并不鲜见。如果你是新手或外人，避开这种莽撞的机会并不高。如果你想得到的是信息而不是消磨时光，这时最好不要把手放在键盘上以免冒险。</p>
<p>（有些人断言很多黑客都有轻度的自闭症或亚斯伯格综合症，缺少用于润滑人类社会<strong>正常</strong>交往所需的神经。这既可能是真也可能是假的。如果你自己不是黑客，兴许你认为我们脑袋有问题还能帮助你应付我们的古怪行为。只管这么干好了，我们不在乎。我们<strong>喜欢</strong>我们现在这个样子，并且通常对病患标记都有站得住脚的怀疑）。</p>
<p>Jeff Bigler 的观察总结和这个相关也值得一读 (<strong><a href="http://www.mit.edu/~jcb/tact.html" target="_blank" rel="noopener">tact filters</a></strong>)。</p>
<p>在下一节，我们会谈到另一个问题，当<strong>你</strong>行为不当时所会受到的<code>冒犯</code>。</p>
<h2 id="如何避免扮演失败者"><a href="#如何避免扮演失败者" class="headerlink" title="如何避免扮演失败者"></a>如何避免扮演失败者</h2><p>在黑客社区的论坛中有那么几次你可能会搞砸 —— 以本指南所描述到的或类似的方式。而你会在公开场合中被告知你是如何搞砸的，也许攻击的言语中还会带点夹七夹八的颜色。</p>
<p>这种事发生以后，你能做的最糟糕的事莫过于哀嚎你的遭遇、宣称被口头攻击、要求道歉、高声尖叫、憋闷气、威胁诉诸法律、向其雇主报怨、忘了关马桶盖等等。相反地，你该这么做：</p>
<p>熬过去，这很正常。事实上，它是有益健康且合理的。</p>
<p>社区的标准不会自行维持，它们是通过参与者积极而<strong>公开地</strong>执行来维持的。不要哭嚎所有的批评都应该通过私下的邮件传送，它不是这样运作的。当有人评论你的一个说法有误或者提出不同看法时，坚持声称受到个人攻击也毫无益处，这些都是失败者的态度。</p>
<p>也有其它的黑客论坛，受过高礼节要求的误导，禁止参与者张贴任何对别人帖子挑毛病的消息，并声称<code>如果你不想帮助用户就闭嘴。</code> 结果造成有想法的参与者纷纷离开，这么做只会使它们沦为毫无意义的唠叨与无用的技术论坛。</p>
<p>夸张的讲法是：你要的是“友善”（以上述方式）还是有用？两个里面挑一个。</p>
<p>记着：当黑客说你搞砸了，并且（无论多么刺耳）告诉你别再这样做时，他正在为关心<strong>你</strong>和<strong>他的社区</strong>而行动。对他而言，不理你并将你从他的生活中滤掉更简单。如果你无法做到感谢，至少要表现得有点尊严，别大声哀嚎，也别因为自己是个有戏剧性超级敏感的灵魂和自以为有资格的新来者，就指望别人像对待脆弱的洋娃娃那样对你。</p>
<p>有时候，即使你没有搞砸（或者只是在他的想像中你搞砸了），有些人也会无缘无故地攻击你本人。在这种情况下，抱怨倒是<strong>真的</strong>会把问题搞砸。</p>
<p>这些来找麻烦的人要么是毫无办法但自以为是专家的不中用家伙，要么就是测试你是否真会搞砸的心理专家。其它读者要么不理睬，要么用自己的方式对付他们。这些来找麻烦的人在给他们自己找麻烦，这点你不用操心。</p>
<p>也别让自己卷入口水战，最好不要理睬大多数的口水战 – 当然，这是在你检验它们只是口水战，并且未指出你有搞砸的地方，同时也没有巧妙地将问题真正的答案藏于其后（这也是有可能的）。</p>
<h2 id="不该问的问题"><a href="#不该问的问题" class="headerlink" title="不该问的问题"></a>不该问的问题</h2><p>以下是几个经典蠢问题，以及黑客没回答时心中所想的：</p>
<p>问题：<a href="#q1">我能在哪找到 X 程序或 X 资源？</a></p>
<p>问题：<a href="#q2">我怎样用 X 做 Y？</a></p>
<p>问题：<a href="#q3">如何设定我的 shell 提示？</a></p>
<p>问题：<a href="#q4">我可以用 Bass-o-matic 文件转换工具将 AcmeCorp 档案转换为 TeX 格式吗？</a></p>
<p>问题：<a href="#q5">我的程序/设定/SQL 语句没有用</a></p>
<p>问题：<a href="#q6">我的 Windows 电脑有问题，你能帮我吗？</a></p>
<p>问题：<a href="#q7">我的程序不会动了，我认为系统工具 X 有问题</a></p>
<p>问题：<a href="#q8">我在安装 Linux（或者 X ）时有问题，你能帮我吗？</a></p>
<p>问题：<a href="#q9">我怎么才能破解 root 帐号/窃取 OP 特权/读别人的邮件呢？</a></p>
<hr>
<blockquote>
<p>问题：我能在哪找到 X 程序或 X 资源？</p>
</blockquote>
<p>回答：就在我找到它的地方啊，白痴 —— 搜索引擎的那一头。天哪！难道还有人不会用 <a href="http://www.google.com" target="_blank" rel="noopener">Google</a> 吗？</p>
<blockquote>
<p>问题：我怎样用 X 做 Y？</p>
</blockquote>
<p>回答：如果你想解决的是 Y ，提问时别给出可能并不恰当的方法。这种问题说明提问者不但对 X 完全无知，也对 Y 要解决的问题糊涂，还被特定形势禁锢了思维。最好忽略这种人，等他们把问题搞清楚了再说。</p>
<blockquote>
<p>问题：如何设定我的 shell 提示？？</p>
</blockquote>
<p>回答：如果你有足够的智慧提这个问题，你也该有足够的智慧去 <a href="#RTFM">RTFM</a>，然后自己去找出来。</p>
<blockquote>
<p>问题：我可以用 Bass-o-matic 文件转换工具将 AcmeCorp 档案转换为 TeX 格式吗？</p>
</blockquote>
<p>回答：试试看就知道了。如果你试过，你既知道了答案，就不用浪费我的时间了。</p>
<blockquote>
<p>问题：我的{程序/设定/SQL 语句}不工作</p>
</blockquote>
<p>回答：这不算是问题吧，我对要我问你二十个问题才找得出你真正问题的问题没兴趣 —— 我有更有意思的事要做呢。在看到这类问题的时候，我的反应通常不外如下三种</p>
<ul>
<li>你还有什么要补充的吗？</li>
<li>真糟糕，希望你能搞定。</li>
<li>这关我有什么屁事？</li>
</ul>
<blockquote>
<p>问题：我的 Windows 电脑有问题，你能帮我吗？</p>
</blockquote>
<p>回答：能啊，扔掉微软的垃圾，换个像 Linux 或 BSD 的开源操作系统吧。</p>
<p>注意：如果程序有官方版 Windows 或者与 Windows 有互动（如 Samba），你<strong>可以</strong>问与 Windows 相关的问题， 只是别对问题是由 Windows 操作系统而不是程序本身造成的回复感到惊讶， 因为 Windows 一般来说实在太烂，这种说法通常都是对的。</p>
<blockquote>
<p>问题：我的程序不会动了，我认为系统工具 X 有问题</p>
</blockquote>
<p>回答：你完全有可能是第一个注意到被成千上万用户反复使用的系统调用与函数库档案有明显缺陷的人，更有可能的是你完全没有根据。不同凡响的说法需要不同凡响的证据，当你这样声称时，你必须有清楚而详尽的缺陷说明文件作后盾。</p>
<blockquote>
<p>问题：我在安装 Linux（或者 X ）时有问题，你能帮我吗？</p>
</blockquote>
<p>回答：不能，我只有亲自在你的电脑上动手才能找到毛病。还是去找你当地的 Linux 使用群组者寻求实际的指导吧（你能在<a href="http://www.linux.org/groups/index.html" target="_blank" rel="noopener">这儿</a>找到使用者群组的清单）。</p>
<p>注意：如果安装问题与某 Linux 的发行版有关，在它的邮件列表、论坛或本地使用者群组中提问也许是恰当的。此时，应描述问题的准确细节。在此之前，先用 <code>Linux</code> 和<strong>所有</strong>被怀疑的硬件作关键词仔细搜索。</p>
<blockquote>
<p>问题：我怎么才能破解 root 帐号/窃取 OP 特权/读别人的邮件呢？</p>
</blockquote>
<p>回答：想要这样做，说明了你是个卑鄙小人；想找个黑客帮你，说明你是个白痴！</p>
<h2 id="好问题与蠢问题"><a href="#好问题与蠢问题" class="headerlink" title="好问题与蠢问题"></a>好问题与蠢问题</h2><p>最后，我将透过举一些例子，来说明怎样聪明的提问；同一个问题的两种问法被放在一起，一种是愚蠢的，另一种才是明智的。</p>
<p><strong>蠢问题</strong>：</p>
<blockquote>
<p>我可以在哪儿找到关于 Foonly Flurbamatic 的资料？</p>
</blockquote>
<p>这种问法无非想得到 <a href="#RTFM">STFW</a> 这样的回答。</p>
<p><strong>聪明问题</strong>：</p>
<blockquote>
<p>我用 Google 搜索过 “Foonly Flurbamatic 2600”，但是没找到有用的结果。谁知道上哪儿去找对这种设备编程的资料？</p>
</blockquote>
<p>这个问题已经 STFW 过了，看起来他真的遇到了麻烦。</p>
<p><strong>蠢问题</strong>：</p>
<blockquote>
<p>我从 foo 项目找来的源码没法编译。它怎么这么烂？</p>
</blockquote>
<p>他觉得都是别人的错，这个傲慢自大的提问者。</p>
<p><strong>聪明问题</strong>：</p>
<blockquote>
<p>foo 项目代码在 Nulix 6.2 版下无法编译通过。我读过了 FAQ，但里面没有提到跟 Nulix 有关的问题。这是我编译过程的记录，我有什么做的不对的地方吗？</p>
</blockquote>
<p>提问者已经指明了环境，也读过了 FAQ，还列出了错误，并且他没有把问题的责任推到别人头上，他的问题值得被关注。</p>
<p><strong>蠢问题</strong>：</p>
<blockquote>
<p>我的主机板有问题了，谁来帮我？</p>
</blockquote>
<p>某黑客对这类问题的回答通常是：<code>好的，还要帮你拍拍背和换尿布吗？</code>，然后按下删除键。</p>
<p><strong>聪明问题</strong>：</p>
<blockquote>
<p>我在 S2464 主机板上试过了 X 、 Y 和 Z ，但没什么作用，我又试了 A 、 B 和 C 。请注意当我尝试 C 时的奇怪现象。显然 florbish 正在 grommicking，但结果出人意料。通常在 Athlon MP 主机板上引起 grommicking 的原因是什么？有谁知道接下来我该做些什么测试才能找出问题？</p>
</blockquote>
<p>这个家伙，从另一个角度来看，值得去回答他。他表现出了解决问题的能力，而不是坐等天上掉答案。</p>
<p>在最后一个问题中，注意<code>告诉我答案</code>和<code>给我启示，指出我还应该做什么诊断工作</code>之间微妙而又重要的区别。</p>
<p>事实上，后一个问题源自于 2001 年 8 月在 Linux 内核邮件列表（lkml）上的一个真实的提问。我（Eric）就是那个提出问题的人。我在 Tyan S2464 主板上观察到了这种无法解释的锁定现象，列表成员们提供了解决这一问题的重要信息。</p>
<p>通过我的提问方法，我给了别人可以咀嚼玩味的东西；我设法让人们很容易参与并且被吸引进来。我显示了自己具备和他们同等的能力，并邀请他们与我共同探讨。通过告诉他们我所走过的弯路，以避免他们再浪费时间，我也表明了对他们宝贵时间的尊重。</p>
<p>事后，当我向每个人表示感谢，并且赞赏这次良好的讨论经历的时候， 一个 Linux 内核邮件列表的成员表示，他觉得我的问题得到解决并非由于我是这个列表中的<strong>名</strong>人，而是因为我用了正确的方式来提问。</p>
<p>黑客从某种角度来说是拥有丰富知识但缺乏人情味的家伙；我相信他是对的，如果我<strong>像</strong>个乞讨者那样提问，不论我是谁，一定会惹恼某些人或者被他们忽视。他建议我记下这件事，这直接导致了本指南的出现。</p>
<h2 id="如果得不到回答"><a href="#如果得不到回答" class="headerlink" title="如果得不到回答"></a>如果得不到回答</h2><p>如果仍得不到回答，请不要以为我们觉得无法帮助你。有时只是看到你问题的人不知道答案罢了。没有回应不代表你被忽视，虽然不可否认这种差别很难区分。</p>
<p>总的来说，简单的重复张贴问题是个很糟的点子。这将被视为无意义的喧闹。有点耐心，知道你问题答案的人可能生活在不同的时区，可能正在睡觉，也有可能你的问题一开始就没有组织好。</p>
<p>你可以通过其他渠道获得帮助，这些渠道通常更适合初学者的需要。</p>
<p>有许多网上的以及本地的使用者群组，由热情的软件爱好者（即使他们可能从没亲自写过任何软件）组成。通常人们组建这样的团体来互相帮助并帮助新手。</p>
<p>另外，你可以向很多商业公司寻求帮助，不论公司大还是小。别为要付费才能获得帮助而感到沮丧！毕竟，假使你的汽车发动机汽缸密封圈爆掉了 —— 完全可能如此 —— 你还得把它送到修车铺，并且为维修付费。就算软件没花费你一分钱，你也不能强求技术支持总是免费的。</p>
<p>对像是 Linux 这种大众化的软件，每个开发者至少会对应到上万名使用者。根本不可能由一个人来处理来自上万名使用者的求助电话。要知道，即使你要为这些协助付费，和你所购买的同类软件相比，你所付出的也是微不足道的（通常封闭源代码软件的技术支持费用比开源软件的要高得多，且内容也没那么丰富）。</p>
<h2 id="如何更好地回答问题"><a href="#如何更好地回答问题" class="headerlink" title="如何更好地回答问题"></a>如何更好地回答问题</h2><p><strong>态度和善一点</strong>。问题带来的压力常使人显得无礼或愚蠢，其实并不是这样。</p>
<p><strong>对初犯者私下回复</strong>。对那些坦诚犯错之人没有必要当众羞辱，一个真正的新手也许连怎么搜索或在哪找常见问题都不知道。</p>
<p><strong>如果你不确定，一定要说出来</strong>！一个听起来权威的错误回复比没有还要糟，别因为听起来像个专家很好玩，就给别人乱指路。要谦虚和诚实，给提问者与同行都树个好榜样。</p>
<p><strong>如果帮不了忙，也别妨碍他</strong>。不要在实际步骤上开玩笑，那样也许会毁了使用者的设置 —— 有些可怜的呆瓜会把它当成真的指令。</p>
<p><strong>试探性的反问以引出更多的细节</strong>。如果你做得好，提问者可以学到点东西 —— 你也可以。试试将蠢问题转变成好问题，别忘了我们都曾是新手。</p>
<p>尽管对那些懒虫抱怨一声 RTFM 是正当的，能指出文件的位置（即使只是建议个 Google 搜索关键词）会更好。</p>
<p><strong>如果你决定回答，就请给出好的答案</strong>。当别人正在用错误的工具或方法时别建议笨拙的权宜之计（wordaround），应推荐更好的工具，重新界定问题。</p>
<p><strong>正面的回答问题</strong>！如果这个提问者已经很深入的研究而且也表明已经试过 X 、 Y 、 Z 、 A 、 B 、 C 但没得到结果，回答 <code>试试看 A 或是 B</code> 或者 <code>试试 X 、 Y 、 Z 、 A 、 B 、 C</code> 并附上一个链接一点用都没有。</p>
<p><strong>帮助你的社区从问题中学习</strong>。当回复一个好问题时，问问自己<code>如何修改相关文件或常见问题文件以免再次解答同样的问题？</code>，接着再向文件维护者发一份补丁。</p>
<p>如果你是在研究一番后才做出的回答，<strong>展现你的技巧而不是直接端出结果</strong>。毕竟<code>授人以鱼不如授人以渔</code>。</p>
<h2 id="相关资源"><a href="#相关资源" class="headerlink" title="相关资源"></a>相关资源</h2><p>如果你需要个人电脑、Unix 系统和网络如何运作的基础知识，参阅 <a href="http://en.tldp.org/HOWTO/Unix-and-Internet-Fundamentals-HOWTO/" target="_blank" rel="noopener">Unix 系统和网络基本原理</a>。</p>
<p>当你发布软件或补丁时，试着按<a href="http://en.tldp.org/HOWTO/Software-Release-Practice-HOWTO/index.html" target="_blank" rel="noopener">软件发布实践</a>操作。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/05/Preventing-The-Collapsing-Of-Civilization/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yuanchen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yuanchen's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/05/Preventing-The-Collapsing-Of-Civilization/" class="post-title-link" itemprop="url">Preventing The Collapsing Of Civilization</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-01-05 13:26:46 / Modified: 14:31:31" itemprop="dateCreated datePublished" datetime="2020-01-05T13:26:46-05:00">2020-01-05</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><em>在2019年5月17号，莫斯科的 DevGAMM上，Jonathan Blow发表了一个题为『阻止文明倒塌』的长达一小时的奇怪演讲。我把这个演讲总结为下面这篇文字记录。</em></p>
<p><em>善意提醒：不懂编程不代表你我不能阅读一篇和计算机有关的演讲，并有所思考，只能跟风刷刷梗；另外，对于Blow的观点，作为成年人我们应该可以有自己的反思。</em></p>
<p><em>我个人对这个演讲的逻辑非常赞叹，但也认为他明显偏重了软件系统本身的问题，而对另一个甚至更根本的问题选择了视而不见。那就是当代效率提升过程中的真正瓶颈：人的协作。如果仔细观察软件，以及其他可以类比的当代文明复杂系统，大规模的人际协作中无法改进的沟通效率、责任分配、人性的不可管理，都让系统不可避免地显现为笨拙甚至荒谬的面貌。而抽象层级的提高，也绝不仅仅是软件的趋势而已，正如它所带来的问题也绝不仅是机器的问题。</em></p>
<h2 id="阻止文明倒塌"><a href="#阻止文明倒塌" class="headerlink" title="阻止文明倒塌"></a>阻止文明倒塌</h2><p>乔纳森布洛，2019年5月在莫斯科</p>
<p>演讲从1957年苏联发射 Sputnik 上天引发的美苏太空争霸谈起，回顾了首次卫星发射、首次宇航员上天，以及首次登月的过程。在1962年9月肯尼迪总统在一次国会演讲中宣称我们要在这个十年结束之前实现登月。结果1969年阿波罗11号实现了这个目标。Blow 的要点在于：人类（这里指美国）从一无所知，到实现登月只用了12年。然而从那时之后，人类的载人航天事业很大程度上停滞，甚至出现了倒退。这是不是很令人遗憾？</p>
<p>Blow 播放了一段后来解密的阿波罗11号现场纪录片片段，那种震撼的感觉难以名状，只有看的人能了解其中直观的『退步感』。</p>
<p>然后 Blow 播放了一段 Elon Musk 的 TED 访谈，其中 Elon 指出：我们一定要意识到：不同于可持续能源的未来是必然的，Spacefare civilization（多星球文明）绝对不是必然会发生的（它需要巨大的努力）。1969年人类可以登月，然后人类只能用航天飞机把人送到近地轨道。然后航天飞机退役，近地轨道也没法送上去了——连起来看，趋势是向着0倒退。这和人们对于“科技当然显然必然自动地向前进步”这样的信念相违背。</p>
<h2 id="Elon-认为，正好相反，科技在不付出巨大努力的情况下，是逐渐倒退的。"><a href="#Elon-认为，正好相反，科技在不付出巨大努力的情况下，是逐渐倒退的。" class="headerlink" title="Elon 认为，正好相反，科技在不付出巨大努力的情况下，是逐渐倒退的。"></a>Elon 认为，<strong>正好相反，科技在不付出巨大努力的情况下，是逐渐倒退的</strong>。</h2><p>从古埃及的后人忘记金字塔，到古罗马人忘记如何建造罗马水道。</p>
<p>Elon 的火箭创业公司则非常成功，他们的目标是2024年重新实现载人登月。Blow 接下来给出了几个科技倒退的实例：</p>
<p>第一个是 Lycurgus Cup，公元300年。从正面看它的反光是青色的，透光来看，则呈现为红色。原因是其银和金的颗粒体积非常小，小到50-70纳米，如此之小以至于物理放大镜看不见它们，想观测需要用电子显微镜。然后西罗马帝国覆灭，后人忘记了这个工艺</p>
<p>很多人认为这就是扯淡，当时的人并不知道其任何原理只是误打误撞做出了这些东西。Blow 则认为有如此观点的人显然没有用心亲手打磨过任何东西，否则他们一定会明白，达到这样水平的结果，是不可能通过偶然和运气的，对于工艺的掌握必然在不断迭代过程中达到了非常高的水平，它才有任何可能出现。比如这个图案中人的身体的肉红色，肯定是费劲千辛万苦不断改进实现出来的。这就是一种材料科学。</p>
<p>然后 Blow 提到了拜占庭的喷火筒。拜占庭的战船上安装了这种金属喷管，喷出某种成分的“水扑不灭”的有机物燃烧导致的火焰，焚毁敌人船只。这是拜占庭帝国的国家机密，它在帝国灭亡之前就被遗忘，原因不明，具体实现方式已经不可考证。</p>
<p>第三个例子是机械日历，一种安提凯希拉装置（Antikythera Mechanism），1901年于希腊安提凯特拉岛上的一艘古船残骸中被发现的随船沉没2100余年的钟形装置。这个机械日历的实际模型被复原为一段动画（自己看视频，语言无法描述），它的精密程度是高档机械手表的范畴。它的存在意味着背后多么复杂的一整套制造能力呢？</p>
<p>这样的例子还有很多，就不说了，Blow 这时候放了地动仪的图片。要点是：在人类历史上，杰出的科技被完全遗忘，这件事经常发生。当代也一样。</p>
<p>然后 Blow 给出的例子是 Bob Colwell，早期英特尔的首席芯片架构师，在计算机发展初期的时候接受采访的片段内容，背景是他们发现合作的零部件制造商TI（德州仪器公司）送来的产品不能稳定使用，质量残次。</p>
<p>Bob 去找 TI 质询，本来以为对方会说“那是你们不知道怎么使用，我们的产品是好的”，实际对方的答复是：“是，我们知道，我看看你的清单。哦，我们还有更多你们不知道的（不好使的产品）。”实际情况是，TI 没有比任何其他竞争对手更差，摩托罗拉、Fairchild 也一样。这些硅制品让英特尔的芯片研发停滞不前，为何会如此？TI的人回答道：“第一代 TTL（逻辑门电路）是那帮胡子花白的老头子做的，他们知道其中的道理；现在的工程师都是毛头小子，学校毕业过来搞生产，他们不知道内部组装的改变，会导致感应峰（inductive spikes）。”这里的spike就是指每一个点的电压变化时，都会产生磁场，而磁场变化的相互干扰，没有被设计者纳入考虑，因为他们不理解。</p>
<p>这就是科技退步的原因。代际之间的交流和传承需要巨大的努力，这过程中有损失。如果代际的传承失败，文明就灭亡。</p>
<p>接下来 Blow 给出了历史中文明灭亡的实例，来自于 Eric Clive 的一个演讲，题目是《公元前1700年的文明灭亡》，具体来说是青铜器时代晚期，爱琴海，古埃及，塞浦路斯，迈锡尼，赫梯，古巴比伦等。这一圈围绕在美索不达米亚平原和地中海一带的文明曾经形成了一个非常复杂的贸易网络。在下图中，每个节点是一个文明，不是每一个都能和每一个贸易，但通过中间节点，所有贸易都达到非常优化的效率。</p>
<p>这一点非常重要，因为青铜作为国防和生产的重要资料，非常难以制造。你需要用锡和铜一起生产。铜产地比较少，比如塞浦路斯岛。而锡则更难找，而且离铜产地非常远，比如阿富汗。而这些文明需要把它们运到一起以生产青铜。</p>
<p>而这些文明的灭亡至今没有确切原因，有人说是自然环境恶化导致互相攻击，贸易变成战争。它们灭亡到什么程度呢，不仅是国家不存在了，城市也消失了，语言和文化也消失了。刻在石碑上的文字大多数至今我们不能翻译。</p>
<p>Blow 的要点是：软件正在倒退，而人类空前依赖软件。尽管，这和我们置身其中的人的观感是相反的。波音飞机掉下来的主要原因就是软件问题（编者不能同意）。文明衰退的速度如果很慢，我们能意识到这个衰退么？</p>
<p>这里 Blow 给出了他对于“软件明显在蓬勃发展”之直观感受的解释：软件正在享受硬件能力提升的红利，它只是“看上去”蓬勃发展而已。</p>
<p>机器学习是最明显的例子。一方面，它在二十年前不能存在主要是因为硬件性能无法支持而已。另一方面，它只是人类依赖着的软件世界中极小极小的部分。属于软件的进步已经很长时间停滞。比如，我们使用软件给自己AI换脸成明星的样子，或者配上猪耳朵，这个有趣的部分，只占这个app极小极小的部分，而这个部分非常简单，另外的极大部分却极度复杂，包括把你的脸加载到屏幕上，以及处理你的点击，等等。出问题的是这些部分。人工智能的局部成就，没法和软件世界整体的退化的巨大惯性抗衡。</p>
<p>最明显的迹象，就是“我们已经不指望软件能长期稳定工作了。”我们的标准一降再降，还能降到多低？降低到哪里会出大问题？</p>
<p>接下来 Blow 疯狂吐槽了十分钟，关于电脑上一切软件都经常 bug，以至于用户对于一切软件“重启试试”成为不假思索的操作。包括 Emacs 的问题、Visual Studio 不能处理最最简单的指令，只能连续报错，微软 Word 的字符换行 bug 二十年后仍然没有消灭，像幽灵一样此起彼伏；于是他为了缓解自己的愤怒想打游戏，打开 Epic Store 和 Steam 又连续遇到 bug；于是他关掉游戏客户端去看 CS 直播，发现 CS 直播电竞比赛里全程有一个多余的名为“未定义”的 bug 玩家出现在地图里，直到比赛结束；然后他进入俄罗斯签证申请页面，被死活不能通过，且不能刷新的手机号验证脚本逼得只能刷新整个页面重新填写申请；然后他来到莫斯科住进酒店，他的房间的座机有5%的概率会空调开关触发响铃……等等。编者这里就不赘述了。</p>
<p>这让90年代电脑销售的一个常见推销语“五个9”（指，本设备可以99.999%时间稳定运行）成为今日的讽刺。Blow的电脑连两个9都没有。</p>
<p>对于这个问题，软件行业的普遍答案是：市场不会为更好的稳定性买单。Blow则认为：对于一个从未提供出足够稳健的产品的行业，为什么会有人会相信它『能』？</p>
<p>接下来，Blow 从正面描述了软件的结构：抽象层次的序列。机器语言、汇编语言、Fortran/C/C++、C#/Haskell/Javascript……在这个序列里，绝大多数工程师在最高抽象层次进行工作，因为这是“聪明、省力、高效率的”。在这个抽象从低到高的序列里的某些位置，问题就出在这里。Blow 认为，全行业的高抽象层次工作，多数人的“高效率”的另一面，是失去（或者从未拥有过）能力。考虑 Facebook 作为一个软件的功能增加，和它要多雇佣的成千上万的工程师，二者相除得到的平均每人的价值创造是趋近于零的。这和“抽象层次越高效率越高”明显矛盾。</p>
<p>Blow 给出的对比，是 UNIX 发明者 Ken Thompson 的一个演讲片段。他回忆道他趁老婆孩子出去度假，用了三个礼拜写了三个东西（编辑器、编译器、软硬件交互层或者叫操作系统），做出了 UNIX。现场爆发笑声和掌声——当今程序员可没有这种效率。而 Blow 认为这是个悲剧，它并不好笑。今天软件显没有在进步，它的鲁棒性和生产力都在衰退。</p>
<p>Blow 从图形计算的角度给出了一些“最最基本的，你不能直接做的事情”，其中一个编者能听懂的例子是，把一个程序拷贝到另一个设备（安装是个复杂过程）——而这并不是因为 CPU，CPU 不能背锅因为今天各类设备的 CPU 一致性已经相当好。安装程序不是为了对接 CPU，而是为了解决操作系统层面不可思议之多的兼容问题，其绝大部分是我们不想打交道的。操作系统本来是给 CPU 赋予能力，但同时你也可以说它防止着 CPU 具备很多能力。在编程过程中，你绝大多数时间在处理那些，你很难理解、也不可能预料到的各种和你的设计思路没有关系的问题。</p>
<p>更可怕的是，你不能直接编写一个独立程序进行编译和 linking。微软为了能让人这么做，专门设计了一个 vswhere 的软件。</p>
<p>现在有一种叫做LSP的东西，开源的语言服务器协定。在Blow看来它基本上是一种更复杂、更费劲的编写和调用库的方式，而其满足的需求都是非常基本的操作，比如在你的编辑器里临时起意，查看一个变量的特征或者类型，LSP给你提供一个工具条，或者鼠标点击直接查询的功能。为了实现这个，你需要一个标准化服务跑在服务器上，好让你的编辑器和服务器用socket交互——为了使用方便，你把本地的、单一的编程工作置于分布式的系统之中。</p>
<p>这样的做法推而广之，你依赖了越来越多的库，库又依赖了越来越多的库，关键是这些库/服务本身可能是在变化的、并且没有被中心化地存储和管理，这样一来我们就陷入了无穷无尽的debug的、重启服务的、互相同步的……我们自身所不能掌握的问题海洋之中。</p>
<p>现在大家竟然在积极主动建设着这样一个东西。程序员们忙着把简单事情复杂化的同时……</p>
<p>电脑游戏却变得连最基本的事情都很难实现了。比如游戏现在很难保持全屏, 经常跳出为窗口。再比如，辛辛苦苦做的游戏，很难稳定在一个帧数上跑，无论你多努力也不行。Allen（全称听不清楚）在GDC上介绍了他的一篇论文讲述了这个简单的能力我们现在无法具备的原因。</p>
<p>复杂性的提高，加速了知识的丢失：</p>
<h2 id="1、知识总量更多，我们就让每个人知道的比例变得更小来应对。"><a href="#1、知识总量更多，我们就让每个人知道的比例变得更小来应对。" class="headerlink" title="1、知识总量更多，我们就让每个人知道的比例变得更小来应对。"></a>1、知识总量更多，我们就让每个人知道的比例变得更小来应对。</h2><p>每个人对全局的把握一弱再弱，既难以传承知识，也难以做好自己的工作。</p>
<h2 id="2、『深知识』被『琐碎信息』替代。"><a href="#2、『深知识』被『琐碎信息』替代。" class="headerlink" title="2、『深知识』被『琐碎信息』替代。"></a>2、『深知识』被『琐碎信息』替代。</h2><p>典型的深知识，如理解Cache Coherency（缓存一致性，指保留在高速缓存中的共享资源，保持数据一致性的机制），可以让人优化程序在多个处理器上跑得更快。典型的琐碎信息，如『这个Unity里的小图标不知道为啥不显示了，请教老师傅得知，是某个深藏不露的菜单里看似没有关联的一个开关关闭了导致的，打开就好了，过了一阵子它不知道为何又关闭了，总之，编译之前一定要记得检查那开关打开没有』。后者作为知识，往往几个月后随着Unity版本更新就完全作废，作为程序员要花很多脑力学习这种速朽的所谓知识，这件事情非常缺（offensive）。</p>
<h2 id="3、好信息被噪音淹没。"><a href="#3、好信息被噪音淹没。" class="headerlink" title="3、好信息被噪音淹没。"></a>3、好信息被噪音淹没。</h2><p>症状是谷歌越来越难用，你的问题越复杂，网上搜来搜去看到的答案就越大概率是错的，或者只是浪费你的时间。</p>
<p>Blow认为，显而易见的是，复杂性越高，我们承受灾难，或者体制性腐化（参考上文东罗马帝国），的能力就越差。而现在大家似乎相信，我们能承担的复杂性上限，是无限的。想象现在大公司里那种极少数能够透彻理解整个系统的工程师离退休之后后继无人、且很难把整套知识传递给年轻员工的情况，答案已经很明显了。</p>
<h2 id="这一切和游戏有什么关系呢？"><a href="#这一切和游戏有什么关系呢？" class="headerlink" title="这一切和游戏有什么关系呢？"></a>这一切和游戏有什么关系呢？</h2><p>曾经的游戏，是关于如何榨干性能，将机器的潜力推至极限的。推至极限，要求我们透彻理解机器本身，这就自然导致我们倾向于做出非常鲁棒的程序。</p>
<p>今天整个行业转向Unity和Unreal。自己写引擎的人越来越少。一整代程序员从学习到工作，一直在写支离破碎的C#片段，放在Unity的这里那里，从来没写过系统性的，或者底层的程序。这本身倒没什么，它缩短开发时间，提高个人效率，缩短游戏开发时间。但这意味着放弃，对其他能力的放弃，对整体性知识的放弃。</p>
<p>Blow说，割裂性的分工没问题，但是如果所有人都这样分工，那么没有任何人会做这之外的事情了。Unity和Unreal又是怎么来的呢？它们生长于这样一个环境：所有的游戏公司都在自己写引擎，专门的引擎公司就从这些游戏公司里雇人过来，做出了如今的垄断性引擎。现在没有这样的环境，彻底没有那种人了的话，Unity去哪里雇人？首先的结果，是他们彻底断绝了新引擎作为竞争对手的涌现可能。然后，这几个大引擎怎么继续维护和发展，也成了问题，自身开始衰退，也是很有可能的。</p>
<p>游戏开发者社群的情况很像阿西莫夫的《基地》：我们有一群人知道怎么用电脑编程、也有一群人精通嵌入式系统/高性能计算这些事。当很多程序败坏、丢失、难以维护的时候，我们这群人的知识可以重建它们——但我（Blow）真的不确定，我们是否有足够多的底层人才，以及对底层充分了解的高层人才，能做好系统底层的工作。也许，我们需要一个新的『基地』（foundation，也有基础的意思）。不好意思，剧透了。</p>
<p>说回到青铜时代的文明失落，无数历史显示了一种现象：当只有精英阶层可以读和写的时候，很多能力无法普及，文明变得脆弱——普通人也主观上不想学习那些。今天的我们，几乎没有人能理解自己的程序跑着的时候，CPU里正在发生什么。这就是脆弱。</p>
<p>如果青铜器时代那个程度的知识都会失落，那面对我们现在如此复杂的系统，我们怎么能相信它的存续和发展？各种各样的生存压力随时可能爆发，考验我们的软件世界。比如气候变迁。比如国际争端，比如一些国家切断国际互联网了，比如中国不给我们加工芯片了。别笑，现在有些国家的程序员连上stackoverflow复制粘贴代码都费劲。这些事情单独来看肯定都不至于伤害我们的文明，系统复杂到今天程度，抗折腾能力会很差。</p>
<p>正如Elon Musk所言，技术会自然地退步。我们要警惕，要对抗，就一定要在每一个层级上简化：硬件、操作系统、库、应用层面的代码、网络、编译、debug、内容分发、人机交互。而这一切又完全可以如此简单，因为它们的现状如此荒谬！</p>
<h2 id="我们需要的只是『意愿』（will）和『品位』（taste）而已！"><a href="#我们需要的只是『意愿』（will）和『品位』（taste）而已！" class="headerlink" title="我们需要的只是『意愿』（will）和『品位』（taste）而已！"></a>我们需要的只是『意愿』（will）和『品位』（taste）而已！</h2><p>大家都充分认识到复杂之荒谬，简单之美——简化可以让事情变得更好。</p>
<p>退一万步讲，也许你认为软件不会让文明倒塌。没关系，咱们就只从自身利益出发——所有程序员都每天气呼呼的工作着，因为他们知道自己大量的时间精力用在没有意义的荒唐事上，而不是真正有趣的，创造性的事上。如果我们不改变做事的方式，未来的程序员工作会更加庸俗不堪，就跟没有SpaceX时候的美国航天事业一样。</p>
<p>再退一步，假设你只是独立游戏开发者，你可能觉得，自己无力改变任何事情，只要忍几个月，把游戏做完就好了，毕竟重构、重写需要大量的时间——我想告诉你这种想法永远是错误的，因为我们永远低估了自己做游戏需要的时间，你以为的五个月，大概率实际是几年。糟糕的工作方式让你付出的代价，比你以为的，要大得多，长得多。也许那拖延的几年时间，就是拜复杂系统所赐。反过来，如果你积极应战，简化架构和代码，兴许很值得。听起来像是又基础又无聊的建议，但我要大胆断言——我们大多数人甚至都不太知道怎么做这件事了。</p>
<p>最后Blow给大家提供了三个补充阅读/观看的资料，</p>
<ul>
<li><p>Casey Muratori，『三千万行代码难题』。<a href="https://www.bilibili.com/video/av53844104" target="_blank" rel="noopener">链接在此</a></p>
</li>
<li><p>Samo Burja，『文明：体制、知识与未来』。<a href="https://www.bilibili.com/video/av54613661" target="_blank" rel="noopener">链接在此</a></p>
</li>
<li><p>Eric Cline，『公元前1177：文明倒塌时』<a href="https://www.bilibili.com/video/av54613930" target="_blank" rel="noopener">链接在此</a></p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/04/Dynamic-Programming/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yuanchen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yuanchen's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/04/Dynamic-Programming/" class="post-title-link" itemprop="url">Dynamic Programming</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-01-04 14:26:20 / Modified: 15:28:39" itemprop="dateCreated datePublished" datetime="2020-01-04T14:26:20-05:00">2020-01-04</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="动态规划"><a href="#动态规划" class="headerlink" title="动态规划"></a>动态规划</h2><p>建议观看 MIT <a href="http://open.163.com/movie/2010/12/L/4/M6UTT5U0I_M6V2U1HL4.html" target="_blank" rel="noopener">算法导论-动态规划</a>中的课程。</p>
<p>适用于动态规划的问题，需要满足<strong>最优子结构</strong>和<strong>无后效性</strong>，动态规划的求解过程，在于找到<strong>状态转移方程</strong>，进行<strong>自底向上</strong>的求解。</p>
<h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h4 id="爬楼梯问题-LeetCode-70"><a href="#爬楼梯问题-LeetCode-70" class="headerlink" title="爬楼梯问题 LeetCode 70"></a>爬楼梯问题 <a href="https://leetcode.com/problems/climbing-stairs/" target="_blank" rel="noopener">LeetCode 70</a></h4><p>经典的动态规划问题之一，容易找到其状态转移方程为 <code>dp[i] = dp[i-1] + dp[i-2]</code>，从基础的 1 和 2 个台阶两个状态开始，自底向上求解：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">climbStairs</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span>* dp = <span class="keyword">new</span> <span class="keyword">int</span>[n+<span class="number">1</span>]();</span><br><span class="line">    dp[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    dp[<span class="number">2</span>] = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        dp[i] = dp[i<span class="number">-1</span>] + dp[i<span class="number">-2</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> dp[n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从上面的代码中看到，<code>dp[i]</code> 只依赖 <code>dp[i-1]</code> 和 <code>dp[i-2]</code>，因此可以将代码简化：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">climbStairs</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> f0 = <span class="number">1</span>, f1 = <span class="number">1</span>, i, f2;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">2</span>; i&lt;=n; i++) &#123;</span><br><span class="line">        f2 = f0 + f1;</span><br><span class="line">        f0 = f1;</span><br><span class="line">        f1 = f2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>容易看出其实结果就是 fibonacci 数列的第 n 项。</p>
<h4 id="连续子数组的最大和-LeetCode-53"><a href="#连续子数组的最大和-LeetCode-53" class="headerlink" title="连续子数组的最大和 LeetCode 53"></a>连续子数组的最大和 <a href="https://leetcode.com/problems/maximum-subarray/" target="_blank" rel="noopener">LeetCode 53</a></h4><p>用 <code>dp[n</code>] 表示元素 n 作为末尾的连续序列的最大和，容易想到状态转移方程为<code>dp[n] = max(dp[n-1] + num[n], num[n])</code>，从第 1 个元素开始，自顶向上求解：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxSubArray</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>* dp = <span class="keyword">new</span> <span class="keyword">int</span>[nums.size()]();</span><br><span class="line"></span><br><span class="line">    dp[<span class="number">0</span>] = nums[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">int</span> result = dp[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.size(); i++) &#123;</span><br><span class="line">        dp[i] = max(dp[i<span class="number">-1</span>] + nums[i], nums[i]);</span><br><span class="line">        result = max(result, dp[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>类似前一个问题，这个问题当中，求解 <code>dp[i]</code> 只依赖 <code>dp[i-1]</code>，因此可以使用变量来存储，简化代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxSubArray</span><span class="params">(<span class="keyword">int</span> A[], <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> result = INT_MIN;</span><br><span class="line">    <span class="keyword">int</span> f = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        f = max(f + A[i], A[i]);</span><br><span class="line">        result = max(result, f);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="House-Robber-LeetCode-198"><a href="#House-Robber-LeetCode-198" class="headerlink" title="House Robber LeetCode 198"></a>House Robber <a href="https://leetcode.com/problems/house-robber/" target="_blank" rel="noopener">LeetCode 198</a></h4><p>对于一个房子，有抢和不抢两种选择，容易得到状态转移方程 <code>dp[i+1] = max(dp[i-1] + nums[i], dp[i])</code>，示例代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">rob</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = nums.size();</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; dp = <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    dp[<span class="number">1</span>] = nums[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = nums[i];</span><br><span class="line">        dp[i+<span class="number">1</span>] = max(dp[i<span class="number">-1</span>] + v, dp[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> dp[n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同样的，可以使用两个变量简化代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">rob</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = nums.size();</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> prev1 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> prev2 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = nums[i];</span><br><span class="line">        <span class="keyword">int</span> temp = prev1;</span><br><span class="line">        prev1 = max(prev2 + v, prev1);</span><br><span class="line">        prev2 = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> prev1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="最长回文子串-LeetCode-5"><a href="#最长回文子串-LeetCode-5" class="headerlink" title="最长回文子串 LeetCode 5"></a>最长回文子串 <a href="https://leetcode.com/problems/longest-palindromic-substring/" target="_blank" rel="noopener">LeetCode 5</a></h4><p>用 <code>dp[i][j]</code> 表示子串 i 到 j 是否是回文，使用动态规划求解：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">longestPalindrome</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> m = s.size();</span><br><span class="line">	<span class="keyword">if</span> (m == <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">dp</span><span class="params">(m, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(m, <span class="number">0</span>))</span></span>;</span><br><span class="line">	<span class="keyword">int</span> start = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> length = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="comment">// 单个字符属于回文，例如 abcd</span></span><br><span class="line">		dp[i][i] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 连续两个字符相同属于回文，例如 abb</span></span><br><span class="line">		<span class="keyword">if</span> (i &lt; m - <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (s[i] == s[i + <span class="number">1</span>]) &#123;</span><br><span class="line">				dp[i][i + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">                start = i;</span><br><span class="line">				length = <span class="number">2</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">2</span>; len &lt;= m; len++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m - len; i++) &#123;</span><br><span class="line">			<span class="keyword">int</span> j = i + len;</span><br><span class="line">            <span class="comment">// 扩展长度</span></span><br><span class="line">			<span class="keyword">if</span> (dp[i + <span class="number">1</span>][j - <span class="number">1</span>] == <span class="number">1</span> &amp;&amp; s[i] == s[j]) &#123;</span><br><span class="line">				dp[i][j] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (j - i + <span class="number">1</span> &gt; length) &#123;</span><br><span class="line">                    start = i;</span><br><span class="line">					length = j - i + <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> s.substr(start, length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="最小编辑距离-LeetCode-72"><a href="#最小编辑距离-LeetCode-72" class="headerlink" title="最小编辑距离 LeetCode 72"></a>最小编辑距离 <a href="https://leetcode.com/problems/edit-distance/" target="_blank" rel="noopener">LeetCode 72</a></h4><p>用 <code>dp[i][j]</code> 表示从 <code>word[0..i)</code> 转换到 <code>word[0..j)</code> 的最小操作，使用动态规划求解：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">minDistance</span><span class="params">(<span class="built_in">string</span> word1, <span class="built_in">string</span> word2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m = word1.size();</span><br><span class="line">    <span class="keyword">int</span> n = word2.size();</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">dp</span><span class="params">(m + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n + <span class="number">1</span>, <span class="number">0</span>))</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 全部删除，操作数量为 i</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        dp[i][<span class="number">0</span>] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; j++) &#123;</span><br><span class="line">        dp[<span class="number">0</span>][j] = j;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            <span class="comment">// 末尾字符相同，不需要编辑</span></span><br><span class="line">            <span class="keyword">if</span> (word1[i - <span class="number">1</span>] == word2[j - <span class="number">1</span>]) &#123;</span><br><span class="line">                dp[i][j] = dp[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 末尾字符不同，三种编辑情况，取最小值</span></span><br><span class="line">                dp[i][j] = min(dp[i - <span class="number">1</span>][j - <span class="number">1</span>], min(dp[i][j - <span class="number">1</span>], dp[i - <span class="number">1</span>][j])) + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> dp[m][n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/03/Network/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yuanchen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yuanchen's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/03/Network/" class="post-title-link" itemprop="url">Computer Network Basics</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-01-03 14:03:24 / Modified: 15:12:44" itemprop="dateCreated datePublished" datetime="2020-01-03T14:03:24-05:00">2020-01-03</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h1><h2 id="HTTP-的特性"><a href="#HTTP-的特性" class="headerlink" title="HTTP 的特性"></a>HTTP 的特性</h2><ul>
<li>HTTP 协议构建于 TCP/IP 协议之上，是一个应用层协议，默认端口号是 80</li>
<li>HTTP 是<strong>无连接无状态</strong>的</li>
</ul>
<h2 id="HTTP-报文"><a href="#HTTP-报文" class="headerlink" title="HTTP 报文"></a>HTTP 报文</h2><h3 id="请求报文"><a href="#请求报文" class="headerlink" title="请求报文"></a>请求报文</h3><p>HTTP 协议是以 ASCII 码传输，建立在 TCP/IP 协议之上的应用层规范。规范把 HTTP 请求分为三个部分：状态行、请求头、消息主体。类似于下面这样：</p>
<pre><code>&lt;method&gt; &lt;request-URL&gt; &lt;version&gt;
&lt;headers&gt;

&lt;entity-body&gt;</code></pre><p>HTTP 定义了与服务器交互的不同方法，最基本的方法有4种，分别是<code>GET</code>，<code>POST</code>，<code>PUT</code>，<code>DELETE</code>。<code>URL</code>全称是资源描述符，我们可以这样认为：一个<code>URL</code>地址，它用于描述一个网络上的资源，而 HTTP 中的<code>GET</code>，<code>POST</code>，<code>PUT</code>，<code>DELETE</code>就对应着对这个资源的查，增，改，删4个操作。</p>
<ol>
<li><p>GET 用于信息获取，而且应该是安全的 和 幂等的。</p>
<p>所谓安全的意味着该操作用于获取信息而非修改信息。换句话说，GET 请求一般不应产生副作用。就是说，它仅仅是获取资源信息，就像数据库查询一样，不会修改，增加数据，不会影响资源的状态。</p>
<p>幂等的意味着对同一 URL 的多个请求应该返回同样的结果。</p>
<p>GET 请求报文示例：</p>
<pre><code>GET /books/?sex=man&amp;name=Professional HTTP/1.1
Host: www.example.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6)
Gecko/20050225 Firefox/1.0.1
Connection: Keep-Alive</code></pre></li>
<li><p>POST 表示可能修改变服务器上的资源的请求。</p>
</li>
</ol>
<pre><code>POST / HTTP/1.1
Host: www.example.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6)
Gecko/20050225 Firefox/1.0.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 40
Connection: Keep-Alive

sex=man&amp;name=Professional  </code></pre><ol start="3">
<li><p>注意:</p>
<ul>
<li>GET 可提交的数据量受到URL长度的限制，HTTP 协议规范没有对 URL 长度进行限制。这个限制是特定的浏览器及服务器对它的限制</li>
<li>理论上讲，POST 是没有大小限制的，HTTP 协议规范也没有进行大小限制，出于安全考虑，服务器软件在实现时会做一定限制</li>
<li>参考上面的报文示例，可以发现 GET 和 POST 数据内容是一模一样的，只是位置不同，一个在 URL 里，一个在 HTTP 包的包体里</li>
</ul>
</li>
</ol>
<h3 id="POST-提交数据的方式"><a href="#POST-提交数据的方式" class="headerlink" title="POST 提交数据的方式"></a>POST 提交数据的方式</h3><p>HTTP 协议中规定 POST 提交的数据必须在 body 部分中，但是协议中没有规定数据使用哪种编码方式或者数据格式。实际上，开发者完全可以自己决定消息主体的格式，只要最后发送的 HTTP 请求满足上面的格式就可以。</p>
<p>但是，数据发送出去，还要服务端解析成功才有意义。一般服务端语言如 PHP、Python 等，以及它们的 framework，都内置了自动解析常见数据格式的功能。服务端通常是根据请求头（headers）中的 Content-Type 字段来获知请求中的消息主体是用何种方式编码，再对主体进行解析。所以说到 POST 提交数据方案，包含了 Content-Type 和消息主体编码方式两部分。下面就正式开始介绍它们：</p>
<ul>
<li><code>application/x-www-form-urlencoded</code></li>
</ul>
<p>这是最常见的 POST 数据提交方式。浏览器的原生 <code>&lt;form&gt;</code> 表单，如果不设置 enctype 属性，那么最终就会以 <code>application/x-www-form-urlencoded</code> 方式提交数据。上个小节当中的例子便是使用了这种提交方式。可以看到 body 当中的内容和 GET 请求是完全相同的。</p>
<ul>
<li><code>multipart/form-data</code></li>
</ul>
<p>这又是一个常见的 POST 数据提交的方式。我们使用表单上传文件时，必须让 <code>&lt;form&gt;</code> 表单的 enctype 等于 <code>multipart/form-data</code>。直接来看一个请求示例：</p>
<pre><code>POST http://www.example.com HTTP/1.1
Content-Type:multipart/form-data; boundary=----WebKitFormBoundaryrGKCBY7qhFd3TrwA

------WebKitFormBoundaryrGKCBY7qhFd3TrwA
Content-Disposition: form-data; name=&quot;text&quot;

title
------WebKitFormBoundaryrGKCBY7qhFd3TrwA
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;chrome.png&quot;
Content-Type: image/png

PNG ... content of chrome.png ...
------WebKitFormBoundaryrGKCBY7qhFd3TrwA--</code></pre><p>这个例子稍微复杂点。首先生成了一个 boundary 用于分割不同的字段，为了避免与正文内容重复，boundary 很长很复杂。然后 <code>Content-Type</code> 里指明了数据是以 <code>multipart/form-data</code> 来编码，本次请求的 boundary 是什么内容。消息主体里按照字段个数又分为多个结构类似的部分，每部分都是以 –boundary 开始，紧接着是内容描述信息，然后是回车，最后是字段具体内容（文本或二进制）。如果传输的是文件，还要包含文件名和文件类型信息。消息主体最后以 –boundary– 标示结束。关于 <code>multipart/form-data</code> 的详细定义，请前往 <a href="http://www.ietf.org/rfc/rfc1867.txt" target="_blank" rel="noopener">RFC1867</a> 查看（或者相对友好一点的 <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition" target="_blank" rel="noopener">MDN 文档</a>）。</p>
<p>这种方式一般用来上传文件，各大服务端语言对它也有着良好的支持。</p>
<p>上面提到的这两种 POST 数据的方式，都是浏览器原生支持的，而且现阶段标准中原生 <code>&lt;form&gt;</code> 表单也只支持这两种方式（通过 <code>&lt;form&gt;</code> 元素的 enctype 属性指定，默认为 <code>application/x-www-form-urlencoded</code>。其实 enctype 还支持 text/plain，不过用得非常少）。</p>
<p>随着越来越多的 Web 站点，尤其是 WebApp，全部使用 Ajax 进行数据交互之后，我们完全可以定义新的数据提交方式，例如 <code>application/json</code>，<code>text/xml</code>，乃至 <code>application/x-protobuf</code> 这种二进制格式，只要服务器可以根据 <code>Content-Type</code> 和 <code>Content-Encoding</code> 正确地解析出请求，都是没有问题的。</p>
<h3 id="响应报文"><a href="#响应报文" class="headerlink" title="响应报文"></a>响应报文</h3><p>HTTP 响应与 HTTP 请求相似，HTTP响应也由3个部分构成，分别是：</p>
<ul>
<li>状态行</li>
<li>响应头(Response Header)</li>
<li>响应正文</li>
</ul>
<p>状态行由协议版本、数字形式的状态代码、及相应的状态描述，各元素之间以空格分隔。</p>
<p>常见的状态码有如下几种：</p>
<ul>
<li><code>200 OK</code> 客户端请求成功</li>
<li><code>301 Moved Permanently</code> 请求永久重定向</li>
<li><code>302 Moved Temporarily</code> 请求临时重定向</li>
<li><code>304 Not Modified</code> 文件未修改，可以直接使用缓存的文件。</li>
<li><code>400 Bad Request</code> 由于客户端请求有语法错误，不能被服务器所理解。</li>
<li><code>401 Unauthorized</code> 请求未经授权。这个状态代码必须和WWW-Authenticate报头域一起使用</li>
<li><code>403 Forbidden</code> 服务器收到请求，但是拒绝提供服务。服务器通常会在响应正文中给出不提供服务的原因</li>
<li><code>404 Not Found</code> 请求的资源不存在，例如，输入了错误的URL</li>
<li><code>500 Internal Server Error</code> 服务器发生不可预期的错误，导致无法完成客户端的请求。</li>
<li><code>503 Service Unavailable</code> 服务器当前不能够处理客户端的请求，在一段时间之后，服务器可能会恢复正常。</li>
</ul>
<p>下面是一个HTTP响应的例子：</p>
<pre><code>HTTP/1.1 200 OK

Server:Apache Tomcat/5.0.12
Date:Mon,6Oct2003 13:23:42 GMT
Content-Length:112

&lt;html&gt;...</code></pre><h3 id="条件-GET"><a href="#条件-GET" class="headerlink" title="条件 GET"></a>条件 GET</h3><p>HTTP 条件 GET 是 HTTP 协议为了减少不必要的带宽浪费，提出的一种方案。详见 <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html" target="_blank" rel="noopener">RFC2616</a> 。</p>
<ol>
<li><p>HTTP 条件 GET 使用的时机？</p>
<p>客户端之前已经访问过某网站，并打算再次访问该网站。</p>
</li>
<li><p>HTTP 条件 GET 使用的方法？</p>
<p>客户端向服务器发送一个包询问是否在上一次访问网站的时间后是否更改了页面，如果服务器没有更新，显然不需要把整个网页传给客户端，客户端只要使用本地缓存即可，如果服务器对照客户端给出的时间已经更新了客户端请求的网页，则发送这个更新了的网页给用户。</p>
<p>下面是一个具体的发送接受报文示例：</p>
<p>客户端发送请求：</p>
<pre><code>GET / HTTP/1.1  
Host: www.sina.com.cn:80  
If-Modified-Since:Thu, 4 Feb 2010 20:39:13 GMT  
Connection: Close  </code></pre><p>第一次请求时，服务器端返回请求数据，之后的请求，服务器根据请求中的 <code>If-Modified-Since</code> 字段判断响应文件没有更新，如果没有更新，服务器返回一个 <code>304 Not Modified</code>响应，告诉浏览器请求的资源在浏览器上没有更新，可以使用已缓存的上次获取的文件。</p>
<pre><code>HTTP/1.0 304 Not Modified  
Date: Thu, 04 Feb 2010 12:38:41 GMT  
Content-Type: text/html  
Expires: Thu, 04 Feb 2010 12:39:41 GMT  
Last-Modified: Thu, 04 Feb 2010 12:29:04 GMT  
Age: 28  
X-Cache: HIT from sy32-21.sina.com.cn  
Connection: close </code></pre><p>如果服务器端资源已经更新的话，就返回正常的响应。</p>
</li>
</ol>
<h2 id="持久连接"><a href="#持久连接" class="headerlink" title="持久连接"></a>持久连接</h2><p>我们知道 HTTP 协议采用“请求-应答”模式，当使用普通模式，即非 Keep-Alive 模式时，每个请求/应答客户和服务器都要新建一个连接，完成之后立即断开连接（HTTP 协议为无连接的协议）；当使用 Keep-Alive 模式（又称持久连接、连接重用）时，Keep-Alive 功能使客户端到服务器端的连接持续有效，当出现对服务器的后继请求时，Keep-Alive 功能避免了建立或者重新建立连接。</p>
<p>在 HTTP 1.0 版本中，并没有官方的标准来规定 Keep-Alive 如何工作，因此实际上它是被附加到 HTTP 1.0协议上，如果客户端浏览器支持 Keep-Alive ，那么就在HTTP请求头中添加一个字段 Connection: Keep-Alive，当服务器收到附带有 Connection: Keep-Alive 的请求时，它也会在响应头中添加一个同样的字段来使用 Keep-Alive 。这样一来，客户端和服务器之间的HTTP连接就会被保持，不会断开（超过 Keep-Alive 规定的时间，意外断电等情况除外），当客户端发送另外一个请求时，就使用这条已经建立的连接。</p>
<p>在 HTTP 1.1 版本中，默认情况下所有连接都被保持，如果加入 “Connection: close” 才关闭。目前大部分浏览器都使用 HTTP 1.1 协议，也就是说默认都会发起 Keep-Alive 的连接请求了，所以是否能完成一个完整的 Keep-Alive 连接就看服务器设置情况。</p>
<p>由于 HTTP 1.0 没有官方的 Keep-Alive 规范，并且也已经基本被淘汰，以下讨论均是针对 HTTP 1.1 标准中的 Keep-Alive 展开的。</p>
<p>注意：</p>
<ul>
<li><p>HTTP Keep-Alive 简单说就是保持当前的TCP连接，避免了重新建立连接。</p>
</li>
<li><p>HTTP 长连接不可能一直保持，例如 <code>Keep-Alive: timeout=5, max=100</code>，表示这个TCP通道可以保持5秒，max=100，表示这个长连接最多接收100次请求就断开。</p>
</li>
<li><p>HTTP 是一个无状态协议，这意味着每个请求都是独立的，Keep-Alive 没能改变这个结果。另外，Keep-Alive也不能保证客户端和服务器之间的连接一定是活跃的，在 HTTP1.1 版本中也如此。唯一能保证的就是当连接被关闭时你能得到一个通知，所以不应该让程序依赖于 Keep-Alive 的保持连接特性，否则会有意想不到的后果。</p>
</li>
<li><p>使用长连接之后，客户端、服务端怎么知道本次传输结束呢？两部分：1. 判断传输数据是否达到了Content-Length 指示的大小；2. 动态生成的文件没有 Content-Length ，它是分块传输（chunked），这时候就要根据 chunked 编码来判断，chunked 编码的数据在最后有一个空 chunked 块，表明本次传输数据结束，详见<a href="http://www.cnblogs.com/skynet/archive/2010/12/11/1903347.html" target="_blank" rel="noopener">这里</a>。什么是 chunked 分块传输呢？下面我们就来介绍一下。</p>
</li>
</ul>
<h3 id="Transfer-Encoding"><a href="#Transfer-Encoding" class="headerlink" title="Transfer-Encoding"></a>Transfer-Encoding</h3><p>Transfer-Encoding 是一个用来标示 HTTP 报文传输格式的头部值。尽管这个取值理论上可以有很多，但是当前的 HTTP 规范里实际上只定义了一种传输取值——chunked。</p>
<p>如果一个HTTP消息（请求消息或应答消息）的Transfer-Encoding消息头的值为chunked，那么，消息体由数量未定的块组成，并以最后一个大小为0的块为结束。</p>
<p>每一个非空的块都以该块包含数据的字节数（字节数以十六进制表示）开始，跟随一个CRLF （回车及换行），然后是数据本身，最后块CRLF结束。在一些实现中，块大小和CRLF之间填充有白空格（0x20）。</p>
<p>最后一块是单行，由块大小（0），一些可选的填充白空格，以及CRLF。最后一块不再包含任何数据，但是可以发送可选的尾部，包括消息头字段。消息最后以CRLF结尾。</p>
<p>一个示例响应如下：</p>
<pre><code>HTTP/1.1 200 OK
Content-Type: text/plain
Transfer-Encoding: chunked

25
This is the data in the first chunk

1A
and this is the second one
0</code></pre><p><strong>注意：</strong></p>
<ul>
<li>chunked 和 multipart 两个名词在意义上有类似的地方，不过在 HTTP 协议当中这两个概念则不是一个类别的。multipart 是一种 Content-Type，标示 HTTP 报文内容的类型，而 chunked 是一种传输格式，标示报头将以何种方式进行传输。</li>
<li>chunked 传输不能事先知道内容的长度，只能靠最后的空 chunk 块来判断，因此对于下载请求来说，是没有办法实现进度的。在浏览器和下载工具中，偶尔我们也会看到有些文件是看不到下载进度的，即采用 chunked 方式进行下载。</li>
<li>chunked 的优势在于，服务器端可以边生成内容边发送，无需事先生成全部的内容。HTTP/2 不支持 Transfer-Encoding: chunked，因为 HTTP/2 有自己的 streaming 传输方式（Source：<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Transfer-Encoding" target="_blank" rel="noopener">MDN - Transfer-Encoding</a>）。</li>
</ul>
<h3 id="HTTP-Pipelining（HTTP-管线化）"><a href="#HTTP-Pipelining（HTTP-管线化）" class="headerlink" title="HTTP Pipelining（HTTP 管线化）"></a>HTTP Pipelining（HTTP 管线化）</h3><p>默认情况下 HTTP 协议中每个传输层连接只能承载一个 HTTP 请求和响应，浏览器会在收到上一个请求的响应之后，再发送下一个请求。在使用持久连接的情况下，某个连接上消息的传递类似于<code>请求1 -&gt; 响应1 -&gt; 请求2 -&gt; 响应2 -&gt; 请求3 -&gt; 响应3</code>。</p>
<p>HTTP Pipelining（管线化）是将多个 HTTP 请求整批提交的技术，在传送过程中不需等待服务端的回应。使用 HTTP Pipelining 技术之后，某个连接上的消息变成了类似这样<code>请求1 -&gt; 请求2 -&gt; 请求3 -&gt; 响应1 -&gt; 响应2 -&gt; 响应3</code>。</p>
<p>注意下面几点：</p>
<ul>
<li>管线化机制通过持久连接（persistent connection）完成，仅 HTTP/1.1 支持此技术（HTTP/1.0不支持）</li>
<li>只有 GET 和 HEAD 请求可以进行管线化，而 POST 则有所限制</li>
<li>初次创建连接时不应启动管线机制，因为对方（服务器）不一定支持 HTTP/1.1 版本的协议</li>
<li>管线化不会影响响应到来的顺序，如上面的例子所示，响应返回的顺序并未改变</li>
<li>HTTP /1.1 要求服务器端支持管线化，但并不要求服务器端也对响应进行管线化处理，只是要求对于管线化的请求不失败即可</li>
<li>由于上面提到的服务器端问题，开启管线化很可能并不会带来大幅度的性能提升，而且很多服务器端和代理程序对管线化的支持并不好，因此现代浏览器如 Chrome 和 Firefox 默认并未开启管线化支持</li>
</ul>
<p>更多关于 HTTP Pipelining 的知识可以参考<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Pipelining_FAQ" target="_blank" rel="noopener">这里</a>。</p>
<h2 id="会话跟踪"><a href="#会话跟踪" class="headerlink" title="会话跟踪"></a>会话跟踪</h2><ol>
<li><p>什么是会话？</p>
<p>客户端打开与服务器的连接发出请求到服务器响应客户端请求的全过程称之为会话。</p>
</li>
<li><p>什么是会话跟踪？</p>
<p>会话跟踪指的是对同一个用户对服务器的连续的请求和接受响应的监视。</p>
</li>
<li><p>为什么需要会话跟踪？</p>
<p>浏览器与服务器之间的通信是通过HTTP协议进行通信的，而HTTP协议是”无状态”的协议，它不能保存客户的信息，即一次响应完成之后连接就断开了，下一次的请求需要重新连接，这样就需要判断是否是同一个用户，所以才有会话跟踪技术来实现这种要求。</p>
</li>
<li><p>会话跟踪常用的方法:</p>
<ol>
<li><p>URL 重写</p>
<p>URL(统一资源定位符)是Web上特定页面的地址，URL重写的技术就是在URL结尾添加一个附加数据以标识该会话,把会话ID通过URL的信息传递过去，以便在服务器端进行识别不同的用户。</p>
</li>
<li><p>隐藏表单域</p>
<p>将会话ID添加到HTML表单元素中提交到服务器，此表单元素并不在客户端显示</p>
</li>
<li><p>Cookie</p>
<p>Cookie 是Web 服务器发送给客户端的一小段信息，客户端请求时可以读取该信息发送到服务器端，进而进行用户的识别。对于客户端的每次请求，服务器都会将 Cookie 发送到客户端,在客户端可以进行保存,以便下次使用。</p>
<p>客户端可以采用两种方式来保存这个 Cookie 对象，一种方式是保存在客户端内存中，称为临时 Cookie，浏览器关闭后这个 Cookie 对象将消失。另外一种方式是保存在客户机的磁盘上，称为永久 Cookie。以后客户端只要访问该网站，就会将这个 Cookie 再次发送到服务器上，前提是这个 Cookie 在有效期内，这样就实现了对客户的跟踪。</p>
<p>Cookie 是可以被客户端禁用的。</p>
</li>
<li><p>Session:</p>
<p>每一个用户都有一个不同的 session，各个用户之间是不能共享的，是每个用户所独享的，在 session 中可以存放信息。</p>
<p>在服务器端会创建一个 session 对象，产生一个 sessionID 来标识这个 session 对象，然后将这个 sessionID 放入到 Cookie 中发送到客户端，下一次访问时，sessionID 会发送到服务器，在服务器端进行识别不同的用户。</p>
<p>Session 的实现依赖于 Cookie，如果 Cookie 被禁用，那么 session 也将失效。</p>
</li>
</ol>
</li>
</ol>
<h2 id="跨站攻击"><a href="#跨站攻击" class="headerlink" title="跨站攻击"></a>跨站攻击</h2><ul>
<li><p>CSRF（Cross-site request forgery，跨站请求伪造）</p>
<p>CSRF(XSRF) 顾名思义，是伪造请求，冒充用户在站内的正常操作。</p>
<p>例如，一论坛网站的发贴是通过 GET 请求访问，点击发贴之后 JS 把发贴内容拼接成目标 URL 并访问：</p>
<pre><code>http://example.com/bbs/create_post.php?title=标题&amp;content=内容</code></pre><p>那么，我们只需要在论坛中发一帖，包含一链接：</p>
<pre><code>http://example.com/bbs/create_post.php?title=我是脑残&amp;content=哈哈</code></pre><p>只要有用户点击了这个链接，那么他们的帐户就会在不知情的情况下发布了这一帖子。可能这只是个恶作剧，但是既然发贴的请求可以伪造，那么删帖、转帐、改密码、发邮件全都可以伪造。</p>
<p><strong>如何防范 CSRF 攻击</strong>？可以注意以下几点：</p>
<ul>
<li><p>关键操作只接受 POST 请求</p>
</li>
<li><p>验证码</p>
<p>CSRF 攻击的过程，往往是在用户不知情的情况下构造网络请求。所以如果使用验证码，那么每次操作都需要用户进行互动，从而简单有效的防御了CSRF攻击。</p>
<p>但是如果你在一个网站作出任何举动都要输入验证码会严重影响用户体验，所以验证码一般只出现在特殊操作里面，或者在注册时候使用。</p>
</li>
<li><p>检测 Referer</p>
<p>常见的互联网页面与页面之间是存在联系的，比如你在 <code>www.baidu.com</code> 应该是找不到通往<code>www.google.com</code> 的链接的，再比如你在论坛留言，那么不管你留言后重定向到哪里去了，之前的那个网址一定会包含留言的输入框，这个之前的网址就会保留在新页面头文件的 <code>Referer</code> 中</p>
</li>
</ul>
<p>通过检查 <code>Referer</code> 的值，我们就可以判断这个请求是合法的还是非法的，但是问题出在服务器不是任何时候都能接受到 <code>Referer</code> 的值，所以 Referer Check 一般用于监控 CSRF 攻击的发生，而不用来抵御攻击。</p>
<ul>
<li><p>Token</p>
<p>目前主流的做法是使用 Token 抵御 CSRF 攻击。下面通过分析 CSRF 攻击来理解为什么 Token 能够有效</p>
<p>CSRF 攻击要成功的条件在于攻击者能够预测所有的参数从而构造出合法的请求。所以根据不可预测性原则，我们可以对参数进行加密从而防止 CSRF 攻击。</p>
<p>另一个更通用的做法是保持原有参数不变，另外添加一个参数 Token，其值是随机的。这样攻击者因为不知道 Token 而无法构造出合法的请求进行攻击。</p>
</li>
</ul>
<p>Token 使用原则</p>
<ul>
<li>Token 要足够随机————只有这样才算不可预测</li>
<li>Token 是一次性的，即每次请求成功后要更新Token————这样可以增加攻击难度，增加预测难度</li>
<li>Token 要注意保密性————敏感操作使用 post，防止 Token 出现在 URL 中</li>
</ul>
<p><strong>注意</strong>：过滤用户输入的内容<strong>不能</strong>阻挡 csrf，我们需要做的是过滤请求的<strong>来源</strong>。</p>
</li>
<li><p>XSS（Cross Site Scripting，跨站脚本攻击）</p>
<p>XSS 全称“跨站脚本”，是注入攻击的一种。其特点是不对服务器端造成任何伤害，而是通过一些正常的站内交互途径，例如发布评论，提交含有 JavaScript 的内容文本。这时服务器端如果没有过滤或转义掉这些脚本，作为内容发布到了页面上，其他用户访问这个页面的时候就会运行这些脚本。</p>
<p>运行预期之外的脚本带来的后果有很多中，可能只是简单的恶作剧——一个关不掉的窗口：</p>
<pre><code>while (true) {
    alert(&quot;你关不掉我~&quot;);
}</code></pre><p>也可以是盗号或者其他未授权的操作。</p>
<p>XSS 是实现 CSRF 的诸多途径中的一条，但绝对不是唯一的一条。一般习惯上把通过 XSS 来实现的 CSRF 称为 XSRF。</p>
<p><strong>如何防御 XSS 攻击？</strong></p>
<p>理论上，所有可输入的地方没有对输入数据进行处理的话，都会存在 XSS 漏洞，漏洞的危害取决于攻击代码的威力，攻击代码也不局限于 script。防御 XSS 攻击最简单直接的方法，就是过滤用户的输入。</p>
<p>如果不需要用户输入 HTML，可以直接对用户的输入进行 HTML escape 。下面一小段脚本：</p>
<pre><code>&lt;script&gt;window.location.href=”http://www.baidu.com”;&lt;/script&gt;</code></pre><p>经过 escape 之后就成了：</p>
<pre><code>&amp;lt;script&amp;gt;window.location.href=&amp;quot;http://www.baidu.com&amp;quot;&amp;lt;/script&amp;gt;</code></pre><p>它现在会像普通文本一样显示出来，变得无毒无害，不能执行了。</p>
<p>当我们需要用户输入 HTML 的时候，需要对用户输入的内容做更加小心细致的处理。仅仅粗暴地去掉 script 标签是没有用的，任何一个合法 HTML 标签都可以添加 onclick 一类的事件属性来执行 JavaScript。更好的方法可能是，将用户的输入使用 HTML 解析库进行解析，获取其中的数据。然后根据用户原有的标签属性，重新构建 HTML 元素树。构建的过程中，所有的标签、属性都只从<strong>白名单</strong>中拿取。</p>
</li>
</ul>
<h1 id="HTTP-1"><a href="#HTTP-1" class="headerlink" title="HTTP"></a>HTTP</h1><h2 id="HTTPS-基本过程"><a href="#HTTPS-基本过程" class="headerlink" title="HTTPS 基本过程"></a>HTTPS 基本过程</h2><p>HTTPS 即 HTTP over TLS，是一种在加密信道进行 HTTP 内容传输的协议。</p>
<blockquote>
<p>TLS 的早期版本叫做 SSL。SSL 的 1.0, 2.0, 3.0 版本均已经被废弃，出于安全问题考虑广大浏览器也不再对老旧的 SSL 版本进行支持了，因此这里我们就统一使用 TLS 名称了。</p>
</blockquote>
<p>TLS 的基本过程如下（取自 <a href="https://github.com/skyline75489/what-happens-when-zh_CN#tls" target="_blank" rel="noopener">what-happens-when-zh_CN</a>）：</p>
<ul>
<li>客户端发送一个 <code>ClientHello</code> 消息到服务器端，消息中同时包含了它的 Transport Layer Security (TLS) 版本，可用的加密算法和压缩算法。</li>
<li>服务器端向客户端返回一个 <code>ServerHello</code> 消息，消息中包含了服务器端的 TLS 版本，服务器所选择的加密和压缩算法，以及数字证书认证机构（Certificate Authority，缩写 CA）签发的服务器公开证书，证书中包含了公钥。客户端会使用这个公钥加密接下来的握手过程，直到协商生成一个新的对称密钥。证书中还包含了该证书所应用的域名范围（Common Name，简称 CN），用于客户端验证身份。</li>
<li>客户端根据自己的信任 CA 列表，验证服务器端的证书是否可信。如果认为可信（具体的验证过程在下一节讲解），客户端会生成一串伪随机数，使用服务器的公钥加密它。这串随机数会被用于生成新的对称密钥</li>
<li>服务器端使用自己的私钥解密上面提到的随机数，然后使用这串随机数生成自己的对称主密钥</li>
<li>客户端发送一个 <code>Finished</code> 消息给服务器端，使用对称密钥加密这次通讯的一个散列值</li>
<li>服务器端生成自己的 hash 值，然后解密客户端发送来的信息，检查这两个值是否对应。如果对应，就向客户端发送一个 <code>Finished</code> 消息，也使用协商好的对称密钥加密</li>
<li>从现在开始，接下来整个 TLS 会话都使用对称秘钥进行加密，传输应用层（HTTP）内容</li>
</ul>
<p>从上面的过程可以看到，TLS 的完整过程需要三个算法（协议），密钥交互算法，对称加密算法，和消息认证算法（TLS 的传输会使用 MAC(message authentication code) 进行完整性检查）。</p>
<p>我们以 Github 网站使用的 TLS 为例，使用浏览器可以看到它使用的加密为 <code>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</code>。其中密钥交互算法是 <code>ECDHE_RSA</code>，对称加密算法是 <code>AES_128_GCM</code>，消息认证（MAC）算法为 <code>SHA256</code>。</p>
<h2 id="TLS-证书机制"><a href="#TLS-证书机制" class="headerlink" title="TLS 证书机制"></a>TLS 证书机制</h2><p>HTTPS 过程中很重要的一个步骤，是服务器需要有 CA 颁发的证书，客户端根据自己的信任 CA 列表验证服务器的身份。现代浏览器中，证书验证的过程依赖于证书信任链。</p>
<p>所谓证书信任链，即一个证书要依靠上一级证书来证明自己是可信的，最顶层的证书被称为根证书，拥有根证书的机构被称为根 CA。</p>
<p>还是以 Github 为例，在浏览器中我们可以看到它的证书信任链如下：</p>
<p><code>DigiCert High Assurance EV Root CA</code> -&gt; <code>DigiCert SHA2 Extended Validation Server CA</code> -&gt; <code>Github.com</code></p>
<p>从上到下即 Root CA -&gt; 二级 CA -&gt; 网站。</p>
<p>前面提到，证书当中包括 CN(Common Name)，浏览器在验证证书的同时，也会验证 CN 的正确性。即不光需要验证“这是一个合法的证书”，还需要验证“这是一个用于 Github.com 的证书”。</p>
<p>既然所有的信任，最终要落到根 CA 上，根证书本身又是怎么获得的呢？答案也很简单，根证书一般是操作系统自带的。不管是桌面系统 Windows，macOS 还是移动端系统 Android, iOS 都会内置一系列根证书。随着操作系统本身的升级，根证书也会随着升级进行更新。</p>
<p>对浏览器而已，浏览器当然也有选择信任某个根证书的权利。Chrome 浏览器一般是跟随系统根证书信任的。Firefox 浏览器通常是使用自带的一套证书信任机制，不受系统证书的影响。</p>
<p>在使用 <code>curl</code> 等工具时，我们还可以自行选择证书进行信任。</p>
<blockquote>
<p>有权威的信任，最终都要落到一个单点信任，不管是 Root CA，还是微软，苹果，谷歌等操作系统厂商。</p>
</blockquote>
<h2 id="中间人攻击"><a href="#中间人攻击" class="headerlink" title="中间人攻击"></a>中间人攻击</h2><p>HTTPS 的过程并不是密不透风的，HTTPS 有若干漏洞，给中间人攻击（Man In The Middle Attack，简称 MITM）提供了可能。</p>
<p>所谓中间人攻击，指攻击者与通讯的两端分别建立独立的联系，并交换其所收到的数据，使通讯的两端认为他们正在通过一个私密的连接与对方直接对话，但事实上整个会话都被攻击者完全控制。在中间人攻击中，攻击者可以拦截通讯双方的通话并插入新的内容。</p>
<h3 id="SSL-剥离"><a href="#SSL-剥离" class="headerlink" title="SSL 剥离"></a>SSL 剥离</h3><p>SSL 剥离即阻止用户使用 HTTPS 访问网站。由于并不是所有网站都只支持 HTTPS，大部分网站会同时支持 HTTP 和 HTTPS 两种协议。用户在访问网站时，也可能会在地址栏中输入 <code>http://</code> 的地址，第一次的访问完全是明文的，这就给了攻击者可乘之机。通过攻击 DNS 响应，攻击者可以将自己变成中间人。</p>
<blockquote>
<p>DNS 作为基于 UDP 的协议是相当不安全的，为了保证 DNS 的安全可以使用 DNS over TCP 等机制，这里不赘述了。</p>
</blockquote>
<h3 id="HSTS"><a href="#HSTS" class="headerlink" title="HSTS"></a>HSTS</h3><p>为了防止上面说的这种情况，一种叫做 HSTS 的技术被引入了。HSTS（HTTP Strict Transport Security）是用于强制浏览器使用 HTTPS 访问网站的一种机制。它的基本机制是在服务器返回的响应中，加上一个特殊的头部，指示浏览器对于此网站，强制使用 HTTPS 进行访问：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Strict-Transport-Security: max-age=31536000; includeSubdomains; preload</span><br></pre></td></tr></table></figure>

<p>可以看到如果这个过期时间非常长，就是导致在很长一段时间内，浏览器都会强制使用 HTTPS 访问该网站。</p>
<p>HSTS 有一个很明显的缺点，是需要等待第一个服务器的影响中的头部才能生效，但如果第一次访问该网站就被攻击呢？为了解决这个问题，浏览器中会带上一些网站的域名，被称为 HSTS preload list。对于在这个 list 的网站来说，直接强制使用 HTTPS。</p>
<h3 id="伪造证书攻击"><a href="#伪造证书攻击" class="headerlink" title="伪造证书攻击"></a>伪造证书攻击</h3><p>HSTS 只解决了 SSL 剥离的问题，然而即使在全程使用 HTTPS 的情况下，我们仍然有可能被监听。</p>
<p>假设我们想访问 <code>www.google.com</code>，但我们的 DNS 服务器被攻击了，指向的 IP 地址并非 Google 的服务器，而是攻击者的 IP。当攻击者的服务器也有合法的证书的时候，我们的浏览器就会认为对方是 Google 服务器，从而信任对方。这样，攻击者便可以监听我们和谷歌之前的所有通信了。</p>
<p>可以看到攻击者有两步需要操作，第一步是需要攻击 DNS 服务器。第二步是攻击者自己的证书需要被用户信任，这一步对于用户来说是很难控制的，需要证书颁发机构能够控制自己不滥发证书。</p>
<blockquote>
<p>2015 年 Google 称发现赛门铁克旗下的 Thawte 未经同意签发了众多域名的数千个证书，其中包括 Google 旗下的域名和不存在的域名。当年 12 月，Google 发布公告称 Chrome、Android 及其他 Google 产品将不再信任赛门铁克旗下的”Class 3 Public Primary CA”根证书。</p>
</blockquote>
<blockquote>
<p>2016 年 Mozilla 发现沃通 CA 存在严重的信任问题，例如偷签 <code>github.com</code> 的证书，故意倒填证书日期绕过浏览器对 SHA-1 证书的限制等，将停止信任 WoSign 和 StartCom 签发的新证书。</p>
</blockquote>
<h3 id="HPKP"><a href="#HPKP" class="headerlink" title="HPKP"></a>HPKP</h3><p>HPKP 技术是为了解决伪造证书攻击而诞生的。</p>
<p>HPKP（Public Key Pinning Extension for HTTP）在 HSTS 上更进一步，HPKP 直接在返回头中存储服务器的公钥指纹信息，一旦发现指纹和实际接受到的公钥有差异，浏览器就可以认为正在被攻击：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Public-Key-Pins: pin-sha256="base64=="; max-age=expireTime [; includeSubDomains][; report-uri="reportURI"]</span><br></pre></td></tr></table></figure>

<p>和 HSTS 类似，HPKP 也依赖于服务器的头部返回，不能解决第一次访问的问题，浏览器本身也会内置一些 HPKP 列表。</p>
<blockquote>
<p>HPKP 技术仍然不能阻止第一次访问的攻击问题，部署和配置 HPKP 相当繁琐，一旦网站配置错误，就会导致网站证书验证失败，且在过期时间内无法有效恢复。HPKP 的机制也引来了一些安全性问题。Chrome 67 中废除了对 HPKP 的支持，在 Chrome 72 中 HPKP 被彻底移除。</p>
</blockquote>
<h1 id="IP"><a href="#IP" class="headerlink" title="IP"></a>IP</h1><h2 id="IP-协议简介"><a href="#IP-协议简介" class="headerlink" title="IP 协议简介"></a>IP 协议简介</h2><p>IP 协议位于 TCP/IP 协议的第三层——网络层。与传输层协议相比，网络层的责任是提供点到点(hop by hop)的服务，而传输层（TCP/UDP）则提供端到端(end to end)的服务。</p>
<h2 id="IP-地址的分类"><a href="#IP-地址的分类" class="headerlink" title="IP 地址的分类"></a>IP 地址的分类</h2><h3 id="A类地址"><a href="#A类地址" class="headerlink" title="A类地址"></a>A类地址</h3><h3 id="B类地址"><a href="#B类地址" class="headerlink" title="B类地址"></a>B类地址</h3><h3 id="C类地址"><a href="#C类地址" class="headerlink" title="C类地址"></a>C类地址</h3><h3 id="D-类地址"><a href="#D-类地址" class="headerlink" title="D 类地址"></a>D 类地址</h3><h2 id="广播与多播"><a href="#广播与多播" class="headerlink" title="广播与多播"></a>广播与多播</h2><p>广播和多播仅用于UDP（TCP是面向连接的）。</p>
<ul>
<li><p>广播</p>
<p>一共有四种广播地址：</p>
<ol>
<li><p>受限的广播</p>
<p>受限的广播地址为255.255.255.255。该地址用于主机配置过程中IP数据报的目的地址，在任何情况下，router不转发目的地址为255.255.255.255的数据报，这样的数据报仅出现在本地网络中。</p>
</li>
<li><p>指向网络的广播</p>
<p>指向网络的广播地址是主机号为全1的地址。A类网络广播地址为netid.255.255.255，其中netid为A类网络的网络号。</p>
<p>一个router必须转发指向网络的广播，但它也必须有一个不进行转发的选择。</p>
</li>
<li><p>指向子网的广播</p>
<p>指向子网的广播地址为主机号为全1且有特定子网号的地址。作为子网直接广播地址的IP地址需要了解子网的掩码。例如，router收到128.1.2.255的数据报，当B类网路128.1的子网掩码为255.255.255.0时，该地址就是指向子网的广播地址；但是如果子网掩码为255.255.254.0，该地址就不是指向子网的广播地址。</p>
</li>
<li><p>指向所有子网的广播</p>
<p>指向所有子网的广播也需要了解目的网络的子网掩码，以便与指向网络的广播地址区分开来。指向所有子网的广播地址的子网号和主机号为全1.例如，如果子网掩码为255.255.255.0，那么128.1.255.255就是一个指向所有子网的广播地址。</p>
<p>当前的看法是这种广播是陈旧过时的，更好的方式是使用多播而不是对所有子网的广播。</p>
</li>
</ol>
<p>广播示例:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PING 192.168.0.255 (192.168.0.255): 56 data bytes</span><br><span class="line">64 bytes from 192.168.0.107: icmp_seq&#x3D;0 ttl&#x3D;64 time&#x3D;0.199 ms</span><br><span class="line">64 bytes from 192.168.0.106: icmp_seq&#x3D;0 ttl&#x3D;64 time&#x3D;45.357 ms</span><br><span class="line">64 bytes from 192.168.0.107: icmp_seq&#x3D;1 ttl&#x3D;64 time&#x3D;0.203 ms</span><br><span class="line">64 bytes from 192.168.0.106: icmp_seq&#x3D;1 ttl&#x3D;64 time&#x3D;269.475 ms</span><br><span class="line">64 bytes from 192.168.0.107: icmp_seq&#x3D;2 ttl&#x3D;64 time&#x3D;0.102 ms</span><br><span class="line">64 bytes from 192.168.0.106: icmp_seq&#x3D;2 ttl&#x3D;64 time&#x3D;189.881 ms</span><br></pre></td></tr></table></figure>

<p>可以看到的确收到了来自两个主机的答复，其中 192.168.0.107 是本机地址。</p>
</li>
<li><p>多播</p>
<p>多播又叫组播，使用D类地址，D类地址分配的28bit均用作多播组号而不再表示其他。</p>
<p>多播组地址包括1110的最高4bit和多播组号。它们通常可以表示为点分十进制数，范围从224.0.0.0到239.255.255.255。</p>
<p>多播的出现减少了对应用不感兴趣主机的处理负荷。</p>
<p>多播的特点：</p>
<ul>
<li>允许一个或多个发送者（组播源）发送单一的数据包到多个接收者（一次的，同时的）的网络技术</li>
<li>可以大大的节省网络带宽，因为无论有多少个目标地址，在整个网络的任何一条链路上只传送单一的数据包</li>
<li>多播技术的核心就是针对如何节约网络资源的前提下保证服务质量。</li>
</ul>
<p>多播示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PING 224.0.0.1 (224.0.0.1): 56 data bytes</span><br><span class="line">64 bytes from 192.168.0.107: icmp_seq&#x3D;0 ttl&#x3D;64 time&#x3D;0.081 ms</span><br><span class="line">64 bytes from 192.168.0.106: icmp_seq&#x3D;0 ttl&#x3D;64 time&#x3D;123.081 ms</span><br><span class="line">64 bytes from 192.168.0.107: icmp_seq&#x3D;1 ttl&#x3D;64 time&#x3D;0.122 ms</span><br><span class="line">64 bytes from 192.168.0.106: icmp_seq&#x3D;1 ttl&#x3D;64 time&#x3D;67.312 ms</span><br><span class="line">64 bytes from 192.168.0.107: icmp_seq&#x3D;2 ttl&#x3D;64 time&#x3D;0.132 ms</span><br><span class="line">64 bytes from 192.168.0.106: icmp_seq&#x3D;2 ttl&#x3D;64 time&#x3D;447.073 ms</span><br><span class="line">64 bytes from 192.168.0.107: icmp_seq&#x3D;3 ttl&#x3D;64 time&#x3D;0.132 ms</span><br><span class="line">64 bytes from 192.168.0.106: icmp_seq&#x3D;3 ttl&#x3D;64 time&#x3D;188.800 ms</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="BGP"><a href="#BGP" class="headerlink" title="BGP"></a>BGP</h2><ul>
<li><p>边界网关协议（BGP）是运行于 TCP 上的一种自治系统的路由协议</p>
</li>
<li><p>BGP 是唯一一个用来处理像因特网大小的网络的协议，也是唯一能够妥善处理好不相关路由域间的多路连接的协议</p>
</li>
<li><p>BGP是一种外部网关协议（Exterior Gateway Protocol，EGP），与OSPF、RIP等内部网关协议（Interior Gateway Protocol，IGP）不同，BGP不在于发现和计算路由，而在于控制路由的传播和选择最佳路由</p>
</li>
<li><p>BGP使用TCP作为其传输层协议（端口号179），提高了协议的可靠性</p>
</li>
<li><p>BGP既不是纯粹的矢量距离协议，也不是纯粹的链路状态协议</p>
</li>
<li><p>BGP支持CIDR（Classless Inter-Domain Routing，无类别域间路由）</p>
</li>
<li><p>路由更新时，BGP只发送更新的路由，大大减少了BGP传播路由所占用的带宽，适用于在Internet上传播大量的路由信息</p>
</li>
<li><p>BGP路由通过携带AS路径信息彻底解决路由环路问题</p>
</li>
<li><p>BGP提供了丰富的路由策略，能够对路由实现灵活的过滤和选择</p>
</li>
<li><p>BGP易于扩展，能够适应网络新的发展</p>
</li>
</ul>
<h1 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h1><h2 id="TCP-的特性"><a href="#TCP-的特性" class="headerlink" title="TCP 的特性"></a>TCP 的特性</h2><ul>
<li>TCP 提供一种<strong>面向连接的、可靠的</strong>字节流服务</li>
<li>在一个 TCP 连接中，仅有两方进行彼此通信。广播和多播不能用于 TCP</li>
<li>TCP 使用校验和，确认和重传机制来保证可靠传输</li>
<li>TCP 给数据分节进行排序，并使用累积确认保证数据的顺序不变和非重复</li>
<li>TCP 使用滑动窗口机制来实现流量控制，通过动态改变窗口的大小进行拥塞控制</li>
</ul>
<p><strong>注意</strong>：TCP 并不能保证数据一定会被对方接收到，因为这是不可能的。TCP 能够做到的是，如果有可能，就把数据递送到接收方，否则就（通过放弃重传并且中断连接这一手段）通知用户。因此准确说 TCP 也不是 100% 可靠的协议，它所能提供的是数据的可靠递送或故障的可靠通知。</p>
<h2 id="三次握手与四次挥手"><a href="#三次握手与四次挥手" class="headerlink" title="三次握手与四次挥手"></a>三次握手与四次挥手</h2><p>所谓三次握手(Three-way Handshake)，是指建立一个 TCP 连接时，需要客户端和服务器总共发送3个包。</p>
<p>三次握手的目的是连接服务器指定端口，建立 TCP 连接，并同步连接双方的序列号和确认号，交换 TCP 窗口大小信息。在 socket 编程中，客户端执行 <code>connect()</code> 时。将触发三次握手。</p>
<ul>
<li><p>第一次握手(SYN=1, seq=x):</p>
<p>客户端发送一个 TCP 的 SYN 标志位置1的包，指明客户端打算连接的服务器的端口，以及初始序号 X,保存在包头的序列号(Sequence Number)字段里。</p>
<p>发送完毕后，客户端进入 <code>SYN_SEND</code> 状态。</p>
</li>
<li><p>第二次握手(SYN=1, ACK=1, seq=y, ACKnum=x+1):</p>
<p>服务器发回确认包(ACK)应答。即 SYN 标志位和 ACK 标志位均为1。服务器端选择自己 ISN 序列号，放到 Seq 域里，同时将确认序号(Acknowledgement Number)设置为客户的 ISN 加1，即X+1。<br>发送完毕后，服务器端进入 <code>SYN_RCVD</code> 状态。</p>
</li>
<li><p>第三次握手(ACK=1，ACKnum=y+1)</p>
<p>客户端再次发送确认包(ACK)，SYN 标志位为0，ACK 标志位为1，并且把服务器发来 ACK 的序号字段+1，放在确定字段中发送给对方，并且在数据段放写ISN的+1</p>
<p>发送完毕后，客户端进入 <code>ESTABLISHED</code> 状态，当服务器端接收到这个包时，也进入 <code>ESTABLISHED</code> 状态，TCP 握手结束。</p>
</li>
</ul>
<p>三次握手的过程的示意图如下：</p>
<p><img src="../images/tcp-connection-made-three-way-handshake.png" alt="three-way-handshake"></p>
<p>TCP 的连接的拆除需要发送四个包，因此称为四次挥手(Four-way handshake)，也叫做改进的三次握手。客户端或服务器均可主动发起挥手动作，在 socket 编程中，任何一方执行 <code>close()</code> 操作即可产生挥手操作。</p>
<ul>
<li><p>第一次挥手(FIN=1，seq=x)</p>
<p>假设客户端想要关闭连接，客户端发送一个 FIN 标志位置为1的包，表示自己已经没有数据可以发送了，但是仍然可以接受数据。</p>
<p>发送完毕后，客户端进入 <code>FIN_WAIT_1</code> 状态。</p>
</li>
<li><p>第二次挥手(ACK=1，ACKnum=x+1)</p>
<p>服务器端确认客户端的 FIN 包，发送一个确认包，表明自己接受到了客户端关闭连接的请求，但还没有准备好关闭连接。</p>
<p>发送完毕后，服务器端进入 <code>CLOSE_WAIT</code> 状态，客户端接收到这个确认包之后，进入 <code>FIN_WAIT_2</code> 状态，等待服务器端关闭连接。</p>
</li>
<li><p>第三次挥手(FIN=1，seq=y)</p>
<p>服务器端准备好关闭连接时，向客户端发送结束连接请求，FIN 置为1。</p>
<p>发送完毕后，服务器端进入 <code>LAST_ACK</code> 状态，等待来自客户端的最后一个ACK。</p>
</li>
<li><p>第四次挥手(ACK=1，ACKnum=y+1)</p>
<p>客户端接收到来自服务器端的关闭请求，发送一个确认包，并进入 <code>TIME_WAIT</code>状态，等待可能出现的要求重传的 ACK 包。</p>
<p>服务器端接收到这个确认包之后，关闭连接，进入 <code>CLOSED</code> 状态。</p>
<p>客户端等待了某个固定时间（两个最大段生命周期，2MSL，2 Maximum Segment Lifetime）之后，没有收到服务器端的 ACK ，认为服务器端已经正常关闭连接，于是自己也关闭连接，进入 <code>CLOSED</code> 状态。</p>
</li>
</ul>
<p>四次挥手的示意图如下：</p>
<p><img src="../images/tcp-connection-closed-four-way-handshake.png" alt="four-way-handshake"></p>
<h2 id="SYN攻击"><a href="#SYN攻击" class="headerlink" title="SYN攻击"></a>SYN攻击</h2><ul>
<li><p>什么是 SYN 攻击（SYN Flood）？</p>
<p>在三次握手过程中，服务器发送 SYN-ACK 之后，收到客户端的 ACK 之前的 TCP 连接称为半连接(half-open connect)。此时服务器处于 SYN_RCVD 状态。当收到 ACK 后，服务器才能转入 ESTABLISHED 状态.</p>
<p>SYN 攻击指的是，攻击客户端在短时间内伪造大量不存在的IP地址，向服务器不断地发送SYN包，服务器回复确认包，并等待客户的确认。由于源地址是不存在的，服务器需要不断的重发直至超时，这些伪造的SYN包将长时间占用未连接队列，正常的SYN请求被丢弃，导致目标系统运行缓慢，严重者会引起网络堵塞甚至系统瘫痪。</p>
<p>SYN 攻击是一种典型的 DoS/DDoS 攻击。</p>
</li>
<li><p>如何检测 SYN 攻击？</p>
<p>检测 SYN 攻击非常的方便，当你在服务器上看到大量的半连接状态时，特别是源IP地址是随机的，基本上可以断定这是一次SYN攻击。在 Linux/Unix 上可以使用系统自带的 netstats 命令来检测 SYN 攻击。</p>
</li>
<li><p>如何防御 SYN 攻击？</p>
<p>SYN攻击不能完全被阻止，除非将TCP协议重新设计。我们所做的是尽可能的减轻SYN攻击的危害，常见的防御 SYN 攻击的方法有如下几种：</p>
<ul>
<li>缩短超时（SYN Timeout）时间</li>
<li>增加最大半连接数</li>
<li>过滤网关防护</li>
<li>SYN cookies技术</li>
</ul>
</li>
</ul>
<h2 id="TCP-KeepAlive"><a href="#TCP-KeepAlive" class="headerlink" title="TCP KeepAlive"></a>TCP KeepAlive</h2><p>TCP 的连接，实际上是一种纯软件层面的概念，在物理层面并没有“连接”这种概念。TCP 通信双方建立交互的连接，但是并不是一直存在数据交互，有些连接会在数据交互完毕后，主动释放连接，而有些不会。在长时间无数据交互的时间段内，交互双方都有可能出现掉电、死机、异常重启等各种意外，当这些意外发生之后，这些 TCP 连接并未来得及正常释放，在软件层面上，连接的另一方并不知道对端的情况，它会一直维护这个连接，长时间的积累会导致非常多的半打开连接，造成端系统资源的消耗和浪费，为了解决这个问题，在传输层可以利用 TCP 的 KeepAlive 机制实现来实现。主流的操作系统基本都在内核里支持了这个特性。</p>
<p>TCP KeepAlive 的基本原理是，隔一段时间给连接对端发送一个探测包，如果收到对方回应的 ACK，则认为连接还是存活的，在超过一定重试次数之后还是没有收到对方的回应，则丢弃该 TCP 连接。</p>
<p><a href="http://www.tldp.org/HOWTO/html_single/TCP-Keepalive-HOWTO/" target="_blank" rel="noopener">TCP-Keepalive-HOWTO</a> 有对 TCP KeepAlive 特性的详细介绍，有兴趣的同学可以参考。这里主要说一下，TCP KeepAlive 的局限。首先 TCP KeepAlive 监测的方式是发送一个 probe 包，会给网络带来额外的流量，另外 TCP KeepAlive 只能在内核层级监测连接的存活与否，而连接的存活不一定代表服务的可用。例如当一个服务器 CPU 进程服务器占用达到 100%，已经卡死不能响应请求了，此时 TCP KeepAlive 依然会认为连接是存活的。因此 TCP KeepAlive 对于应用层程序的价值是相对较小的。需要做连接保活的应用层程序，例如 QQ，往往会在应用层实现自己的心跳功能。</p>
<h1 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h1><h2 id="UDP-简介"><a href="#UDP-简介" class="headerlink" title="UDP 简介"></a>UDP 简介</h2><p>UDP 是一个简单的传输层协议。和 TCP 相比，UDP 有下面几个显著特性：</p>
<ul>
<li>UDP 缺乏可靠性。UDP 本身不提供确认，序列号，超时重传等机制。UDP 数据报可能在网络中被复制，被重新排序。即 UDP 不保证数据报会到达其最终目的地，也不保证各个数据报的先后顺序，也不保证每个数据报只到达一次</li>
<li>UDP 数据报是有长度的。每个 UDP 数据报都有长度，如果一个数据报正确地到达目的地，那么该数据报的长度将随数据一起传递给接收方。而 TCP 是一个字节流协议，没有任何（协议上的）记录边界。</li>
<li>UDP 是无连接的。UDP 客户和服务器之前不必存在长期的关系。UDP 发送数据报之前也不需要经过握手创建连接的过程。</li>
<li>UDP 支持多播和广播。</li>
</ul>
<h1 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h1><h2 id="Socket-基本概念"><a href="#Socket-基本概念" class="headerlink" title="Socket 基本概念"></a>Socket 基本概念</h2><p>Socket 是对 TCP/IP 协议族的一种封装，是应用层与TCP/IP协议族通信的中间软件抽象层。从设计模式的角度看来，Socket其实就是一个门面模式，它把复杂的TCP/IP协议族隐藏在Socket接口后面，对用户来说，一组简单的接口就是全部，让Socket去组织数据，以符合指定的协议。</p>
<p>Socket 还可以认为是一种网络间不同计算机上的进程通信的一种方法，利用三元组（ip地址，协议，端口）就可以唯一标识网络中的进程，网络中的进程通信可以利用这个标志与其它进程进行交互。</p>
<p>Socket 起源于 Unix ，Unix/Linux 基本哲学之一就是“一切皆文件”，都可以用“打开(open) –&gt; 读写(write/read) –&gt; 关闭(close)”模式来进行操作。因此 Socket 也被处理为一种特殊的文件。</p>
<h2 id="写一个简易的-WebServer"><a href="#写一个简易的-WebServer" class="headerlink" title="写一个简易的 WebServer"></a>写一个简易的 WebServer</h2><p>一个简易的 Server 的流程如下：</p>
<ul>
<li>1.建立连接，接受一个客户端连接。</li>
<li>2.接受请求，从网络中读取一条 HTTP 请求报文。</li>
<li>3.处理请求，访问资源。</li>
<li>4.构建响应，创建带有 header 的 HTTP 响应报文。</li>
<li>5.发送响应，传给客户端。</li>
</ul>
<p>省略流程 3，大体的程序与调用的函数逻辑如下：</p>
<ul>
<li>socket() 创建套接字</li>
<li>bind() 分配套接字地址</li>
<li>listen() 等待连接请求</li>
<li>accept() 允许连接请求</li>
<li>read()/write() 数据交换</li>
<li>close() 关闭连接</li>
</ul>
<p>代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> port = <span class="number">9090</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> buffer_size = <span class="number">1</span>&lt;&lt;<span class="number">20</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> method_size = <span class="number">1</span>&lt;&lt;<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> filename_size = <span class="number">1</span>&lt;&lt;<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> common_buffer_size = <span class="number">1</span>&lt;&lt;<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">handleError</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;message)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">requestHandling</span><span class="params">(<span class="keyword">int</span> *sock)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sendError</span><span class="params">(<span class="keyword">int</span> *sock)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sendData</span><span class="params">(<span class="keyword">int</span> *sock, <span class="keyword">char</span> *filename)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sendHTML</span><span class="params">(<span class="keyword">int</span> *sock, <span class="keyword">char</span> *filename)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sendJPG</span><span class="params">(<span class="keyword">int</span> *sock, <span class="keyword">char</span> *filename)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> server_sock;</span><br><span class="line">	<span class="keyword">int</span> client_sock;</span><br><span class="line">	</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">server_address</span>;</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">client_address</span>;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">socklen_t</span> client_address_size;</span><br><span class="line"></span><br><span class="line">    server_sock = socket(PF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (server_sock == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    	handleError(<span class="string">"socket error"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(&amp;server_address,<span class="number">0</span>,<span class="keyword">sizeof</span>(server_address));</span><br><span class="line">    server_address.sin_family = AF_INET;</span><br><span class="line">    server_address.sin_addr.s_addr = htonl(INADDR_ANY);</span><br><span class="line">    server_address.sin_port = htons(port);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(bind(server_sock,(struct sockaddr*)&amp;server_address, <span class="keyword">sizeof</span>(server_address)) == <span class="number">-1</span>)&#123;</span><br><span class="line">    	handleError(<span class="string">"bind error"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(listen(server_sock, <span class="number">5</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">    	handleError(<span class="string">"listen error"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">        client_address_size = <span class="keyword">sizeof</span>(client_address);</span><br><span class="line">        client_sock = accept(server_sock, (struct sockaddr*) &amp;client_address, &amp;client_address_size);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (client_sock == <span class="number">-1</span>) &#123;</span><br><span class="line">            handleError(<span class="string">"accept error"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        requestHandling(&amp;client_sock);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//system("open http://127.0.0.1:9090/index.html");</span></span><br><span class="line">    close(server_sock);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">requestHandling</span><span class="params">(<span class="keyword">int</span> *sock)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> client_sock = *sock;</span><br><span class="line">    <span class="keyword">char</span> buffer[buffer_size];</span><br><span class="line">    <span class="keyword">char</span> method[method_size];</span><br><span class="line">    <span class="keyword">char</span> filename[filename_size];</span><br><span class="line"></span><br><span class="line">    read(client_sock, buffer, <span class="keyword">sizeof</span>(buffer)<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strstr</span>(buffer, <span class="string">"HTTP/"</span>)) &#123;</span><br><span class="line">        sendError(sock);</span><br><span class="line">        close(client_sock);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">strcpy</span>(method, strtok(buffer,<span class="string">" /"</span>));</span><br><span class="line">    <span class="built_in">strcpy</span>(filename, strtok(<span class="literal">NULL</span>, <span class="string">" /"</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="number">0</span> != <span class="built_in">strcmp</span>(method, <span class="string">"GET"</span>)) &#123;</span><br><span class="line">        sendError(sock);</span><br><span class="line">        close(client_sock);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sendData(sock, filename);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sendData</span><span class="params">(<span class="keyword">int</span> *sock, <span class="keyword">char</span> *filename)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> client_sock = *sock;</span><br><span class="line">    <span class="keyword">char</span> buffer[common_buffer_size];</span><br><span class="line">    <span class="keyword">char</span> type[common_buffer_size];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">strcpy</span>(buffer, filename);</span><br><span class="line"></span><br><span class="line">    strtok(buffer, <span class="string">"."</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(type, strtok(<span class="literal">NULL</span>, <span class="string">"."</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="number">0</span> == <span class="built_in">strcmp</span>(type, <span class="string">"html"</span>))&#123;</span><br><span class="line">        sendHTML(sock, filename);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="number">0</span> == <span class="built_in">strcmp</span>(type, <span class="string">"jpg"</span>))&#123;</span><br><span class="line">        sendJPG(sock, filename);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        sendError(sock);</span><br><span class="line">        close(client_sock);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sendHTML</span><span class="params">(<span class="keyword">int</span> *sock, <span class="keyword">char</span> *filename)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> client_sock = *sock;</span><br><span class="line">    <span class="keyword">char</span> buffer[buffer_size];</span><br><span class="line">    FILE *fp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> status[] = <span class="string">"HTTP/1.0 200 OK\r\n"</span>;</span><br><span class="line">    <span class="keyword">char</span> header[] = <span class="string">"Server: A Simple Web Server\r\nContent-Type: text/html\r\n\r\n"</span>;</span><br><span class="line"></span><br><span class="line">    write(client_sock, status, <span class="built_in">strlen</span>(status));</span><br><span class="line">    write(client_sock, header, <span class="built_in">strlen</span>(header));</span><br><span class="line"></span><br><span class="line">    fp = fopen(filename, <span class="string">"r"</span>);</span><br><span class="line">    <span class="keyword">if</span>(!fp)&#123;</span><br><span class="line">        sendError(sock);</span><br><span class="line">        close(client_sock);</span><br><span class="line">        handleError(<span class="string">"failed to open file"</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fgets(buffer,<span class="keyword">sizeof</span>(buffer), fp);</span><br><span class="line">    <span class="keyword">while</span>(!feof(fp)) &#123;</span><br><span class="line">        write(client_sock, buffer, <span class="built_in">strlen</span>(buffer));</span><br><span class="line">        fgets(buffer, <span class="keyword">sizeof</span>(buffer), fp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fclose(fp);</span><br><span class="line">    close(client_sock);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sendJPG</span><span class="params">(<span class="keyword">int</span> *sock, <span class="keyword">char</span> *filename)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> client_sock = *sock;</span><br><span class="line">    <span class="keyword">char</span> buffer[buffer_size];</span><br><span class="line">    FILE *fp;</span><br><span class="line">    FILE *fw;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> status[] = <span class="string">"HTTP/1.0 200 OK\r\n"</span>;</span><br><span class="line">    <span class="keyword">char</span> header[] = <span class="string">"Server: A Simple Web Server\r\nContent-Type: image/jpeg\r\n\r\n"</span>;</span><br><span class="line"></span><br><span class="line">    write(client_sock, status, <span class="built_in">strlen</span>(status));</span><br><span class="line">    write(client_sock, header, <span class="built_in">strlen</span>(header));</span><br><span class="line"></span><br><span class="line">    fp = fopen(filename, <span class="string">"rb"</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">NULL</span> == fp)&#123;</span><br><span class="line">        sendError(sock);</span><br><span class="line">        close(client_sock);</span><br><span class="line">        handleError(<span class="string">"failed to open file"</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fw = fdopen(client_sock, <span class="string">"w"</span>);</span><br><span class="line">    fread(buffer, <span class="number">1</span>, <span class="keyword">sizeof</span>(buffer), fp);</span><br><span class="line">    <span class="keyword">while</span> (!feof(fp))&#123;</span><br><span class="line">        fwrite(buffer, <span class="number">1</span>, <span class="keyword">sizeof</span>(buffer), fw);</span><br><span class="line">        fread(buffer, <span class="number">1</span>, <span class="keyword">sizeof</span>(buffer), fp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fclose(fw);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    close(client_sock);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">handleError</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;message)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;message;</span><br><span class="line">	<span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sendError</span><span class="params">(<span class="keyword">int</span> *sock)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> client_sock = *sock;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> status[] = <span class="string">"HTTP/1.0 400 Bad Request\r\n"</span>;</span><br><span class="line">    <span class="keyword">char</span> header[] = <span class="string">"Server: A Simple Web Server\r\nContent-Type: text/html\r\n\r\n"</span>;</span><br><span class="line">    <span class="keyword">char</span> body[] = <span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Bad Request&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;400 Bad Request&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"</span>;</span><br><span class="line"></span><br><span class="line">    write(client_sock, status, <span class="keyword">sizeof</span>(status));</span><br><span class="line">    write(client_sock, header, <span class="keyword">sizeof</span>(header));</span><br><span class="line">    write(client_sock, body, <span class="keyword">sizeof</span>(body));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/12/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/14/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->
      <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1436668936&auto=0&height=66"></iframe>
      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Yuanchen</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">137</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">58</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yuanchen</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.7.0
  </div>



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
