<!DOCTYPE html>


<html lang="en">
	

		<head>
			<meta charset="utf-8" />
			 
			<meta name="keywords" content="life,think,work,blog,code" />
			 
			<meta name="description" content="a place holder" />
			
			<meta
				name="viewport"
				content="width=device-width, initial-scale=1, maximum-scale=1"
			/>
			<meta
				name="google-site-verification"
				content="Xe5wkkWgdmMwA81kCWOHLlJSlYSRE47NKPlVzl8ynK8"
			/>
			<title>introduction to using redux in react native app |  Aaron&#39;s Blog</title>
  <meta name="generator" content="hexo-theme-ayer">
			
			<link rel="shortcut icon" href="/favicon.ico" />
			 
<link rel="stylesheet" href="/dist/main.css">

			<link
				rel="stylesheet"
				href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css"
			/>
			
<link rel="stylesheet" href="/css/custom.css">
 
			<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
			 
 

		<link rel="alternate" href="/atom.xml" title="Aaron's Blog" type="application/atom+xml">
</head>
	</html>
</html>


<body>
  <div id="app">
    
      
      <canvas width="1777" height="841"
        style="position: fixed; left: 0px; top: 0px; z-index: 99999; pointer-events: none;"></canvas>
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-introduction-to-using-redux-in-react-native-app"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  introduction to using redux in react native app
</h1>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/04/20/introduction-to-using-redux-in-react-native-app/" class="article-date">
  <time datetime="2021-04-21T03:09:05.000Z" itemprop="datePublished">2021-04-20</time>
</a>   
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">2.1k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading time≈</span>
            <span class="post-count">12 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p><a target="_blank" rel="noopener" href="https://redux.js.org/">Redux</a> is a predictable state container for JavaScript apps. If Redux is new to you, we recommend looking at <a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tutorials/redux-redux-intro">our introduction to Redux</a>.</p>
<p>In this article, you will learn how to persist user data using Redux in a React Native application. The application is a mock social network with a <code>HomeScreen</code> displaying a count of connected friends, and a <code>FriendsScreen</code> displaying a list of potential friends to add. You will use Redux to share the state between the two screens.</p>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>To complete this tutorial, you’ll need:</p>
<ul>
<li>A local development environment for Node.js. Follow <a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tutorial_series/how-to-install-node-js-and-create-a-local-development-environment">How to Install Node.js and Create a Local Development Environment</a>.</li>
<li>Familiarity with setting up your environment to create a new React Native project and using the iOS or Android simulators may be beneficial.</li>
</ul>
<p>This tutorial builds on the topics covered in <a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tutorials/react-react-native-navigation">How To Use Routing with React Navigation in React Native</a>. It is recommended that you read this tutorial for more context around how the project works, but is not required.</p>
<p>This tutorial was verified with Node v14.7.0, <code>npm</code> v6.14.7, <code>react</code> v16.13.1, <code>react-native</code> v0.63.2, <code>@react-navigation/native</code> v5.7.3, <code>@react-navigation/stack</code> v5.9.0, <code>redux</code> v4.0.5, and <code>react-redux</code> v7.2.1.</p>
<h2 id="Step-1-—-Setting-Up-the-Project-and-Installing-Redux"><a href="#Step-1-—-Setting-Up-the-Project-and-Installing-Redux" class="headerlink" title="Step 1 — Setting Up the Project and Installing Redux"></a>Step 1 — Setting Up the Project and Installing <code>Redux</code></h2><p>This tutorial will use a modified version of the code in <a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tutorials/react-react-native-navigation">How To Use Routing with React Navigation in React Native</a>. To get started, clone <a target="_blank" rel="noopener" href="https://github.com/do-community/MySocialNetwork"><code>MySocialNetwork</code></a>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/do-community/MySocialNetwork.git</span><br></pre></td></tr></table></figure>





<p>Then, navigate to the project directory:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> MySocialNetwork</span><br></pre></td></tr></table></figure>





<p>Change the git branch to <code>redux-starter</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout redux-starter</span><br></pre></td></tr></table></figure>





<p>Next, install the project dependencies:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>





<p>Then, install the <code>redux</code> and <code>react-redux</code> libraries in the project:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install redux@4.0.5 react-redux@7.2.1</span><br></pre></td></tr></table></figure>





<p>Your project is now set up and your dependencies have been installed.</p>
<h2 id="Step-2-—-Creating-a-Reducer"><a href="#Step-2-—-Creating-a-Reducer" class="headerlink" title="Step 2 — Creating a Reducer"></a>Step 2 — Creating a Reducer</h2><p>To connect Redux to your app, you will need to create a <em>reducer</em> and an <em>action</em>.</p>
<p>First, you will create a friends reducer. A reducer is a pure function that takes the previous <em>state</em> and an action as arguments and returns a new state. The reducer is instrumental in keeping the current state of friends updated throughout the app as it changes.</p>
<p>Create the <code>FriendsReducer.js</code> file at the root level of the project:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano FriendsReducer.js</span><br></pre></td></tr></table></figure>





<p>Add the following code:</p>
<p>FriendsReducer.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> INITIAL_STATE = &#123;</span><br><span class="line">  current: [],</span><br><span class="line">  possible: [</span><br><span class="line">    <span class="string">&#x27;Alice&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Bob&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sammy&#x27;</span>,</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> friendsReducer = <span class="function">(<span class="params">state = INITIAL_STATE, action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> combineReducers(&#123;</span><br><span class="line">  friends: friendsReducer</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>





<p>In this file, you create an <code>INITIAL_STATE</code> variable with possible friends to add to your social network. Then you are exporting <code>friendsReducer</code> as a property called <code>friends</code>.</p>
<p>With your reducer in place, you will need a way to add friends.</p>
<h2 id="Step-3-—-Creating-an-Action"><a href="#Step-3-—-Creating-an-Action" class="headerlink" title="Step 3 — Creating an Action"></a>Step 3 — Creating an Action</h2><p>Actions are JavaScript objects that represent payloads of information that send data from your application to the <code>Redux</code> store.</p>
<p>Actions have a <em>type</em> and an optional <em>payload</em>. In this tutorial, the type will be <code>ADD_FRIEND</code>, and the payload will be the array index of a friend you are adding into the <code>current</code> friends array.</p>
<p>Create the <code>FriendsActions.js</code> file at the root level of the project:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano FriendsActions.js</span><br></pre></td></tr></table></figure>





<p>Add <code>addFriend</code>:</p>
<p>FriendsActions.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> addFriend = <span class="function"><span class="params">friendsIndex</span> =&gt;</span> (</span><br><span class="line">  &#123;</span><br><span class="line">    type: <span class="string">&#x27;ADD_FRIEND&#x27;</span>,</span><br><span class="line">    payload: friendsIndex,</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>





<p>When a user clicks on a friend, this code will retrieve the <code>friendsIndex</code> from the <code>friends.possible</code> array. Now you will need to use that index to move this friend into the <code>friends.current</code> array.</p>
<p>Revisit <code>FriendsReducer.js</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano FriendsReducer.js</span><br></pre></td></tr></table></figure>





<p>Add <code>ADD_FRIEND</code>:</p>
<p>FriendsReducer.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> friendsReducer = <span class="function">(<span class="params">state = INITIAL_STATE, action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;ADD_FRIEND&#x27;</span>:</span><br><span class="line">      <span class="comment">// Pulls current and possible out of previous state</span></span><br><span class="line">      <span class="comment">// We do not want to alter state directly in case</span></span><br><span class="line">      <span class="comment">// another action is altering it at the same time</span></span><br><span class="line">      <span class="keyword">const</span> &#123;</span><br><span class="line">        current,</span><br><span class="line">        possible,</span><br><span class="line">      &#125; = state;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Pull friend out of friends.possible</span></span><br><span class="line">      <span class="comment">// Note that action.payload === friendIndex</span></span><br><span class="line">      <span class="keyword">const</span> addedFriend = possible.splice(action.payload, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// And put friend in friends.current</span></span><br><span class="line">      current.push(addedFriend);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Finally, update the redux state</span></span><br><span class="line">      <span class="keyword">const</span> newState = &#123; current, possible &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> newState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>





<p>This code pulls the current and possible friends out of the previous state. <code>Array.splice()</code> retrieves the friend from the array of possible friends. <code>Array.push</code> adds the friend to array of current friends. After ther changes are made, the state is updated.</p>
<p>Now, you have a reducer and an action. You will need to apply the reducer to your app.</p>
<h2 id="Step-4-—-Adding-the-Reducer-to-the-App"><a href="#Step-4-—-Adding-the-Reducer-to-the-App" class="headerlink" title="Step 4 — Adding the Reducer to the App"></a>Step 4 — Adding the Reducer to the App</h2><p>You will need to provide the <code>friends</code> state of your app using <a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tutorials/react-react-redux">React Redux’s <code>Provider</code> component</a>.</p>
<p>Open <code>App.js</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano App.js</span><br></pre></td></tr></table></figure>





<p>Import <code>Provider</code>, <code>createStore</code>, and <code>friendsReducer</code>:</p>
<p>App.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;react-native-gesture-handler&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; StyleSheet &#125; <span class="keyword">from</span> <span class="string">&#x27;react-native&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; NavigationContainer &#125; <span class="keyword">from</span> <span class="string">&#x27;@react-navigation/native&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createStackNavigator &#125; <span class="keyword">from</span> <span class="string">&#x27;@react-navigation/stack&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> friendsReducer <span class="keyword">from</span> <span class="string">&#x27;./FriendsReducer&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> HomeScreen <span class="keyword">from</span> <span class="string">&#x27;./HomeScreen&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> FriendsScreen <span class="keyword">from</span> <span class="string">&#x27;./FriendsScreen&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>





<p>Add and replace the highlighted code with <code>createStore</code> and <code>Provider</code>:</p>
<p>App.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(friendsReducer);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">        &lt;NavigationContainer&gt;</span><br><span class="line">          &lt;Stack.Navigator&gt;</span><br><span class="line">            &lt;Stack.Screen</span><br><span class="line">              name=<span class="string">&quot;Home&quot;</span></span><br><span class="line">              component=&#123;HomeScreen&#125;</span><br><span class="line">            /&gt;</span><br><span class="line">            &lt;Stack.Screen</span><br><span class="line">              name=<span class="string">&quot;Friends&quot;</span></span><br><span class="line">              component=&#123;FriendsScreen&#125;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/Stack.Navigator&gt;</span><br><span class="line">        &lt;/NavigationContainer&gt;</span><br><span class="line">      &lt;/Provider&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>Now <code>friends</code> are accessible within your app, but you still need to add them to the <code>HomeScreen</code> and <code>FriendsScreen</code>.</p>
<h2 id="Step-5-—-Adding-Redux-to-the-Screens"><a href="#Step-5-—-Adding-Redux-to-the-Screens" class="headerlink" title="Step 5 — Adding Redux to the Screens"></a>Step 5 — Adding Redux to the Screens</h2><p>In this step, you will make <code>friends</code> accessible to your screens with the <code>mapStateToProps</code> function. This function maps the <code>state</code> from the <code>FriendsReducer</code> to the <code>props</code> in the two screens.</p>
<p>Let’s start with <code>HomeScreen.js</code>. Open the <code>HomeScreen.js</code> file:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano HomeScreen.js</span><br></pre></td></tr></table></figure>





<p>Add and replace the highlighted lines of code in <code>HomeScreen.js</code>:</p>
<p>HomeScreen.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; StyleSheet, Text, View, Button &#125; <span class="keyword">from</span> <span class="string">&#x27;react-native&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">        &lt;Text&gt;You have (<span class="literal">undefined</span>) friends.&lt;/Text&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">          title=<span class="string">&quot;Add some friends&quot;</span></span><br><span class="line">          onPress=&#123;<span class="function">() =&gt;</span></span><br><span class="line">            <span class="built_in">this</span>.props.navigation.navigate(<span class="string">&#x27;Friends&#x27;</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/View&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> styles = StyleSheet.create(&#123;</span><br><span class="line">  container: &#123;</span><br><span class="line">    flex: <span class="number">1</span>,</span><br><span class="line">    backgroundColor: <span class="string">&#x27;#fff&#x27;</span>,</span><br><span class="line">    alignItems: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">    justifyContent: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; friends &#125; = state</span><br><span class="line">  <span class="keyword">return</span> &#123; friends &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps)(HomeScreen);</span><br></pre></td></tr></table></figure>





<p>This code change adds <code>react-redux</code> and makes <code>friends</code> available to the <code>HomeScreen</code>.</p>
<p>Next, add values for current friends (<code>this.props.friends.current</code>):</p>
<p>HomeScreen.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">        &lt;Text&gt;You have &#123; <span class="built_in">this</span>.props.friends.current.length &#125; friends.&lt;/Text&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">          title=<span class="string">&quot;Add some friends&quot;</span></span><br><span class="line">          onPress=&#123;<span class="function">() =&gt;</span></span><br><span class="line">            <span class="built_in">this</span>.props.navigation.navigate(<span class="string">&#x27;Friends&#x27;</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/View&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>Your <code>HomeScreen</code> will now display the number of current friends. You can now move on to the <code>FriendsScreen</code>.</p>
<p>Open <code>FriendsScreen.js</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano FriendsScreen.js</span><br></pre></td></tr></table></figure>





<p>Add and replace the highlighted lines of code in <code>FriendsScreen.js</code>:</p>
<p>FriendsScreen.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; StyleSheet, Text, View, Button &#125; <span class="keyword">from</span> <span class="string">&#x27;react-native&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FriendsScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">        &lt;Text&gt;Add friends here!&lt;/Text&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">          title=<span class="string">&quot;Back to home&quot;</span></span><br><span class="line">          onPress=&#123;<span class="function">() =&gt;</span></span><br><span class="line">            <span class="built_in">this</span>.props.navigation.navigate(<span class="string">&#x27;Home&#x27;</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/View&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> styles = StyleSheet.create(&#123;</span><br><span class="line">  container: &#123;</span><br><span class="line">    flex: <span class="number">1</span>,</span><br><span class="line">    backgroundColor: <span class="string">&#x27;#fff&#x27;</span>,</span><br><span class="line">    alignItems: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">    justifyContent: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; friends &#125; = state</span><br><span class="line">  <span class="keyword">return</span> &#123; friends &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps)(FriendsScreen);</span><br></pre></td></tr></table></figure>





<p>This code change adds <code>react-redux</code> and makes <code>friends</code> available to the <code>FriendsScreen</code>.</p>
<p>Add values for possible friends (<code>props.friends.possible</code>):</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FriendsScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">        &lt;Text&gt;Add friends here!&lt;/Text&gt;</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">this</span>.props.friends.possible.map(<span class="function">(<span class="params">friend, index</span>) =&gt;</span> (</span><br><span class="line">            &lt;Button</span><br><span class="line">              key=&#123; friend &#125;</span><br><span class="line">              title=&#123; <span class="string">`Add <span class="subst">$&#123; friend &#125;</span>`</span> &#125;</span><br><span class="line">            /&gt;</span><br><span class="line">          ))</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">          title=<span class="string">&quot;Back to home&quot;</span></span><br><span class="line">          onPress=&#123;<span class="function">() =&gt;</span></span><br><span class="line">            <span class="built_in">this</span>.props.navigation.navigate(<span class="string">&#x27;Home&#x27;</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/View&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>Now when you navigate to the <code>FriendsScreen</code>, you will see all possible friends from the reducer.</p>
<p>Finally, add the new Redux <code>addFriend</code> action to <code>FriendsScreen.js</code>:</p>
<p>FriendsScreen.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; bindActionCreators &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; StyleSheet, Text, View, Button &#125; <span class="keyword">from</span> <span class="string">&#x27;react-native&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; addFriend &#125; <span class="keyword">from</span> <span class="string">&#x27;./FriendsActions&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FriendsScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">        &lt;Text&gt;Add friends here!&lt;/Text&gt;</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">this</span>.props.friends.possible.map(<span class="function">(<span class="params">friend, index</span>) =&gt;</span> (</span><br><span class="line">            &lt;Button</span><br><span class="line">              key=&#123; friend &#125;</span><br><span class="line">              title=&#123; <span class="string">`Add <span class="subst">$&#123; friend &#125;</span>`</span> &#125;</span><br><span class="line">              onPress=&#123;<span class="function">() =&gt;</span></span><br><span class="line">                <span class="built_in">this</span>.props.addFriend(index)</span><br><span class="line">              &#125;</span><br><span class="line">            /&gt;</span><br><span class="line">          ))</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">          title=<span class="string">&quot;Back to home&quot;</span></span><br><span class="line">          onPress=&#123;<span class="function">() =&gt;</span></span><br><span class="line">            <span class="built_in">this</span>.props.navigation.navigate(<span class="string">&#x27;Home&#x27;</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/View&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function"><span class="params">dispatch</span> =&gt;</span> (</span><br><span class="line">  bindActionCreators(&#123;</span><br><span class="line">    addFriend,</span><br><span class="line">  &#125;, dispatch)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps, mapDispatchToProps)(FriendsScreen);</span><br></pre></td></tr></table></figure>





<p>Let’s add two friends to the social network and navigate back to <code>HomeScreen</code> to see how many current friends the user has:</p>
<p><img src="../images/1.png" alt="A series of screenshots depicting the HomeScreen and FriendsScreen as a user adds two friends and the array of possible friends and count of current friends channges."></p>
<p>With that, you have moved all the logic from <code>App.js</code> into <code>Redux</code>, which makes your app much more flexible, especially as you add more pages and features like authentication and database integration.</p>
<p>Before we wrap up, let’s clean up the code.</p>
<h2 id="Step-6-—-Cleaning-Up"><a href="#Step-6-—-Cleaning-Up" class="headerlink" title="Step 6 — Cleaning Up"></a>Step 6 — Cleaning Up</h2><p>Now that you are using <code>Redux</code>, you will no longer need the props you were passing from <code>App.js</code>.</p>
<p>You can take cleaning up a step further by storing your <code>action</code> types in a separate file.</p>
<p>You are using the string <code>&#39;ADD_FRIEND&#39;</code> in two places: in the <code>action</code> and the friends <code>reducer</code>. This is dangerous, because if you change the string in one place and not the other you could break your application. As your app grows, it makes sense to keep all these <code>action</code> types in a file called <code>types.js</code>.</p>
<p>Create the <code>types.js</code> file in the root level:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano types.js</span><br></pre></td></tr></table></figure>





<p>Add the following code:</p>
<p>types.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> ADD_FRIEND = <span class="string">&#x27;ADD_FRIEND&#x27;</span>;</span><br></pre></td></tr></table></figure>





<p>Then, revisit <code>FriendsActions.js</code> to use the new <code>ADD_FRIEND</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano FriendsActions.js</span><br></pre></td></tr></table></figure>

<p>Change the quoted <code>&#39;ADD_FRIEND&#39;</code> to the variable <code>ADD_FRIEND</code> in your <code>action</code>:</p>
<p>FriendsActions.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ADD_FRIEND &#125; <span class="keyword">from</span> <span class="string">&#x27;./types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> addFriend = <span class="function"><span class="params">friendsIndex</span> =&gt;</span> (</span><br><span class="line">  &#123;</span><br><span class="line">    type: ADD_FRIEND,</span><br><span class="line">    payload: friendsIndex,</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>





<p>Then, revisit <code>FriendsReducer.js</code> to also use the new <code>ADD_FRIEND</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano FriendsReducer.js</span><br></pre></td></tr></table></figure>





<p>Change the quoted <code>&#39;ADD_FRIEND&#39;</code> to the variable <code>ADD_FRIEND</code> in your <code>reducer</code>:</p>
<p>FriendsReducer.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ADD_FRIEND &#125; <span class="keyword">from</span> <span class="string">&#x27;./types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> friendsReducer = <span class="function">(<span class="params">state = INITIAL_STATE, action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> ADD_FRIEND:</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>





<p>This makes the application less fragile. When developing your applications, you should be aware of opportunites for consolidating code and avoiding repeating yourself.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>In this tutorial, you covered <code>redux</code>, <code>reducers</code>, <code>actions</code>, and scalable data management.</p>
<p>There are a lot more things you can do with Redux, from keeping data in sync with a database, to authentication and keeping track of user permissions.</p>
<p>The complete <a target="_blank" rel="noopener" href="https://github.com/do-community/MySocialNetwork">source code for this tutorial is available on GitHub</a>.</p>
<p>If you’d like to learn more about React, take a look at our <a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tutorial_series/how-to-code-in-react-js">How To Code in React.js</a> series, or check out <a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tags/react">our React topic page</a> for exercises and programming projects.</p>
 
      <!-- reward -->
      
    </div>
    

    <!--comments -->
    
    <section id="comments">
      <div id="disqus_thread"></div>
      <script>
        (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://https-yc-s-github-io.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
        })();
        </script>
        <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </section>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        Share
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://yc-s.github.io/2021/04/20/introduction-to-using-redux-in-react-native-app/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redux-react/" rel="tag">redux react</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
    
      <a href="/2021/04/19/git-commands-%E6%89%8B%E5%86%8C/" class="article-nav-link">
        <strong class="article-nav-caption">next post</strong>
        <div class="article-nav-title">git commands 手册</div>
      </a>
    
  </nav>

  
   
     


</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2020-2021
        <i class="ri-heart-fill heart_icon"></i> Aaron
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></s>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
  
</footer>

      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="Aaron&#39;s Blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">🏡</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">🏛</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">📚</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">🏷</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->


<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->


<script src="/js/clickBoom2.js"></script>


<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


<script src="/js/dz.js"></script>



    
  </div>
</body>

</html>